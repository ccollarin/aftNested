{
    "type": [
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        2,
        3,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        3,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        3,
        0,
        1,
        2,
        2,
        2,
        2,
        3,
        0,
        1,
        2,
        2,
        2,
        2,
        3,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        3,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        3,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        3,
        3,
        0,
        1,
        2,
        2,
        2
    ],
    "data": [
        "matplot(sm_misi$xt$basis$evalX(xx, deriv = 1)$X0, x = xx, type = 'l')",
        "> ",
        "htx <- function(eff){",
        "+ ",
        "  # hazard function (for now without dependence on X)",
        "+ ",
        "  exp(eff$f)*eff$store$f1*exp(-eff$store$Xi[,1])*eff$param[1]",
        "+ ",
        "} # end htx",
        "> ",
        "Stx <- function(eff){",
        "+ ",
        "  # survival function (for now without dependence on X)",
        "+ ",
        "  exp(-exp(eff$f))",
        "+ ",
        "} # end Stx",
        "> ",
        "# define the smooth function",
        "> ",
        "alph <- sm_misi$xt$si$alpha",
        "> ",
        "bet <- rnorm(ncol(sm_misi$X)-(p+1))",
        "> ",
        "f1 <- eff_misi(dat$st, basis = sm_misi$xt$basis)",
        "> ",
        "f1 <- f1$eval(c(alph, bet), deriv = 2)",
        "> ",
        "library(ggplot2)",
        "> ",
        "gridExtra::grid.arrange(",
        "+ ",
        "ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                  log_htx = log(htx(f1))), aes(x = x, y=log_htx))+",
        "+ ",
        "  geom_line()+geom_point(),",
        "+ ",
        "ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                  stx = Stx(f1)), aes(x = x, y=stx))+",
        "+ ",
        "  geom_line()+geom_point(),",
        "+ ",
        "ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                  f = f1$f), aes(x = x, y=f))+",
        "+ ",
        "  geom_line()+geom_point(), ncol=2)",
        "Messaggi di avvertimento:\n1: In log(htx(f1)) : Si è prodotto un NaN\n2: \u001B[38;5;232mRemoved 4 rows containing missing values or values outside the\nscale range (`geom_line()`).\u001B[39m \n3: \u001B[38;5;232mRemoved 4 rows containing missing values or values outside the\nscale range (`geom_point()`).\u001B[39m \n",
        "> ",
        "## define likelihood",
        "> ",
        "llk <- llk_afc(f1, sm = sm_misi, delta = dat$c, lambda = 1, vpen = 1e4)",
        "> ",
        "llk(c(alph, bet))",
        "Errore in colSums2(X + X1/d1) : non trovo la funzione \"colSums2\"\nIn aggiunta: Messaggi di avvertimento:\n1: In log(d1) : Si è prodotto un NaN\n2: In log(o$store$f1) : Si è prodotto un NaN\n",
        "> ",
        "## optimization",
        "> ",
        "fit <- aft_nl(~s_ncon(st, m=c(4,2), k = 10, trans = trans_linear()), data = dat,",
        "+ ",
        "              censored = dat$c, trace = TRUE)",
        "Errore in colSums2(X + X1/d1) : non trovo la funzione \"colSums2\"\nIn aggiunta: Messaggi di avvertimento:\n1: In log(d1) : Si è prodotto un NaN\n2: In log(o$store$f1) : Si è prodotto un NaN\n",
        "> ",
        "document()",
        "\u001B[38;5;232m\u001B[36mℹ\u001B[38;5;232m Updating \u001B[34maftNested\u001B[38;5;232m documentation\u001B[39m\n\u001B[38;5;232m\u001B[36mℹ\u001B[38;5;232m Loading \u001B[34maftNested\u001B[38;5;232m\u001B[39m\n",
        "Caricamento del pacchetto richiesto: matrixStats\n",
        "> ",
        "load_all()",
        "\u001B[38;5;232m\u001B[36mℹ\u001B[38;5;232m Loading \u001B[34maftNested\u001B[38;5;232m\u001B[39m\n",
        "> ",
        "## optimization",
        "> ",
        "fit <- aft_nl(~s_ncon(st, m=c(4,2), k = 10, trans = trans_linear()), data = dat,",
        "+ ",
        "              censored = dat$c, trace = TRUE)",
        "[1] NaN\n[1] NaN\n[1] NaN\n[1] NaN\n[1] NaN\n[1] NaN\n[1] NaN\n[1] NaN\n[1] NaN\n[1] NaN\n[1] NaN\n[1] NaN\n[1] NaN\n[1] NaN\n[1] NaN\n",
        "Ci sono stati 44 avvertimenti (utilizza warnings() per visualizzarli)\n",
        "> ",
        "llk(c(alph, bet))",
        "[1] NaN\nattr(,\"gradient\")\n              [,1]\n [1,] 1.725173e+26\n [2,] 3.060742e+26\n [3,] 2.826951e+26\n [4,] 1.327095e+26\n [5,] 1.288074e+26\n [6,] 1.332329e+26\n [7,] 2.753981e+25\n [8,] 3.107181e+26\n [9,] 2.288271e+25\n[10,] 2.740686e+26\n[11,] 7.922965e+25\n[12,] 1.350357e+26\n[13,] 1.072626e+26\nattr(,\"hessian\")\n              [,1]         [,2]         [,3]         [,4]\n [1,] 1.483887e+27 2.572028e+27 2.371468e+27 1.114425e+27\n [2,] 2.572028e+27 4.577200e+27 4.227116e+27 1.975292e+27\n [3,] 2.371468e+27 4.227116e+",
        "27 3.905576e+27 1.824194e+27\n [4,] 1.114425e+27 1.975292e+27 1.824194e+27 8.466678e+26\n [5,] 1.083208e+27 1.919998e+27 1.773119e+27 8.217753e+26\n [6,] 1.121336e+27 1.987604e+27 1.835546e+27 8.500111e+26\n [7,] 2.324191e+26 4.119625e+26 3.804400e+26 1.757023e+26\n [8,] 2.622503e+27 4.648747e+27 4.293051e+27 1.982360e+27\n [9,] 1.935356e+26 3.431225e+26 3.168683e+26 1.459902e+26\n[10,] 2.321700e+27 4.115965e+27 3.800997e+27 1.748547e+27\n[11,] 6.674519e+26 1.184343e+27 1.093804e+27 5.054606e+26\n[12,] 1.139329e+27 ",
        "2.027588e+27 1.872932e+27 8.614006e+26\n[13,] 8.965194e+26 1.603308e+27 1.481553e+27 6.841036e+26\n              [,5]         [,6]         [,7]         [,8]\n [1,] 1.083208e+27 1.121336e+27 2.324191e+26 2.622503e+27\n [2,] 1.919998e+27 1.987604e+27 4.119625e+26 4.648747e+27\n [3,] 1.773119e+27 1.835546e+27 3.804400e+26 4.293051e+27\n [4,] 8.217753e+26 8.500111e+26 1.757023e+26 1.982360e+27\n [5,] 9.264225e+26 8.250210e+26 1.705369e+26 1.924081e+27\n [6,] 8.250210e+26 9.866016e+26 1.763967e+26 1.990194e+27\n [7,] 1.7",
        "05369e+26 1.763967e+26 6.400217e+25 4.113865e+26\n [8,] 1.924081e+27 1.990194e+27 4.113865e+26 4.952186e+27\n [9,] 1.416984e+26 1.465674e+26 3.029651e+25 3.418206e+26\n[10,] 1.697143e+27 1.755460e+27 3.628661e+26 4.094039e+27\n[11,] 4.906008e+26 5.074584e+26 1.048949e+26 1.183480e+27\n[12,] 8.360783e+26 8.648081e+26 1.787609e+26 2.016893e+27\n[13,] 6.639931e+26 6.868094e+26 1.419660e+26 1.601771e+27\n              [,9]        [,10]        [,11]        [,12]\n [1,] 1.935356e+26 2.321700e+27 6.674519e+26 1.139329e+27",
        "\n [2,] 3.431225e+26 4.115965e+27 1.184343e+27 2.027588e+27\n [3,] 3.168683e+26 3.800997e+27 1.093804e+27 1.872932e+27\n [4,] 1.459902e+26 1.748547e+27 5.054606e+26 8.614006e+26\n [5,] 1.416984e+26 1.697143e+27 4.906008e+26 8.360783e+26\n [6,] 1.465674e+26 1.755460e+27 5.074584e+26 8.648081e+26\n [7,] 3.029651e+25 3.628661e+26 1.048949e+26 1.787609e+26\n [8,] 3.418206e+26 4.094039e+27 1.183480e+27 2.016893e+27\n [9,] 4.805612e+25 3.015059e+26 8.715770e+25 1.485372e+26\n[10,] 3.015059e+26 3.885253e+27 1.043899e+27 1.",
        "779037e+27\n[11,] 8.715770e+25 1.043899e+27 3.810041e+26 5.143421e+26\n[12,] 1.485372e+26 1.779037e+27 5.143421e+26 1.011959e+27\n[13,] 1.179676e+26 1.412885e+27 4.085547e+26 6.969345e+26\n             [,13]\n [1,] 8.965194e+26\n [2,] 1.603308e+27\n [3,] 1.481553e+27\n [4,] 6.841036e+26\n [5,] 6.639931e+26\n [6,] 6.868094e+26\n [7,] 1.419660e+26\n [8,] 1.601771e+27\n [9,] 1.179676e+26\n[10,] 1.412885e+27\n[11,] 4.085547e+26\n[12,] 6.969345e+26\n[13,] 6.616557e+26\n",
        "Messaggi di avvertimento:\n1: In log(d1) : Si è prodotto un NaN\n2: In log(o$store$f1) : Si è prodotto un NaN\n",
        "> ",
        "source(\"~/Dropbox/dottorato pd/Accelerated_failure_time/code/simulations.R\", echo=TRUE)",
        "\n> rm(list = ls())\n\n> set.seed(123)\n\n> ## simulate data ####\n> n <- 1000\n\n> p <- 2\n\n> X <- matrix(runif(n*p), ncol = p)\n\n> params <- rnorm(p)\n\n> theta <- c(lambda1 = 0.1, gamma1 = 3, lambda2=0.1, gamma2=1.6, p=0.8)\n\n> S0 <- function(t, p, lambda1 = 0.1, gamma1 = 3, lambda2=0.1, gamma2=1.6){\n+   p*exp(-lambda1*t^gamma1) + (1-p)*exp(-lambda2 * t^gamma2)\n+ }\n\n> wrap_rweibull <- function(n, lambda, gamma){\n+   # generate from a weibull using the parametrization in the draft\n+   sc <- lambda^(-1/gamma); sh <- ..",
        ".. [TRUNCATED] \n\n> pp <- rbinom(n, size = 1, prob = theta[\"p\"])\n\n> rw1 <- apply(X, 1,\n+              FUN = function(xx) wrap_rweibull(1, theta[\"lambda1\"]*exp(- xx%*%params * theta[\"gamma1\"]),\n+                       .... [TRUNCATED] \n\n> rw2 <- apply(X, 1,\n+              FUN = function(xx) wrap_rweibull(1, theta[\"lambda2\"]*exp(- xx%*%params * theta[\"gamma2\"]),\n+                       .... [TRUNCATED] \n\n> times <- rw1*pp + (1-pp)*rw2\n\n> par(mfrow = c(1,2))\n\n> hist(times, breaks = 50)\n\n> dat <- data.frame(time",
        "s = times)\n\n> dat$st <- cbind(log(times), X)\n\n> # add censoring ####\n> C <- quantile(times, 0.9)\n\n> dat$c <- as.numeric(dat$times<C)\n\n> dat$st[dat$c==0,1] <- log(C)\n\n> dat$times[dat$c==0] <- C\n\n> hist(dat$times, breaks = 50)\n\n> ## generate basis ####\n> library(devtools)\n\n> load_all()\n\u001B[38;5;232m\u001B[36mℹ\u001B[38;5;232m Loading \u001B[34maftNested\u001B[38;5;232m\u001B[39m\n\n> sm_si <- gamFactory:::smooth.construct.si.smooth.spec(object = s_nest(st, m=c(4,2), k = 10,\n+                                                        .... ",
        "[TRUNCATED] \n",
        "Errore in s_nest(st, m = c(4, 2), k = 10, trans = trans_linear()) : \n  non trovo la funzione \"s_nest\"\n",
        "> ",
        "source(\"~/Dropbox/dottorato pd/Accelerated_failure_time/code/simulations.R\", echo=TRUE)",
        "\n> rm(list = ls())\n\n> set.seed(123)\n\n> ## simulate data ####\n> n <- 1000\n\n> p <- 2\n\n> X <- matrix(runif(n*p), ncol = p)\n\n> params <- rnorm(p)\n\n> theta <- c(lambda1 = 0.1, gamma1 = 3, lambda2=0.1, gamma2=1.6, p=0.8)\n\n> S0 <- function(t, p, lambda1 = 0.1, gamma1 = 3, lambda2=0.1, gamma2=1.6){\n+   p*exp(-lambda1*t^gamma1) + (1-p)*exp(-lambda2 * t^gamma2)\n+ }\n\n> wrap_rweibull <- function(n, lambda, gamma){\n+   # generate from a weibull using the parametrization in the draft\n+   sc <- lambda^(-1/gamma); sh <- ..",
        ".. [TRUNCATED] \n\n> pp <- rbinom(n, size = 1, prob = theta[\"p\"])\n\n> rw1 <- apply(X, 1,\n+              FUN = function(xx) wrap_rweibull(1, theta[\"lambda1\"]*exp(- xx%*%params * theta[\"gamma1\"]),\n+                       .... [TRUNCATED] \n\n> rw2 <- apply(X, 1,\n+              FUN = function(xx) wrap_rweibull(1, theta[\"lambda2\"]*exp(- xx%*%params * theta[\"gamma2\"]),\n+                       .... [TRUNCATED] \n\n> times <- rw1*pp + (1-pp)*rw2\n\n> par(mfrow = c(1,2))\n\n> hist(times, breaks = 50)\n\n> dat <- data.frame(time",
        "s = times)\n\n> dat$st <- cbind(log(times), X)\n\n> # add censoring ####\n> C <- quantile(times, 0.9)\n\n> dat$c <- as.numeric(dat$times<C)\n\n> dat$st[dat$c==0,1] <- log(C)\n\n> dat$times[dat$c==0] <- C\n\n> hist(dat$times, breaks = 50)\n\n> ## generate basis ####\n> library(devtools)\n\n> load_all()\n\u001B[38;5;232m\u001B[36mℹ\u001B[38;5;232m Loading \u001B[34maftNested\u001B[38;5;232m\u001B[39m\n\n> sm_misi <- gamFactory:::smooth.construct.si.smooth.spec(object = s_ncon(st, m=c(4,2), k = 10,\n+                                                      .... ",
        "[TRUNCATED] \n\n> beta <- rnorm(ncol(X[[1]]))\n",
        "Errore in rnorm(ncol(X[[1]])) : argomenti non validi\n",
        "> ",
        "X",
        "                [,1]        [,2]\n   [1,] 0.2875775201 0.273622734\n   [2,] 0.7883051354 0.593866933\n   [3,] 0.4089769218 0.160184813\n   [4,] 0.8830174040 0.853430239\n   [5,] 0.9404672843 0.847739158\n   [6,] 0.0455564994 0.477886813\n   [7,] 0.5281054880 0.773692122\n   [8,] 0.8924190444 0.295400081\n   [9,] 0.5514350145 0.065628112\n  [10,] 0.4566147353 0.440533125\n  [11,] 0.9568333453 0.462098858\n  [12,] 0.4533341562 0.340934370\n  [13,] 0.6775706355 0.185140319\n  [14,] 0.5726334020 0.506997727\n  [15,] 0.1029246",
        "827 0.019191031\n  [16,] 0.8998249704 0.773686039\n  [17,] 0.2460877344 0.559665079\n  [18,] 0.0420595335 0.641462639\n  [19,] 0.3279207193 0.468432119\n  [20,] 0.9545036491 0.279223811\n  [21,] 0.8895393161 0.461216570\n  [22,] 0.6928034062 0.792738342\n  [23,] 0.6405068138 0.585565576\n  [24,] 0.9942697766 0.394758986\n  [25,] 0.6557057991 0.811237350\n  [26,] 0.7085304682 0.318563094\n  [27,] 0.5440660247 0.581447338\n  [28,] 0.5941420204 0.455488958\n  [29,] 0.2891597373 0.268803450\n  [30,] 0.1471136473 0.555177205\n ",
        " [31,] 0.9630242325 0.231230884\n  [32,] 0.9022990451 0.543232898\n  [33,] 0.6907052784 0.447570141\n  [34,] 0.7954674177 0.130288137\n  [35,] 0.0246136845 0.621725983\n  [36,] 0.4777959711 0.547994283\n  [37,] 0.7584595375 0.149244214\n  [38,] 0.2164079358 0.559545869\n  [39,] 0.3181810076 0.426885576\n  [40,] 0.2316257854 0.447730098\n  [41,] 0.1428000224 0.833294772\n  [42,] 0.4145463358 0.719587283\n  [43,] 0.4137243263 0.456886756\n  [44,] 0.3688454509 0.521264263\n  [45,] 0.1524447477 0.242457078\n  [46,] 0.13880606",
        "34 0.075860835\n  [47,] 0.2330340995 0.391295091\n  [48,] 0.4659624503 0.013108216\n  [49,] 0.2659726404 0.867499469\n  [50,] 0.8578277153 0.992615674\n  [51,] 0.0458311667 0.708855388\n  [52,] 0.4422000742 0.826715490\n  [53,] 0.7989248456 0.891896270\n  [54,] 0.1218992600 0.539410733\n  [55,] 0.5609479838 0.555313592\n  [56,] 0.2065313896 0.276439884\n  [57,] 0.1275316502 0.659197926\n  [58,] 0.7533078643 0.243435242\n  [59,] 0.8950453592 0.288266205\n  [60,] 0.3744627759 0.715780959\n  [61,] 0.6651151946 0.727533633\n  ",
        "[62,] 0.0948406609 0.173043039\n  [63,] 0.3839696378 0.306311259\n  [64,] 0.2743836446 0.369907277\n  [65,] 0.8146400389 0.077721554\n  [66,] 0.4485163414 0.713150189\n  [67,] 0.8100643530 0.550922729\n  [68,] 0.8123895095 0.135865396\n  [69,] 0.7943423211 0.974163694\n  [70,] 0.4398316876 0.561963159\n  [71,] 0.7544751586 0.788409382\n  [72,] 0.6292211316 0.848914084\n  [73,] 0.7101824014 0.878041775\n  [74,] 0.0006247733 0.800476374\n  [75,] 0.4753165741 0.640148486\n  [76,] 0.2201188852 0.628927761\n  [77,] 0.379816537",
        "7 0.271409005\n  [78,] 0.6127710033 0.029939825\n  [79,] 0.3517979092 0.419864215\n  [80,] 0.1111354243 0.355434671\n  [81,] 0.2436194727 0.392331254\n  [82,] 0.6680555874 0.171936832\n  [83,] 0.4176467797 0.319642119\n  [84,] 0.7881958340 0.413555064\n  [85,] 0.1028646443 0.759335697\n  [86,] 0.4348927415 0.271890205\n  [87,] 0.9849569800 0.115582457\n  [88,] 0.8930511144 0.029336615\n  [89,] 0.8864690608 0.806855298\n  [90,] 0.1750526503 0.480126437\n  [91,] 0.1306956916 0.806247940\n  [92,] 0.6531019250 0.079005682\n  [",
        "93,] 0.3435164723 0.115337410\n  [94,] 0.6567581280 0.129416290\n  [95,] 0.3203732425 0.738748542\n  [96,] 0.1876911193 0.757098533\n  [97,] 0.7822943013 0.992455309\n  [98,] 0.0935949867 0.624552987\n  [99,] 0.4667790416 0.288690109\n [100,] 0.5115054599 0.199911774\n [101,] 0.5999889593 0.800917849\n [102,] 0.3328235403 0.727762710\n [103,] 0.4886130337 0.217047975\n [104,] 0.9544738275 0.744238505\n [105,] 0.4829023972 0.866653708\n [106,] 0.8903502221 0.529405756\n [107,] 0.9144381869 0.598638547\n [108,] 0.6087349823",
        " 0.937632332\n [109,] 0.4106897765 0.950724098\n [110,] 0.1470946909 0.660532301\n [111,] 0.9352998033 0.072286581\n [112,] 0.3012289000 0.826331579\n [113,] 0.0607205715 0.479544078\n [114,] 0.9477269400 0.391228783\n [115,] 0.7205962734 0.299122776\n [116,] 0.1422942956 0.244308250\n [117,] 0.5492846561 0.421810132\n [118,] 0.9540912386 0.937770177\n [119,] 0.5854833531 0.264485117\n [120,] 0.4045102817 0.568568754\n [121,] 0.6478934793 0.202184568\n [122,] 0.3198206171 0.192805627\n [123,] 0.3077200109 0.718611745\n [12",
        "4,] 0.2197676313 0.313517896\n [125,] 0.3694888658 0.138390127\n [126,] 0.9842192035 0.058030698\n [127,] 0.1542023008 0.931099641\n [128,] 0.0910439999 0.568338012\n [129,] 0.1419069078 0.117770361\n [130,] 0.6900071015 0.564794481\n [131,] 0.6192564834 0.540256183\n [132,] 0.8913941171 0.819682518\n [133,] 0.6729990926 0.702979504\n [134,] 0.7370777379 0.567748374\n [135,] 0.5211357258 0.721309266\n [136,] 0.6598384497 0.752444213\n [137,] 0.8218054601 0.381422597\n [138,] 0.7862815517 0.288010281\n [139,] 0.9798219174 ",
        "0.531683327\n [140,] 0.4394315362 0.259646071\n [141,] 0.3117022021 0.831790318\n [142,] 0.4094749526 0.405363885\n [143,] 0.0104671118 0.072631926\n [144,] 0.1838495240 0.953758625\n [145,] 0.8427293189 0.217183783\n [146,] 0.2311617821 0.405625267\n [147,] 0.2390999557 0.625668315\n [148,] 0.0766911653 0.628404804\n [149,] 0.2457236780 0.328238664\n [150,] 0.7321352055 0.138909492\n [151,] 0.8474531651 0.914657170\n [152,] 0.4975272671 0.599115967\n [153,] 0.3879090298 0.749607096\n [154,] 0.2464489941 0.918954745\n [155",
        ",] 0.1110964613 0.528765396\n [156,] 0.3899944352 0.371978746\n [157,] 0.5719353140 0.065808321\n [158,] 0.2168927628 0.854369924\n [159,] 0.4447680020 0.510411301\n [160,] 0.2179906687 0.209998059\n [161,] 0.5022995633 0.375843437\n [162,] 0.3539045718 0.207365500\n [163,] 0.6499851588 0.459240817\n [164,] 0.3747139566 0.241502250\n [165,] 0.3554453808 0.118690322\n [166,] 0.5336879455 0.072469150\n [167,] 0.7403343604 0.690989850\n [168,] 0.2211029378 0.286957619\n [169,] 0.4127461186 0.149412496\n [170,] 0.2656866868 0",
        ".972432009\n [171,] 0.6299730535 0.410514390\n [172,] 0.1838284908 0.401813854\n [173,] 0.8636441114 0.648556349\n [174,] 0.7465680041 0.916305740\n [175,] 0.6682846497 0.216662139\n [176,] 0.6180178733 0.547998872\n [177,] 0.3722380602 0.720050458\n [178,] 0.5298356859 0.397246005\n [179,] 0.8746823429 0.094001393\n [180,] 0.5817500998 0.634896405\n [181,] 0.8397677648 0.002478810\n [182,] 0.3124481649 0.210523240\n [183,] 0.7082903222 0.679022809\n [184,] 0.2650178061 0.866189130\n [185,] 0.5943431940 0.799697116\n [186,",
        "] 0.4812898005 0.134996398\n [187,] 0.2650327315 0.387498258\n [188,] 0.5645904348 0.788471929\n [189,] 0.9131882230 0.692913667\n [190,] 0.9018743895 0.594272971\n [191,] 0.2741666215 0.123857651\n [192,] 0.3214827564 0.555078103\n [193,] 0.9856408844 0.449411388\n [194,] 0.6199933102 0.766166529\n [195,] 0.9373140892 0.026097722\n [196,] 0.4665327023 0.195171432\n [197,] 0.4068325933 0.881234565\n [198,] 0.6592303242 0.109801593\n [199,] 0.1523466168 0.968550928\n [200,] 0.5728670582 0.385198593\n [201,] 0.2387260268 0.",
        "858591407\n [202,] 0.9623589364 0.887384755\n [203,] 0.6013657260 0.489091499\n [204,] 0.5150297272 0.718091809\n [205,] 0.4025733422 0.486705573\n [206,] 0.8802465412 0.988708861\n [207,] 0.3640918648 0.064751130\n [208,] 0.2882392807 0.157662778\n [209,] 0.1706452351 0.785348618\n [210,] 0.1721717464 0.542188290\n [211,] 0.4820426055 0.416547345\n [212,] 0.2529649285 0.998882649\n [213,] 0.2162547896 0.255673117\n [214,] 0.6743763881 0.507875671\n [215,] 0.0476636274 0.078971178\n [216,] 0.7008530875 0.813668364\n [217,]",
        " 0.3518886385 0.382179160\n [218,] 0.4089439979 0.802182708\n [219,] 0.8209513240 0.197923637\n [220,] 0.9188573482 0.946399770\n [221,] 0.2825283301 0.345672474\n [222,] 0.9611047937 0.522050247\n [223,] 0.7283944283 0.111688006\n [224,] 0.6863750820 0.885974851\n [225,] 0.0528439428 0.954254973\n [226,] 0.3952201346 0.040380763\n [227,] 0.4778453798 0.493616189\n [228,] 0.5602532637 0.226063705\n [229,] 0.6982615949 0.858800339\n [230,] 0.9156835384 0.530935734\n [231,] 0.6183512274 0.004638151\n [232,] 0.4284215088 0.2",
        "77560080\n [233,] 0.5420803672 0.325203143\n [234,] 0.0584784886 0.588706277\n [235,] 0.2608568571 0.249684701\n [236,] 0.3971519533 0.043117281\n [237,] 0.1977447367 0.110678788\n [238,] 0.8319275628 0.703753812\n [239,] 0.1528872228 0.939021239\n [240,] 0.8034185420 0.311169018\n [241,] 0.5468261566 0.078492930\n [242,] 0.6623176420 0.321744091\n [243,] 0.1716984939 0.624905537\n [244,] 0.6330553598 0.440241850\n [245,] 0.3118697468 0.801345301\n [246,] 0.7245543464 0.279283805\n [247,] 0.3989398247 0.570713193\n [248,] ",
        "0.9693564111 0.042128012\n [249,] 0.9673983706 0.190717455\n [250,] 0.7267025390 0.727086471\n [251,] 0.2572167465 0.826690050\n [252,] 0.2217879347 0.510721075\n [253,] 0.5930456517 0.567726166\n [254,] 0.2675214321 0.001155820\n [255,] 0.5310703989 0.143778103\n [256,] 0.7852916713 0.865967083\n [257,] 0.1680608105 0.082561061\n [258,] 0.4043991810 0.244570682\n [259,] 0.4715762776 0.981543157\n [260,] 0.8681068069 0.577581279\n [261,] 0.9257079558 0.248726364\n [262,] 0.8819775593 0.614953954\n [263,] 0.6741868425 0.03",
        "1757321\n [264,] 0.9501669793 0.146423544\n [265,] 0.5164448943 0.703072974\n [266,] 0.5765190213 0.065560709\n [267,] 0.3363312059 0.621807062\n [268,] 0.3473246314 0.937327365\n [269,] 0.0200243006 0.087894615\n [270,] 0.5028130456 0.972803509\n [271,] 0.8710434136 0.026010711\n [272,] 0.0063007839 0.725227952\n [273,] 0.0720571240 0.453706392\n [274,] 0.1642112250 0.566182405\n [275,] 0.7703340743 0.872731046\n [276,] 0.7351843058 0.554563180\n [277,] 0.9718756357 0.737652207\n [278,] 0.4664723768 0.623129162\n [279,] 0",
        ".0743845133 0.311028406\n [280,] 0.6488181243 0.392196485\n [281,] 0.7585931695 0.202087455\n [282,] 0.1371060810 0.852780390\n [283,] 0.3965845946 0.606830151\n [284,] 0.2249853292 0.756098014\n [285,] 0.0579585605 0.562516809\n [286,] 0.3958926883 0.275899013\n [287,] 0.0649283000 0.735558404\n [288,] 0.2258864329 0.549279794\n [289,] 0.0546291091 0.346127044\n [290,] 0.6702820396 0.514965635\n [291,] 0.2977417826 0.815767948\n [292,] 0.1007215823 0.526272569\n [293,] 0.0719040972 0.203040050\n [294,] 0.8804405688 0.848",
        "107680\n [295,] 0.7542474021 0.370494215\n [296,] 0.8166058876 0.303325171\n [297,] 0.9821403737 0.770597047\n [298,] 0.1035996450 0.733448555\n [299,] 0.0990418294 0.838905998\n [300,] 0.7988316112 0.569048842\n [301,] 0.7845752665 0.026280838\n [302,] 0.0094299051 0.486127228\n [303,] 0.7790658828 0.542681033\n [304,] 0.7293906519 0.836660117\n [305,] 0.6301318528 0.728664538\n [306,] 0.4809108300 0.555113807\n [307,] 0.1566368514 0.073414397\n [308,] 0.0082155198 0.136502299\n [309,] 0.4524583942 0.684608696\n [310,] 0.",
        "4922933287 0.099621936\n [311,] 0.3895871115 0.203785905\n [312,] 0.4646659419 0.365980138\n [313,] 0.7132790007 0.846195758\n [314,] 0.0553019263 0.236872596\n [315,] 0.3547830975 0.704877851\n [316,] 0.8028122729 0.107608831\n [317,] 0.8357088370 0.779068869\n [318,] 0.2377494050 0.255105683\n [319,] 0.3539861026 0.548043326\n [320,] 0.8568854202 0.033901521\n [321,] 0.8537633738 0.806109476\n [322,] 0.2958954554 0.337752807\n [323,] 0.1470483246 0.916285858\n [324,] 0.7039920613 0.357106418\n [325,] 0.1038066882 0.9753",
        "65013\n [326,] 0.0337277730 0.384378523\n [327,] 0.9994045279 0.488673535\n [328,] 0.0348748041 0.490776231\n [329,] 0.3383912838 0.012254624\n [330,] 0.9150637616 0.641473201\n [331,] 0.6172352696 0.512574972\n [332,] 0.2862853487 0.320352118\n [333,] 0.7377974030 0.581433158\n [334,] 0.8340543092 0.617344408\n [335,] 0.3142707804 0.438274538\n [336,] 0.4925665478 0.170368981\n [337,] 0.6973737662 0.715080497\n [338,] 0.6414623540 0.747786549\n [339,] 0.6439229150 0.843914708\n [340,] 0.9778534048 0.534759047\n [341,] 0.4",
        "147353345 0.302235262\n [342,] 0.1194047800 0.456518182\n [343,] 0.5260296601 0.384342534\n [344,] 0.2250733508 0.249046855\n [345,] 0.4864117641 0.654626745\n [346,] 0.3702147985 0.955323702\n [347,] 0.9833501808 0.291082957\n [348,] 0.3883191152 0.650189087\n [349,] 0.2292448403 0.536359931\n [350,] 0.6232975463 0.597451867\n [351,] 0.1365401971 0.024898269\n [352,] 0.9674694943 0.004841740\n [353,] 0.5150718079 0.131378254\n [354,] 0.1630703292 0.024817104\n [355,] 0.6219022952 0.092129452\n [356,] 0.9859541652 0.47555",
        "8224\n [357,] 0.6687715175 0.196656761\n [358,] 0.4189158969 0.814673949\n [359,] 0.3233449932 0.244059228\n [360,] 0.8352553200 0.488807638\n [361,] 0.1438170436 0.648882480\n [362,] 0.1928159469 0.158716470\n [363,] 0.8967386826 0.836977911\n [364,] 0.3081195543 0.436596530\n [365,] 0.3633005435 0.233495525\n [366,] 0.7839464787 0.298855992\n [367,] 0.1933786799 0.159421337\n [368,] 0.0177658119 0.585567104\n [369,] 0.4066078663 0.148777977\n [370,] 0.4831676693 0.179059560\n [371,] 0.4218449502 0.339221505\n [372,] 0.34",
        "28088017 0.183901939\n [373,] 0.8664833147 0.405541522\n [374,] 0.4551080510 0.613559618\n [375,] 0.5337648736 0.685671334\n [376,] 0.9638433319 0.823525600\n [377,] 0.7745915421 0.373982114\n [378,] 0.2088763486 0.952841005\n [379,] 0.3087868327 0.018832159\n [380,] 0.9713424502 0.612374972\n [381,] 0.5849000935 0.463573764\n [382,] 0.7608236254 0.354729621\n [383,] 0.3727093944 0.882423029\n [384,] 0.7691939112 0.075802858\n [385,] 0.5376771830 0.883291192\n [386,] 0.9139954497 0.188221836\n [387,] 0.1852964419 0.215066",
        "747\n [388,] 0.2822184174 0.869532292\n [389,] 0.0949624132 0.060838056\n [390,] 0.2104870791 0.234899601\n [391,] 0.9770989963 0.993015513\n [392,] 0.2963021754 0.678197728\n [393,] 0.7259830269 0.435486801\n [394,] 0.7856878343 0.377309942\n [395,] 0.1054177461 0.461184024\n [396,] 0.2395946290 0.801851872\n [397,] 0.2705448724 0.662966975\n [398,] 0.1010584941 0.466003664\n [399,] 0.1179138413 0.053259437\n [400,] 0.9912365559 0.237197918\n [401,] 0.9860542973 0.233239738\n [402,] 0.1370674714 0.230653601\n [403,] 0.905",
        "3095817 0.061726274\n [404,] 0.5763018376 0.497118609\n [405,] 0.3954488591 0.244125089\n [406,] 0.4498024841 0.758185539\n [407,] 0.7065019011 0.547302678\n [408,] 0.0825027458 0.948066896\n [409,] 0.3393125802 0.086172192\n [410,] 0.6807875512 0.947882585\n [411,] 0.3169492481 0.722398868\n [412,] 0.8315685980 0.922004605\n [413,] 0.2151720827 0.613840944\n [414,] 0.4979489362 0.160966501\n [415,] 0.2760496726 0.182940692\n [416,] 0.1920233187 0.730183562\n [417,] 0.9506212641 0.589525650\n [418,] 0.3217255378 0.3124823",
        "63\n [419,] 0.4784563838 0.772794399\n [420,] 0.0279925719 0.336298202\n [421,] 0.5474594680 0.855676691\n [422,] 0.6442402205 0.580528494\n [423,] 0.5962635446 0.415722651\n [424,] 0.3219373757 0.932572785\n [425,] 0.8911143125 0.462698841\n [426,] 0.6262569474 0.099346330\n [427,] 0.3029049153 0.465449363\n [428,] 0.3882046638 0.984083858\n [429,] 0.1604750925 0.925272866\n [430,] 0.8625518975 0.435398764\n [431,] 0.9531012138 0.869720716\n [432,] 0.5636446835 0.300354172\n [433,] 0.3295474134 0.797972631\n [434,] 0.9966",
        "172187 0.800510712\n [435,] 0.2348196758 0.386925696\n [436,] 0.6126719653 0.381589695\n [437,] 0.1081785294 0.645515614\n [438,] 0.4870325699 0.861667454\n [439,] 0.0994458233 0.656632671\n [440,] 0.1611657627 0.516326074\n [441,] 0.2829928708 0.148781583\n [442,] 0.5838723360 0.612765903\n [443,] 0.7317076589 0.041966819\n [444,] 0.1655209111 0.498358993\n [445,] 0.8664677632 0.739508222\n [446,] 0.7085741372 0.753899779\n [447,] 0.7603995362 0.063093741\n [448,] 0.1470841086 0.442481933\n [449,] 0.3580569634 0.50067169",
        "9\n [450,] 0.6733324814 0.270243100\n [451,] 0.5238226017 0.598802149\n [452,] 0.3498017928 0.735837626\n [453,] 0.2405307016 0.713577812\n [454,] 0.0581917963 0.116492937\n [455,] 0.2366197421 0.575120618\n [456,] 0.8900779132 0.798131987\n [457,] 0.8118274161 0.231823797\n [458,] 0.7475163222 0.724855826\n [459,] 0.1549117258 0.838023198\n [460,] 0.1247420886 0.118838571\n [461,] 0.9747258085 0.958950397\n [462,] 0.4361299961 0.747764584\n [463,] 0.4640166268 0.810889479\n [464,] 0.1652980812 0.189917723\n [465,] 0.58493",
        "65573 0.025968777\n [466,] 0.2707780194 0.863782292\n [467,] 0.2300969204 0.919179865\n [468,] 0.6912078315 0.137627988\n [469,] 0.2828523996 0.477648622\n [470,] 0.8103980662 0.462961500\n [471,] 0.0939166071 0.700178611\n [472,] 0.8220300712 0.065574901\n [473,] 0.4274282807 0.733039993\n [474,] 0.7558872597 0.395931590\n [475,] 0.6623855066 0.461487845\n [476,] 0.4445273969 0.725299363\n [477,] 0.6271461844 0.470002647\n [478,] 0.0004653491 0.999523978\n [479,] 0.2172435140 0.845935792\n [480,] 0.7048722457 0.828207304",
        "\n [481,] 0.2151664882 0.761644344\n [482,] 0.8139337213 0.112106492\n [483,] 0.3077638743 0.838977019\n [484,] 0.6877426857 0.813850524\n [485,] 0.9326810790 0.991412194\n [486,] 0.1157796648 0.048314525\n [487,] 0.1277056879 0.746787912\n [488,] 0.6782238574 0.419313522\n [489,] 0.4289485959 0.582143897\n [490,] 0.8344009779 0.830734062\n [491,] 0.9714380668 0.013530627\n [492,] 0.0704889777 0.011521763\n [493,] 0.4597851932 0.996445707\n [494,] 0.7015851184 0.765689667\n [495,] 0.0869401679 0.314662611\n [496,] 0.992944",
        "0161 0.812011744\n [497,] 0.2530989940 0.991219217\n [498,] 0.0495384356 0.200759593\n [499,] 0.6863249468 0.646037220\n [500,] 0.7869273527 0.437550729\n [ raggiunto getOption(\"max.print\") -- omesse 500 righe ]\n",
        "> ",
        "beta <- rnorm(ncol(X))",
        "> ",
        "betat <- c(beta[1], exp(beta[-1]))",
        "> ",
        "z <- dat[[sm_misi$term]] %*% sm_misi$xt$si$alpha",
        "> ",
        "X <- sm_misi$xt$basis$evalX(z, deriv = 1)",
        "> ",
        "ss <- X$X0%*%betat",
        "Errore in X$X0 %*% betat : gli argomenti non sono compatibili\n",
        "> ",
        "ss1 <- X$X1%*% betat",
        "Errore in X$X1 %*% betat : gli argomenti non sono compatibili\n",
        "> ",
        "beta",
        "[1] -0.7045145 -0.5339841\n",
        "> ",
        "beta <- rnorm(ncol(sm_misi$X)-length(sm_misi$xt$si$alpha))",
        "> ",
        "betat <- c(beta[1], exp(beta[-1]))",
        "> ",
        "z <- dat[[sm_misi$term]] %*% sm_misi$xt$si$alpha",
        "> ",
        "X <- sm_misi$xt$basis$evalX(z, deriv = 1)",
        "> ",
        "ss <- X$X0%*%betat",
        "> ",
        "ss1 <- X$X1%*% betat",
        "> ",
        "plot(ss~z)",
        "> ",
        "plot(ss1~z);abline(h=0, col=\"grey\")",
        "> ",
        "xx <- seq(-10,10, length.out = 1000)",
        "> ",
        "matplot(sm_misi$xt$basis$evalX(xx, deriv = 1)$X0, x = xx, type = 'l')",
        "> ",
        "sm_misi <- aftNested::smooth.construct.misi.smooth.spec(object = s_ncon(st, m=c(4,2), k = 10,",
        "+ ",
        "                                                         trans = trans_linear()),",
        "+ ",
        "                                        data = dat, knots = list())",
        "> ",
        "beta <- rnorm(ncol(sm_misi$X)-length(sm_misi$xt$si$alpha))",
        "> ",
        "betat <- c(beta[1], exp(beta[-1]))",
        "> ",
        "z <- dat[[sm_misi$term]] %*% sm_misi$xt$si$alpha",
        "> ",
        "X <- sm_misi$xt$basis$evalX(z, deriv = 1)",
        "> ",
        "ss <- X$X0%*%betat",
        "> ",
        "ss1 <- X$X1%*% betat",
        "> ",
        "plot(ss~z)",
        "> ",
        "plot(ss1~z);abline(h=0, col=\"grey\")",
        "> ",
        "xx <- seq(-10,10, length.out = 1000)",
        "> ",
        "matplot(sm_misi$xt$basis$evalX(xx, deriv = 1)$X0, x = xx, type = 'l')",
        "> ",
        "# define the smooth function",
        "> ",
        "alph <- sm_misi$xt$si$alpha",
        "> ",
        "bet <- rnorm(ncol(sm_misi$X)-(p+1))",
        "> ",
        "f1 <- eff_misi(dat$st, basis = sm_misi$xt$basis)",
        "> ",
        "f1 <- f1$eval(c(alph, bet), deriv = 2)",
        "> ",
        "## define likelihood",
        "> ",
        "llk <- llk_afc(f1, sm = sm_misi, delta = dat$c, lambda = 1, vpen = 1e4)",
        "> ",
        "llk(c(alph, bet))",
        "[1] NaN\nattr(,\"gradient\")\n               [,1]\n [1,]  7.799392e+21\n [2,] -1.294078e+20\n [3,] -1.020010e+21\n [4,]  9.655019e+20\n [5,]  6.070861e+20\n [6,]  2.480669e+21\n [7,]  4.654217e+20\n [8,]  1.364872e+21\n [9,]  3.839116e+20\n[10,]  5.946889e+20\n[11,]  7.210116e+20\n[12,] -8.123371e+19\n[13,] -1.305092e+20\nattr(,\"hessian\")\n               [,1]          [,2]          [,3]          [,4]\n [1,]  5.642916e+23 -1.049411e+22 -7.491975e+22  7.076560e+22\n [2,] -1.049411e+22  3.793960e+20  1.575601e+21 -1.218467e+21\n [3",
        ",] -7.491975e+22  1.575601e+21  1.012768e+22 -9.298723e+21\n [4,]  7.076560e+22 -1.218467e+21 -9.298723e+21  8.549781e+21\n [5,]  4.448789e+22 -7.657368e+20 -5.845520e+21  5.375886e+21\n [6,]  1.817975e+23 -3.128480e+21 -2.388677e+22  2.196681e+22\n [7,]  3.412127e+22 -5.876529e+20 -4.483739e+21  4.121556e+21\n [8,]  1.000254e+23 -1.719212e+21 -1.314050e+22  1.208589e+22\n [9,]  2.811042e+22 -4.811570e+20 -3.690935e+21  3.399104e+21\n[10,]  4.347517e+22 -7.453241e+20 -5.709509e+21  5.265631e+21\n[11,]  5.239352e+22",
        " -8.659409e+20 -6.848753e+21  6.376640e+21\n[12,] -6.310684e+21  1.929160e+20  9.127083e+20 -7.386807e+20\n[13,] -9.598220e+21  1.900868e+20  1.285817e+21 -1.161468e+21\n               [,5]          [,6]          [,7]          [,8]\n [1,]  4.448789e+22  1.817975e+23  3.412127e+22  1.000254e+23\n [2,] -7.657368e+20 -3.128480e+21 -5.876529e+20 -1.719212e+21\n [3,] -5.845520e+21 -2.388677e+22 -4.483739e+21 -1.314050e+22\n [4,]  5.375886e+21  2.196681e+22  4.121556e+21  1.208589e+22\n [5,]  3.987307e+21  1.381218e+22  ",
        "2.591530e+21  7.599301e+21\n [6,]  1.381218e+22  5.891965e+22  1.058945e+22  3.105208e+22\n [7,]  2.591530e+21  1.058945e+22  2.452285e+21  5.826189e+21\n [8,]  7.599301e+21  3.105208e+22  5.826189e+21  1.844939e+22\n [9,]  2.137272e+21  8.733274e+21  1.638586e+21  4.804966e+21\n[10,]  3.310897e+21  1.352891e+22  2.538376e+21  7.443472e+21\n[11,]  4.009492e+21  1.638356e+22  3.073866e+21  9.014315e+21\n[12,] -4.644108e+20 -1.897509e+21 -3.563176e+20 -1.043343e+21\n[13,] -7.302859e+20 -2.984030e+21 -5.599713e+20 -1.",
        "641587e+21\n               [,9]         [,10]         [,11]         [,12]\n [1,]  2.811042e+22  4.347517e+22  5.239352e+22 -6.310684e+21\n [2,] -4.811570e+20 -7.453241e+20 -8.659409e+20  1.929160e+20\n [3,] -3.690935e+21 -5.709509e+21 -6.848753e+21  9.127083e+20\n [4,]  3.399104e+21  5.265631e+21  6.376640e+21 -7.386807e+20\n [5,]  2.137272e+21  3.310897e+21  4.009492e+21 -4.644108e+20\n [6,]  8.733274e+21  1.352891e+22  1.638356e+22 -1.897509e+21\n [7,]  1.638586e+21  2.538376e+21  3.073866e+21 -3.563176e+20\n [8,]",
        "  4.804966e+21  7.443472e+21  9.014315e+21 -1.043343e+21\n [9,]  1.735311e+21  2.093466e+21  2.535578e+21 -2.926262e+20\n[10,]  2.093466e+21  3.837710e+21  3.927654e+21 -4.539547e+20\n[11,]  2.535578e+21  3.927654e+21  5.483444e+21 -5.352720e+20\n[12,] -2.926262e+20 -4.539547e+20 -5.352720e+20  1.986384e+19\n[13,] -4.614479e+20 -7.150311e+20 -8.615794e+20  1.114751e+20\n              [,13]\n [1,] -9.598220e+21\n [2,]  1.900868e+20\n [3,]  1.285817e+21\n [4,] -1.161468e+21\n [5,] -7.302859e+20\n [6,] -2.984030e+21\n [7,]",
        " -5.599713e+20\n [8,] -1.641587e+21\n [9,] -4.614479e+20\n[10,] -7.150311e+20\n[11,] -8.615794e+20\n[12,]  1.114751e+20\n[13,]  3.059506e+19\n",
        "Messaggi di avvertimento:\n1: In log(d1) : Si è prodotto un NaN\n2: In log(o$store$f1) : Si è prodotto un NaN\n",
        "> ",
        "n <- 1000",
        "> ",
        "p <- 2",
        "> ",
        "X <- matrix(runif(n*p), ncol = p)",
        "> ",
        "params <- rnorm(p)",
        "> ",
        "theta <- c(lambda1 = 0.1, gamma1 = 3, lambda2=0.1, gamma2=1.6, p=0.8)",
        "> ",
        "S0 <- function(t, p, lambda1 = 0.1, gamma1 = 3, lambda2=0.1, gamma2=1.6){",
        "+ ",
        "  p*exp(-lambda1*t^gamma1) + (1-p)*exp(-lambda2 * t^gamma2)",
        "+ ",
        "}",
        "> ",
        "wrap_rweibull <- function(n, lambda, gamma){",
        "+ ",
        "  # generate from a weibull using the parametrization in the draft",
        "+ ",
        "  sc <- lambda^(-1/gamma); sh <- gamma",
        "+ ",
        "  rweibull(n, scale = sc, shape = sh)",
        "+ ",
        "}",
        "> ",
        "pp <- rbinom(n, size = 1, prob = theta[\"p\"])",
        "> ",
        "> ",
        "rw1 <- apply(X, 1,",
        "+ ",
        "             FUN = function(xx) wrap_rweibull(1, theta[\"lambda1\"]*exp(- xx%*%params * theta[\"gamma1\"]),",
        "+ ",
        "                                              theta[\"gamma1\"]))",
        "> ",
        "rw2 <- apply(X, 1,",
        "+ ",
        "             FUN = function(xx) wrap_rweibull(1, theta[\"lambda2\"]*exp(- xx%*%params * theta[\"gamma2\"]),",
        "+ ",
        "                                              theta[\"gamma2\"]))",
        "> ",
        "times <- rw1*pp + (1-pp)*rw2",
        "> ",
        "par(mfrow = c(1,2))",
        "> ",
        "hist(times, breaks = 50)",
        "> ",
        "> ",
        "dat <- data.frame(times = times)",
        "> ",
        "dat$st <- cbind(log(times), X)",
        "> ",
        "> ",
        "# add censoring ####",
        "> ",
        "C <- quantile(times, 0.9)",
        "> ",
        "dat$c <- as.numeric(dat$times<C)",
        "> ",
        "dat$st[dat$c==0,1] <- log(C)",
        "> ",
        "dat$times[dat$c==0] <- C",
        "> ",
        "hist(dat$times, breaks = 50)",
        "> ",
        "> ",
        "## generate basis ####",
        "> ",
        "library(devtools)",
        "> ",
        "load_all()",
        "\u001B[38;5;232m\u001B[36mℹ\u001B[38;5;232m Loading \u001B[34maftNested\u001B[38;5;232m\u001B[39m\n",
        "> ",
        "sm_misi <- aftNested::smooth.construct.misi.smooth.spec(object = s_ncon(st, m=c(4,2), k = 10,",
        "+ ",
        "                                                         trans = trans_linear()),",
        "+ ",
        "                                        data = dat, knots = list())",
        "> ",
        "> ",
        "beta <- rnorm(ncol(sm_misi$X)-length(sm_misi$xt$si$alpha))",
        "> ",
        "betat <- c(beta[1], exp(beta[-1]))",
        "> ",
        "> ",
        "z <- dat[[sm_misi$term]] %*% sm_misi$xt$si$alpha",
        "> ",
        "X <- sm_misi$xt$basis$evalX(z, deriv = 1)",
        "> ",
        "ss <- X$X0%*%betat",
        "> ",
        "ss1 <- X$X1%*% betat",
        "> ",
        "plot(ss~z)",
        "> ",
        "plot(ss1~z);abline(h=0, col=\"grey\")",
        "> ",
        "> ",
        "xx <- seq(-10,10, length.out = 1000)",
        "> ",
        "matplot(sm_misi$xt$basis$evalX(xx, deriv = 1)$X0, x = xx, type = 'l')",
        "> ",
        "> ",
        "# define the smooth function",
        "> ",
        "alph <- sm_misi$xt$si$alpha",
        "> ",
        "bet <- rnorm(ncol(sm_misi$X)-(p+1))",
        "> ",
        "> ",
        "f1 <- eff_misi(dat$st, basis = sm_misi$xt$basis)",
        "> ",
        "f1 <- f1$eval(c(alph, bet), deriv = 2)",
        "> ",
        "> ",
        "## define likelihood",
        "> ",
        "llk <- llk_afc(f1, sm = sm_misi, delta = dat$c, lambda = 1, vpen = 1e4)",
        "> ",
        "llk(c(alph, bet))",
        "[1] 9.716277e+62\nattr(,\"gradient\")\n              [,1]\n [1,] 8.413556e+64\n [2,] 3.383019e+64\n [3,] 3.280763e+64\n [4,] 1.262677e+64\n [5,] 1.213596e+63\n [6,] 8.395651e+64\n [7,] 3.298192e+63\n [8,] 8.974678e+62\n [9,] 1.260194e+64\n[10,] 1.328591e+64\n[11,] 1.094519e+64\n[12,] 1.002491e+64\n[13,] 1.375927e+63\nattr(,\"hessian\")\n              [,1]         [,2]         [,3]         [,4]\n [1,] 7.270263e+66 2.921959e+66 2.833018e+66 1.100432e+66\n [2,] 2.921959e+66 1.175755e+66 1.139872e+66 4.425125e+65\n [3,] 2.833018e+66 1",
        ".139872e+66 1.106548e+66 4.291604e+65\n [4,] 1.100432e+66 4.425125e+65 4.291604e+65 1.641000e+65\n [5,] 1.057726e+65 4.253395e+64 4.125058e+64 1.577215e+64\n [6,] 7.317605e+66 2.942603e+66 2.853818e+66 1.091116e+66\n [7,] 2.874523e+65 1.155921e+65 1.121043e+65 4.286396e+64\n [8,] 7.822636e+64 3.145690e+64 3.050778e+64 1.166368e+64\n [9,] 1.098326e+66 4.416658e+65 4.283394e+65 1.637774e+65\n[10,] 1.159055e+66 4.660921e+65 4.520325e+65 1.726678e+65\n[11,] 9.564775e+65 3.846380e+65 3.730409e+65 1.422491e+65\n[12,] 8.75",
        "0094e+65 3.518709e+65 3.412583e+65 1.302874e+65\n[13,] 1.198610e+65 4.819893e+64 4.674444e+64 1.788175e+64\n              [,5]         [,6]         [,7]         [,8]\n [1,] 1.057726e+65 7.317605e+66 2.874523e+65 7.822636e+64\n [2,] 4.253395e+64 2.942603e+66 1.155921e+65 3.145690e+64\n [3,] 4.125058e+64 2.853818e+66 1.121043e+65 3.050778e+64\n [4,] 1.577215e+64 1.091116e+66 4.286396e+64 1.166368e+64\n [5,] 2.729505e+63 1.048705e+65 4.119785e+63 1.121032e+63\n [6,] 1.048705e+65 7.338892e+66 2.850065e+65 7.755291e+64\n",
        " [7,] 4.119785e+63 2.850065e+65 1.449453e+64 3.046627e+63\n [8,] 1.121032e+63 7.755291e+64 3.046627e+63 1.726483e+63\n [9,] 1.574114e+64 1.088971e+66 4.277969e+64 1.164075e+64\n[10,] 1.659563e+64 1.148085e+66 4.510193e+64 1.227265e+64\n[11,] 1.367199e+64 9.458278e+65 3.715636e+64 1.011059e+64\n[12,] 1.252232e+64 8.662931e+65 3.403189e+64 9.260394e+63\n[13,] 1.718669e+63 1.188974e+65 4.670827e+63 1.270975e+63\n              [,9]        [,10]        [,11]        [,12]\n [1,] 1.098326e+66 1.159055e+66 9.564775e+65 8.7",
        "50094e+65\n [2,] 4.416658e+65 4.660921e+65 3.846380e+65 3.518709e+65\n [3,] 4.283394e+65 4.520325e+65 3.730409e+65 3.412583e+65\n [4,] 1.637774e+65 1.726678e+65 1.422491e+65 1.302874e+65\n [5,] 1.574114e+64 1.659563e+64 1.367199e+64 1.252232e+64\n [6,] 1.088971e+66 1.148085e+66 9.458278e+65 8.662931e+65\n [7,] 4.277969e+64 4.510193e+64 3.715636e+64 3.403189e+64\n [8,] 1.164075e+64 1.227265e+64 1.011059e+64 9.260394e+63\n [9,] 1.760573e+65 1.723283e+65 1.419694e+65 1.300312e+65\n[10,] 1.723283e+65 1.949691e+65 1.4967",
        "65e+65 1.370900e+65\n[11,] 1.419694e+65 1.496765e+65 1.342541e+65 1.129394e+65\n[12,] 1.300312e+65 1.370900e+65 1.129394e+65 1.134670e+65\n[13,] 1.784659e+64 1.881536e+64 1.550066e+64 1.419722e+64\n             [,13]\n [1,] 1.198610e+65\n [2,] 4.819893e+64\n [3,] 4.674444e+64\n [4,] 1.788175e+64\n [5,] 1.718669e+63\n [6,] 1.188974e+65\n [7,] 4.670827e+63\n [8,] 1.270975e+63\n [9,] 1.784659e+64\n[10,] 1.881536e+64\n[11,] 1.550066e+64\n[12,] 1.419722e+64\n[13,] 3.324478e+63\n",
        "> ",
        "> ",
        "## optimization",
        "> ",
        "fit <- aft_nl(~s_ncon(st, m=c(4,2), k = 10, trans = trans_linear()), data = dat,",
        "+ ",
        "              censored = dat$c, trace = TRUE)",
        "[1] 6.261439e+44\n[1] 6.261439e+44\n[1] 6.261856e+44\n[1] 6.261605e+44\n[1] 6.2616e+44\n[1] 6.26152e+44\n[1] 6.26152e+44\n[1] 6.261519e+44\n[1] 6.261519e+44\n[1] 6.261518e+44\n[1] 6.261519e+44\n[1] 6.261515e+44\n[1] 6.261509e+44\n[1] 6.261494e+44\n[1] 6.261467e+44\n[1] 6.261856e+44\n[1] 6.261605e+44\n[1] 6.2616e+44\n[1] 6.26152e+44\n[1] 6.26152e+44\n[1] 6.261519e+44\n[1] 6.261519e+44\n[1] 6.261518e+44\n[1] 6.261519e+44\n[1] 6.261515e+44\n[1] 6.261509e+44\n[1] 6.261494e+44\n[1] 6.261467e+44\n[1] 6.261439e+44\n[1] 3.786926e+44\n[1] 2.2885",
        "74e+44\n[1] 1.381983e+44\n[1] 8.338618e+43\n[1] 5.027286e+43\n[1] 3.028413e+43\n[1] 1.822773e+43\n[1] 1.096175e+43\n[1] 6.586439e+42\n[1] 3.954018e+42\n[1] 2.371578e+42\n[1] 1.421152e+42\n[1] 8.508265e+41\n[1] 5.089e+41\n[1] 3.040942e+41\n[1] 1.815352e+41\n[1] 1.082639e+41\n[1] 6.450153e+40\n[1] 3.838947e+40\n[1] 2.282459e+40\n[1] 1.355611e+40\n[1] 8.042691e+39\n[1] 4.766439e+39\n[1] 2.821666e+39\n[1] 1.668508e+39\n[1] 9.854953e+38\n[1] 5.814018e+38\n[1] 3.425989e+38\n[1] 2.016394e+38\n[1] 1.185322e+38\n[1] 6.95923e+37\n[1] 4.080763e+37",
        "\n[1] 2.389839e+37\n[1] 1.397768e+37\n[1] 8.164541e+36\n[1] 4.762672e+36\n[1] 2.77449e+36\n[1] 1.614065e+36\n[1] 9.37681e+35\n[1] 5.439729e+35\n[1] 3.15122e+35\n[1] 1.822849e+35\n[1] 1.052894e+35\n[1] 6.072552e+34\n[1] 3.497053e+34\n[1] 2.010798e+34\n[1] 1.154413e+34\n[1] 6.617154e+33\n[1] 3.786951e+33\n[1] 2.163753e+33\n[1] 1.234286e+33\n[1] 7.029191e+32\n[1] 3.996382e+32\n[1] 2.268254e+32\n[1] 1.285198e+32\n[1] 7.26931e+31\n[1] 4.10442e+31\n[1] 2.313325e+31\n[1] 1.301483e+31\n[1] 7.308831e+30\n[1] 4.096906e+30\n[1] 2.292204e+30\n[1] 1.",
        "280061e+30\n[1] 7.13475e+29\n[1] 3.969067e+29\n[1] 2.20369e+29\n[1] 1.221113e+29\n[1] 6.752971e+28\n[1] 3.726996e+28\n[1] 2.052763e+28\n[1] 1.128302e+28\n[1] 6.188845e+27\n[1] 3.387527e+27\n[1] 1.850274e+27\n[1] 1.008464e+27\n[1] 5.484631e+26\n[1] 2.976381e+26\n[1] 1.611667e+26\n[1] 8.707619e+25\n[1] 4.694105e+25\n[1] 2.524803e+25\n[1] 1.354927e+25\n[1] 7.254549e+24\n[1] 3.875285e+24\n[1] 2.065327e+24\n[1] 1.098143e+24\n[1] 5.825161e+23\n[1] 3.084302e+23\n[1] 1.632028e+23\n[1] 8.630232e+22\n[1] 4.560831e+22\n[1] 2.408768e+22\n[1] 1.2713",
        "88e+22\n[1] 6.706515e+21\n[1] 3.535528e+21\n[1] 1.862747e+21\n[1] 9.80842e+20\n[1] 5.161714e+20\n[1] 2.714828e+20\n[1] 1.427081e+20\n[1] 7.497508e+19\n[1] 3.936879e+19\n[1] 2.066136e+19\n[1] 1.083783e+19\n[1] 5.682083e+18\n[1] 2.977558e+18\n[1] 1.559573e+18\n[1] 8.164885e+17\n[1] 4.272669e+17\n[1] 2.234907e+17\n[1] 1.168523e+17\n[1] 6.107151e+16\n[1] 3.190587e+16\n[1] 1.666248e+16\n[1] 8.698658e+15\n[1] 4.539572e+15\n[1] 2.368285e+15\n[1] 1.235138e+15\n[1] 6.439686e+14\n[1] 3.356503e+14\n[1] 1.748987e+14\n[1] 9.111024e+13\n[1] 4.744945e",
        "+13\n[1] 2.470475e+13\n[1] 1.285926e+13\n[1] 6.691727e+12\n[1] 3.481349e+12\n[1] 1.810692e+12\n[1] 941522214419\n[1] 489449840204\n[1] 254379090726\n[1] 132177152087\n[1] 68666053643\n[1] 35665727210\n[1] 18522540660\n[1] 9618635359\n[1] 4994820711\n[1] 2593933180\n[1] 1347347872\n[1] 700076508\n[1] 363944234\n[1] 189341798\n[1] 98606464\n[1] 51426303\n[1] NaN\n[1] 48164833\n[1] NaN\n[1] NaN\n[1] 47980463\n[1] NaN\n[1] NaN\n[1] 47802258\n[1] NaN\n[1] NaN\n[1] 47626612\n[1] NaN\n[1] NaN\n[1] 47452523\n[1] NaN\n[1] NaN\n[1] 47279585\n[1] NaN\n[1] N",
        "aN\n[1] 47107599\n[1] NaN\n[1] 45426465\n[1] 31710951\n[1] 22139888\n[1] 15460753\n[1] 10799813\n[1] 7547223\n[1] 5277316\n[1] 3693024\n[1] 2587060\n[1] 1814805\n[1] 1275377\n[1] 898407.3\n[1] 634814.9\n[1] 450367.1\n[1] 321185.9\n[1] 230614.7\n[1] 167032.2\n[1] 122328\n[1] 90840.18\n[1] 68614.46\n[1] 52887.48\n[1] 41726.95\n[1] 33780.56\n[1] 28100.93\n[1] 24023.53\n[1] 21081.54\n[1] 18946.37\n[1] 17386.22\n[1] 16237.21\n[1] 15383.16\n[1] 14741.57\n[1] 14253.78\n[1] 13877.96\n[1] 13584.23\n[1] 13351.14\n[1] 13163.25\n[1] 13009.44\n[1] 12240.19\n[1",
        "] 12228.9\n[1] 12220.94\n[1] 12215.29\n[1] 12213.18\n[1] 12212.24\n[1] 12211.73\n[1] 12211.41\n[1] 12211.2\n[1] 12211.03\n[1] 12210.85\n[1] 12210.67\n[1] 12210.49\n[1] 12210.31\n[1] 12209.09\n[1] 12208.06\n[1] 12207.19\n[1] 12206.44\n[1] 12205.78\n[1] 12205.19\n[1] 12204.67\n[1] 12204.2\n[1] 12203.77\n[1] 12203.38\n[1] 12203.02\n[1] 12202.7\n[1] 12202.39\n[1] 12202.1\n[1] 12201.82\n[1] 12201.56\n[1] 12201.31\n[1] 12201.06\n[1] 12200.83\n[1] 12200.61\n[1] 12200.4\n[1] 12200.2\n[1] 12200\n[1] 12199.81\n[1] 12199.61\n[1] 12199.42\n[1] 12199.22\n[1] ",
        "12199.02\n[1] 12198.83\n[1] 12198.63\n[1] 12198.43\n[1] 12198.24\n[1] 12198.04\n[1] 12197.84\n[1] 12197.64\n[1] 12197.44\n[1] 12197.24\n[1] 12197.04\n[1] 12196.84\n[1] 12196.64\n[1] 12196.44\n[1] 12196.24\n[1] 12196.04\n[1] 12195.84\n[1] 12195.63\n[1] 12195.43\n[1] 12195.23\n[1] 12195.03\n[1] 12194.82\n[1] 12194.62\n[1] 12194.41\n[1] 12194.21\n[1] 12194\n[1] 12193.8\n[1] 12193.59\n[1] 12193.38\n[1] 12193.18\n[1] 12192.97\n[1] 12192.76\n[1] 12192.55\n[1] 12192.34\n[1] 12192.14\n[1] 12191.93\n[1] 12191.72\n[1] 12191.5\n[1] 12191.29\n[1] 12191.08\n[",
        "1] 12190.87\n[1] 12190.66\n[1] 12190.45\n[1] 12190.23\n[1] 12190.02\n[1] 12189.8\n[1] 12189.59\n[1] 12189.37\n[1] 12189.16\n[1] 12188.94\n[1] 12188.73\n[1] 12188.51\n[1] 12188.29\n[1] 12188.07\n[1] 12187.86\n[1] 12187.64\n[1] 12187.42\n[1] 12187.2\n[1] 12186.98\n[1] 12186.76\n[1] 12186.53\n[1] 12186.31\n[1] 12186.09\n[1] 12185.87\n[1] 12185.64\n[1] 12185.42\n[1] 12185.19\n[1] 12184.97\n[1] 12184.74\n[1] 12184.52\n[1] 12184.29\n[1] 12184.06\n[1] 12183.83\n[1] 12183.6\n[1] 12183.37\n[1] 12183.14\n[1] 12182.91\n[1] 12182.68\n[1] 12182.45\n[1] 12182",
        ".22\n[1] 12181.99\n[1] 12181.75\n[1] 12181.52\n[1] 12181.28\n[1] 12181.05\n[1] 12180.81\n[1] 12180.58\n[1] 12180.34\n[1] 12180.1\n[1] 12179.86\n[1] 12179.62\n[1] 12179.38\n[1] 12179.14\n[1] 12178.9\n[1] 12178.66\n[1] 12178.42\n[1] 12178.17\n[1] 12177.93\n[1] 12177.68\n[1] 12177.44\n[1] 12177.19\n[1] 12176.95\n[1] 12176.7\n[1] 12176.45\n[1] 12176.2\n[1] 12175.95\n[1] 12175.7\n[1] 12175.45\n[1] 12175.2\n[1] 12174.94\n[1] 12174.69\n[1] 12174.44\n[1] 12174.18\n[1] 12173.92\n[1] 12173.67\n[1] 12173.41\n[1] 12173.15\n[1] 12172.89\n[1] 12172.63\n[1] 121",
        "72.37\n[1] 12172.11\n[1] 12171.84\n[1] 12171.58\n[1] 12171.32\n[1] 12171.05\n[1] 12170.78\n[1] 12170.52\n[1] 12170.25\n[1] 12169.98\n[1] 12169.71\n[1] 12169.44\n[1] 12169.17\n[1] 12168.89\n[1] 12168.62\n[1] 12168.35\n[1] 12168.07\n[1] 12167.79\n[1] 12167.52\n[1] 12167.24\n[1] 12166.96\n[1] 12166.68\n[1] 12166.39\n[1] 12166.11\n[1] 12165.83\n[1] 12165.54\n[1] 12165.26\n[1] 12164.97\n[1] 12164.68\n[1] 12164.39\n[1] 12164.1\n[1] 12163.81\n[1] 12163.52\n[1] 12163.22\n[1] 12162.93\n[1] 12162.63\n[1] 12162.33\n[1] 12162.03\n[1] 12161.73\n[1] 12161.43\n",
        "[1] 12161.13\n[1] 12160.82\n[1] 12160.52\n[1] 12160.21\n[1] 12159.91\n[1] 12159.6\n[1] 12159.29\n[1] 12158.97\n[1] 12158.66\n[1] 12158.35\n[1] 12158.03\n[1] 12157.71\n[1] 12157.39\n[1] 12157.07\n[1] 12156.75\n[1] 12156.43\n[1] 12156.11\n[1] 12155.78\n[1] 12155.45\n[1] 12155.12\n[1] 12154.79\n[1] 12154.46\n[1] 12154.13\n[1] 12153.79\n[1] 12153.45\n[1] 12153.11\n[1] 12152.77\n[1] 12152.43\n[1] 12152.09\n[1] 12151.74\n[1] 12151.39\n[1] 12151.04\n[1] 12150.69\n[1] 12150.34\n[1] 12149.99\n[1] 12149.63\n[1] 12149.27\n[1] 12148.91\n[1] 12148.55\n[1] 12",
        "148.18\n[1] 12147.82\n[1] 12147.45\n[1] 12147.08\n[1] 12146.71\n[1] 12146.33\n[1] 12145.96\n[1] 12145.58\n[1] 12145.2\n[1] 12144.81\n[1] 12144.43\n[1] 12144.04\n[1] 12143.65\n[1] 12143.26\n[1] 12142.86\n[1] 12142.47\n[1] 12142.07\n[1] 12141.67\n[1] 12141.26\n[1] 12140.85\n[1] 12140.45\n[1] 12140.03\n[1] 12139.62\n[1] 12139.2\n[1] 12138.78\n[1] 12138.36\n[1] 12137.93\n[1] 12137.5\n[1] 12137.07\n[1] 12136.64\n[1] 12136.2\n[1] 12135.76\n[1] 12135.32\n[1] 12134.87\n[1] 12134.42\n[1] 12133.97\n[1] 12133.51\n[1] 12133.05\n[1] 12132.59\n[1] 12132.12\n[1",
        "] 12131.65\n[1] 12131.18\n[1] 12130.7\n[1] 12130.22\n[1] 12129.74\n[1] 12129.25\n[1] 12128.76\n[1] 12128.26\n[1] 12127.76\n[1] 12127.26\n[1] 12126.75\n[1] 12126.24\n[1] 12125.72\n[1] 12125.2\n[1] 12124.67\n[1] 12124.14\n[1] 12123.61\n[1] 12123.07\n[1] 12122.53\n[1] 12121.98\n[1] 12121.42\n[1] 12120.86\n[1] 12120.3\n[1] 12119.73\n[1] 12119.16\n[1] 12118.58\n[1] 12117.99\n[1] 12117.4\n[1] 12116.8\n[1] 12116.2\n[1] 12115.59\n[1] 12114.97\n[1] 12114.35\n[1] 12113.72\n[1] 12113.09\n[1] 12112.45\n[1] 12111.8\n[1] 12111.14\n[1] 12110.48\n[1] 12109.81\n[",
        "1] 12109.13\n[1] 12108.45\n[1] 12107.75\n[1] 12107.05\n[1] 12106.34\n[1] 12105.63\n[1] 12104.9\n[1] 12104.16\n[1] 12103.42\n[1] 12102.66\n[1] 12101.9\n[1] 12101.12\n[1] 12100.34\n[1] 12099.55\n[1] 12098.74\n[1] 12097.92\n[1] 12097.1\n[1] 12096.26\n[1] 12095.41\n[1] 12094.54\n[1] 12093.67\n[1] 12092.78\n[1] 12091.87\n[1] 12090.96\n[1] 12090.02\n[1] 12089.08\n[1] 12088.12\n[1] 12087.14\n[1] 12086.15\n[1] 12085.14\n[1] 12084.11\n[1] 12083.06\n[1] 12082\n[1] 12080.91\n[1] 12079.81\n[1] 12078.68\n[1] 12077.53\n[1] 12076.36\n[1] 12075.17\n[1] 12073.95",
        "\n[1] 12072.71\n[1] 12071.44\n[1] 12070.14\n[1] 12068.82\n[1] 12067.46\n[1] 12066.08\n[1] 12064.65\n[1] 12063.2\n[1] 12061.71\n[1] 12060.18\n[1] 12058.61\n[1] 12057\n[1] 12055.34\n[1] 12053.64\n[1] 12051.89\n[1] 12050.08\n[1] 12048.22\n[1] 12046.31\n[1] 12044.33\n[1] 12042.28\n[1] 12040.16\n[1] 12037.96\n[1] 12035.69\n[1] 12033.32\n[1] 12030.86\n[1] 12028.3\n[1] 12025.63\n[1] 12022.85\n[1] 12019.94\n[1] 12016.89\n[1] 12013.71\n[1] 12010.36\n[1] 12006.84\n[1] 12003.12\n[1] 11999.2\n[1] 11995.04\n[1] 11990.62\n[1] 11985.91\n[1] 11980.87\n[1] 11975.",
        "46\n[1] 11969.63\n[1] 11963.32\n[1] 11956.44\n[1] 11948.92\n[1] 11940.63\n[1] 11931.45\n[1] 11921.18\n[1] 11909.62\n[1] 11896.46\n[1] 11881.33\n[1] 11863.72\n[1] 11842.95\n[1] 11818.06\n[1] 11787.74\n[1] 11750.11\n[1] 11702.42\n[1] 11640.66\n[1] 11558.83\n[1] 11448.03\n[1] 11295.24\n[1] 11082.46\n[1] 10787.48\n[1] 10389.02\n[1] 9876.97\n[1] 9263.38\n[1] 8584.621\n[1] 7891.91\n[1] 7236.325\n[1] 6656.053\n[1] 6169.799\n[1] 5777.193\n[1] 5465.287\n[1] NaN\n[1] NaN\n[1] 5137.586\n[1] 4840.431\n[1] NaN\n[1] NaN\n[1] 4620.338\n[1] 4367.224\n[1] NaN\n[1] ",
        "NaN\n[1] 4220.691\n[1] 4011.092\n[1] NaN\n[1] NaN\n[1] 3879.279\n[1] NaN\n[1] NaN\n[1] 3773.554\n[1] 3547.712\n[1] NaN\n[1] NaN\n[1] 3509.728\n[1] NaN\n[1] NaN\n[1] 3482.442\n[1] NaN\n[1] NaN\n[1] 3462.087\n[1] NaN\n[1] NaN\n[1] 3446.525\n[1] NaN\n[1] NaN\n[1] 3434.291\n[1] NaN\n[1] NaN\n[1] 3424.343\n[1] NaN\n[1] NaN\n[1] 3415.955\n[1] NaN\n[1] NaN\n[1] 3408.64\n[1] NaN\n[1] NaN\n[1] 3402.075\n[1] NaN\n[1] NaN\n[1] 3396.051\n[1] NaN\n[1] 3345.157\n[1] NaN\n[1] 3327.864\n[1] 3327.597\n[1] 3183.626\n[1] NaN\n[1] 3172.45\n[1] NaN\n[1] 3162.85\n[1] NaN\n[1] 31",
        "54.465\n[1] 3106.491\n[1] 3140.545\n[1] 3098.259\n[1] 3088.452\n[1] NaN\n[1] 3076.3\n[1] NaN\n[1] 3054.18\n[1] NaN\n[1] NaN\n[1] 3051.934\n[1] NaN\n[1] 3037.952\n[1] 3037.624\n[1] 3037.348\n[1] 3037.12\n[1] 3032.876\n[1] 1.392433e+32\n[1] 3062.046\n[1] 3028.288\n[1] 3134.914\n[1] 3016.716\n[1] 3000.135\n[1] NaN\n[1] 2998.204\n[1] NaN\n[1] 2996.849\n[1] 2993.494\n[1] 2992.15\n[1] 2991.485\n[1] 2991.062\n[1] 2988.411\n[1] 3006.377\n[1] 2986.904\n[1] 2986.018\n[1] 2985.916\n[1] 2985.916\n[1] 2985.916\n",
        "Ci sono 50 o più avvertimenti (utilizza warnings() per visualizzare i primi 50)\n",
        "> ",
        "n <- 1000",
        "> ",
        "p <- 2",
        "> ",
        "X <- matrix(runif(n*p), ncol = p)",
        "> ",
        "params <- rnorm(p)",
        "> ",
        "theta <- c(lambda1 = 0.1, gamma1 = 3, lambda2=0.1, gamma2=1.6, p=0.8)",
        "> ",
        "S0 <- function(t, p, lambda1 = 0.1, gamma1 = 3, lambda2=0.1, gamma2=1.6){",
        "+ ",
        "  p*exp(-lambda1*t^gamma1) + (1-p)*exp(-lambda2 * t^gamma2)",
        "+ ",
        "}",
        "> ",
        "wrap_rweibull <- function(n, lambda, gamma){",
        "+ ",
        "  # generate from a weibull using the parametrization in the draft",
        "+ ",
        "  sc <- lambda^(-1/gamma); sh <- gamma",
        "+ ",
        "  rweibull(n, scale = sc, shape = sh)",
        "+ ",
        "}",
        "> ",
        "pp <- rbinom(n, size = 1, prob = theta[\"p\"])",
        "> ",
        "> ",
        "rw1 <- apply(X, 1,",
        "+ ",
        "             FUN = function(xx) wrap_rweibull(1, theta[\"lambda1\"]*exp(- xx%*%params * theta[\"gamma1\"]),",
        "+ ",
        "                                              theta[\"gamma1\"]))",
        "> ",
        "rw2 <- apply(X, 1,",
        "+ ",
        "             FUN = function(xx) wrap_rweibull(1, theta[\"lambda2\"]*exp(- xx%*%params * theta[\"gamma2\"]),",
        "+ ",
        "                                              theta[\"gamma2\"]))",
        "> ",
        "times <- rw1*pp + (1-pp)*rw2",
        "> ",
        "par(mfrow = c(1,2))",
        "> ",
        "hist(times, breaks = 50)",
        "> ",
        "> ",
        "dat <- data.frame(times = times)",
        "> ",
        "dat$st <- cbind(log(times), X)",
        "> ",
        "> ",
        "# add censoring ####",
        "> ",
        "C <- quantile(times, 0.9)",
        "> ",
        "dat$c <- as.numeric(dat$times<C)",
        "> ",
        "dat$st[dat$c==0,1] <- log(C)",
        "> ",
        "dat$times[dat$c==0] <- C",
        "> ",
        "hist(dat$times, breaks = 50)",
        "> ",
        "> ",
        "## generate basis ####",
        "> ",
        "library(devtools)",
        "> ",
        "load_all()",
        "\u001B[38;5;232m\u001B[36mℹ\u001B[38;5;232m Loading \u001B[34maftNested\u001B[38;5;232m\u001B[39m\n",
        "> ",
        "sm_misi <- aftNested::smooth.construct.misi.smooth.spec(object = s_ncon(st, m=c(4,2), k = 10,",
        "+ ",
        "                                                         trans = trans_linear()),",
        "+ ",
        "                                        data = dat, knots = list())",
        "> ",
        "> ",
        "beta <- rnorm(ncol(sm_misi$X)-length(sm_misi$xt$si$alpha))",
        "> ",
        "betat <- c(beta[1], exp(beta[-1]))",
        "> ",
        "> ",
        "z <- dat[[sm_misi$term]] %*% sm_misi$xt$si$alpha",
        "> ",
        "X <- sm_misi$xt$basis$evalX(z, deriv = 1)",
        "> ",
        "ss <- X$X0%*%betat",
        "> ",
        "ss1 <- X$X1%*% betat",
        "> ",
        "plot(ss~z)",
        "> ",
        "plot(ss1~z);abline(h=0, col=\"grey\")",
        "> ",
        "> ",
        "xx <- seq(-10,10, length.out = 1000)",
        "> ",
        "matplot(sm_misi$xt$basis$evalX(xx, deriv = 1)$X0, x = xx, type = 'l')",
        "> ",
        "> ",
        "# define the smooth function",
        "> ",
        "alph <- sm_misi$xt$si$alpha",
        "> ",
        "bet <- rnorm(ncol(sm_misi$X)-(p+1))",
        "> ",
        "> ",
        "f1 <- eff_misi(dat$st, basis = sm_misi$xt$basis)",
        "> ",
        "f1 <- f1$eval(c(alph, bet), deriv = 2)",
        "> ",
        "> ",
        "## define likelihood",
        "> ",
        "llk <- llk_afc(f1, sm = sm_misi, delta = dat$c, lambda = 1, vpen = 1e4)",
        "> ",
        "llk(c(alph, bet))",
        "[1] 3.696713e+44\nattr(,\"gradient\")\n              [,1]\n [1,] 1.204021e+46\n [2,] 1.163688e+46\n [3,] 1.161223e+46\n [4,] 4.575717e+45\n [5,] 4.364787e+45\n [6,] 6.300698e+45\n [7,] 5.173458e+45\n [8,] 2.888527e+45\n [9,] 4.682137e+45\n[10,] 5.882712e+45\n[11,] 7.331384e+45\n[12,] 1.049567e+45\n[13,] 1.525811e+45\nattr(,\"hessian\")\n              [,1]         [,2]         [,3]         [,4]\n [1,] 3.925704e+47 3.794198e+47 3.786164e+47 1.505993e+47\n [2,] 3.794198e+47 3.667105e+47 3.659335e+47 1.455546e+47\n [3,] 3.786164e+47 3",
        ".659335e+47 3.651625e+47 1.452470e+47\n [4,] 1.505993e+47 1.455546e+47 1.452470e+47 5.663757e+46\n [5,] 1.436501e+47 1.388381e+47 1.385448e+47 5.402671e+46\n [6,] 2.073361e+47 2.003908e+47 1.999674e+47 7.798914e+46\n [7,] 1.702114e+47 1.645097e+47 1.641621e+47 6.403632e+46\n [8,] 9.502004e+46 9.183710e+46 9.164304e+46 3.575377e+46\n [9,] 1.539660e+47 1.488085e+47 1.484941e+47 5.795481e+46\n[10,] 1.936662e+47 1.871789e+47 1.867834e+47 7.281538e+46\n[11,] 2.408979e+47 2.328283e+47 2.323362e+47 9.074677e+46\n[12,] 3.44",
        "5074e+46 3.329671e+46 3.322631e+46 1.299138e+46\n[13,] 4.999191e+46 4.831728e+46 4.821508e+46 1.888623e+46\n              [,5]         [,6]         [,7]         [,8]\n [1,] 1.436501e+47 2.073361e+47 1.702114e+47 9.502004e+46\n [2,] 1.388381e+47 2.003908e+47 1.645097e+47 9.183710e+46\n [3,] 1.385448e+47 1.999674e+47 1.641621e+47 9.164304e+46\n [4,] 5.402671e+46 7.798914e+46 6.403632e+46 3.575377e+46\n [5,] 5.590099e+46 7.439402e+46 6.108439e+46 3.410560e+46\n [6,] 7.439402e+46 1.136907e+47 8.817712e+46 4.923244e+46\n",
        " [7,] 6.108439e+46 8.817712e+46 7.757505e+46 4.042440e+46\n [8,] 3.410560e+46 4.923244e+46 4.042440e+46 2.545891e+46\n [9,] 5.528322e+46 7.980296e+46 6.552563e+46 3.658530e+46\n[10,] 6.945876e+46 1.002658e+47 8.232749e+46 4.596638e+46\n[11,] 8.656355e+46 1.249570e+47 1.026013e+47 5.728598e+46\n[12,] 1.239251e+46 1.788895e+46 1.468848e+46 8.201106e+45\n[13,] 1.801562e+46 2.600608e+46 2.135340e+46 1.192237e+46\n              [,9]        [,10]        [,11]        [,12]\n [1,] 1.539660e+47 1.936662e+47 2.408979e+47 3.4",
        "45074e+46\n [2,] 1.488085e+47 1.871789e+47 2.328283e+47 3.329671e+46\n [3,] 1.484941e+47 1.867834e+47 2.323362e+47 3.322631e+46\n [4,] 5.795481e+46 7.281538e+46 9.074677e+46 1.299138e+46\n [5,] 5.528322e+46 6.945876e+46 8.656355e+46 1.239251e+46\n [6,] 7.980296e+46 1.002658e+47 1.249570e+47 1.788895e+46\n [7,] 6.552563e+46 8.232749e+46 1.026013e+47 1.468848e+46\n [8,] 3.658530e+46 4.596638e+46 5.728598e+46 8.201106e+45\n [9,] 6.398482e+46 7.450887e+46 9.285730e+46 1.329352e+46\n[10,] 7.450887e+46 9.949689e+46 1.1666",
        "74e+47 1.670220e+46\n[11,] 9.285730e+46 1.166674e+47 1.527292e+47 2.081526e+46\n[12,] 1.329352e+46 1.670220e+46 2.081526e+46 4.029497e+45\n[13,] 1.932548e+46 2.428085e+46 3.026022e+46 4.332077e+45\n             [,13]\n [1,] 4.999191e+46\n [2,] 4.831728e+46\n [3,] 4.821508e+46\n [4,] 1.888623e+46\n [5,] 1.801562e+46\n [6,] 2.600608e+46\n [7,] 2.135340e+46\n [8,] 1.192237e+46\n [9,] 1.932548e+46\n[10,] 2.428085e+46\n[11,] 3.026022e+46\n[12,] 4.332077e+45\n[13,] 7.823576e+45\n",
        "> ",
        "> ",
        "## optimization",
        "> ",
        "fit <- aft_nl(~s_ncon(st, m=c(4,2), k = 10, trans = trans_linear()), data = dat,",
        "+ ",
        "              censored = dat$c, trace = TRUE)",
        "[1] 2.096467e+45\n[1] 2.096467e+45\n[1] 2.096587e+45\n[1] 2.096583e+45\n[1] 2.096583e+45\n[1] 2.096493e+45\n[1] 2.096493e+45\n[1] 2.096493e+45\n[1] 2.096493e+45\n[1] 2.096493e+45\n[1] 2.096494e+45\n[1] 2.096493e+45\n[1] 2.096494e+45\n[1] 2.09649e+45\n[1] 2.096478e+45\n[1] 2.096587e+45\n[1] 2.096583e+45\n[1] 2.096583e+45\n[1] 2.096493e+45\n[1] 2.096493e+45\n[1] 2.096493e+45\n[1] 2.096493e+45\n[1] 2.096493e+45\n[1] 2.096494e+45\n[1] 2.096493e+45\n[1] 2.096494e+45\n[1] 2.09649e+45\n[1] 2.096478e+45\n[1] 2.096467e+45\n[1] 1.30002e+45\n[1] 8",
        ".060865e+44\n[1] 4.997845e+44\n[1] 3.09851e+44\n[1] 1.920842e+44\n[1] 1.19069e+44\n[1] 7.380296e+43\n[1] 4.574212e+43\n[1] 2.834823e+43\n[1] 1.75672e+43\n[1] 1.088543e+43\n[1] 6.744584e+42\n[1] 4.178597e+42\n[1] 2.58864e+42\n[1] 1.603534e+42\n[1] 9.932302e+41\n[1] 6.151579e+41\n[1] 3.809677e+41\n[1] 2.359143e+41\n[1] 1.460779e+41\n[1] 9.044391e+40\n[1] 5.599356e+40\n[1] 3.466257e+40\n[1] 2.145593e+40\n[1] 1.327998e+40\n[1] 8.218855e+39\n[1] 5.086144e+39\n[1] 3.147238e+39\n[1] 1.947305e+39\n[1] 1.204763e+39\n[1] 7.453029e+38\n[1] 4.61028",
        "2e+38\n[1] 2.851581e+38\n[1] 1.76363e+38\n[1] 1.090668e+38\n[1] 6.744376e+37\n[1] 4.170179e+37\n[1] 2.578289e+37\n[1] 1.593943e+37\n[1] 9.853217e+36\n[1] 6.09043e+36\n[1] 3.764286e+36\n[1] 2.326388e+36\n[1] 1.43763e+36\n[1] 8.883366e+35\n[1] 5.488755e+35\n[1] 3.391066e+35\n[1] 2.09491e+35\n[1] 1.29408e+35\n[1] 7.993269e+34\n[1] 4.936912e+34\n[1] 3.04898e+34\n[1] 1.882878e+34\n[1] 1.162677e+34\n[1] 7.179028e+33\n[1] 4.432434e+33\n[1] 2.736463e+33\n[1] 1.689305e+33\n[1] 1.042794e+33\n[1] 6.436673e+32\n[1] 3.972806e+32\n[1] 2.451924e+32\n[1",
        "] 1.513181e+32\n[1] 9.337918e+31\n[1] 5.762153e+31\n[1] 3.555461e+31\n[1] 2.193736e+31\n[1] 1.353476e+31\n[1] 8.350167e+30\n[1] 5.151328e+30\n[1] 3.177776e+30\n[1] 1.960235e+30\n[1] 1.209135e+30\n[1] 7.458018e+29\n[1] 4.599972e+29\n[1] 2.837074e+29\n[1] 1.749728e+29\n[1] 1.079085e+29\n[1] 6.654672e+28\n[1] 4.10378e+28\n[1] 2.53063e+28\n[1] 1.56049e+28\n[1] 9.622355e+27\n[1] 5.933223e+27\n[1] 3.658383e+27\n[1] 2.255678e+27\n[1] 1.39077e+27\n[1] 8.574788e+26\n[1] 5.286666e+26\n[1] 3.259349e+26\n[1] 2.009418e+26\n[1] 1.238796e+26\n[1] 7.63",
        "6943e+25\n[1] 4.707917e+25\n[1] 2.902199e+25\n[1] 1.789015e+25\n[1] 1.102779e+25\n[1] 6.797508e+24\n[1] 4.189834e+24\n[1] 2.58243e+24\n[1] 1.591636e+24\n[1] 9.809367e+23\n[1] 6.045311e+23\n[1] 3.725418e+23\n[1] 2.295664e+23\n[1] 1.414545e+23\n[1] 8.715607e+22\n[1] 5.369687e+22\n[1] 3.308021e+22\n[1] 2.037758e+22\n[1] 1.25516e+22\n[1] 7.730454e+21\n[1] 4.760655e+21\n[1] 2.931439e+21\n[1] 1.804861e+21\n[1] 1.111096e+21\n[1] 6.839117e+20\n[1] 4.209059e+20\n[1] 2.590013e+20\n[1] 1.593478e+20\n[1] 9.801951e+19\n[1] 6.028316e+19\n[1] 3.706732",
        "e+19\n[1] 2.278728e+19\n[1] 1.400535e+19\n[1] 8.605773e+18\n[1] 5.286567e+18\n[1] 3.246678e+18\n[1] 1.993332e+18\n[1] 1.223456e+18\n[1] 7.50686e+17\n[1] 4.6045e+17\n[1] 2.823277e+17\n[1] 1.73047e+17\n[1] 1.060246e+17\n[1] 6.493427e+16\n[1] 3.975193e+16\n[1] 2.432495e+16\n[1] 1.48781e+16\n[1] 9.09573e+15\n[1] 5.557948e+15\n[1] 3.394463e+15\n[1] 2.072049e+15\n[1] 1.264138e+15\n[1] 7.708111e+14\n[1] 4.697358e+14\n[1] 2.860919e+14\n[1] 1.741395e+14\n[1] 1.059311e+14\n[1] 6.439879e+13\n[1] 3.912505e+13\n[1] 2.375471e+13\n[1] 1.441308e+13\n[1]",
        " 8.739207e+12\n[1] 5.295301e+12\n[1] 3.206335e+12\n[1] 1.940096e+12\n[1] 1.173089e+12\n[1] 708809589119\n[1] 427974298382\n[1] 258222789402\n[1] 155689930070\n[1] 93803060375\n[1] 56476376227\n[1] 33979294264\n[1] 20429881760\n[1] 12275233649\n[1] 7370842733\n[1] 4423256377\n[1] 2652909567\n[1] 1590304385\n[1] 952890071\n[1] 570746759\n[1] 341761260\n[1] 204611545\n[1] 122496787\n[1] 73346240\n[1] 43931397\n[1] 26328008\n[1] 15791661\n[1] 9483040\n[1] 5703560\n[1] 3437335\n[1] 2076877\n[1] 1259240\n[1] 767073.4\n[1] 470005\n[1] 290130.3\n[1]",
        " 180841.4\n[1] 114209.8\n[1] 73474.28\n[1] 48524.42\n[1] 33255.84\n[1] 23965.21\n[1] 18389.4\n[1] 15126.56\n[1] 13281.45\n[1] 12249.14\n[1] 11614.25\n[1] 11124.85\n[1] 10637.26\n[1] 10067.55\n[1] 9396.697\n[1] 8646.728\n[1] 7827.378\n[1] 6939.07\n[1] 5988.563\n[1] 4989.273\n[1] 3931.049\n[1] 3148.22\n[1] NaN\n[1] 2820.084\n[1] NaN\n[1] 2571.73\n[1] NaN\n[1] 2385.138\n[1] NaN\n[1] 2246.534\n[1] NaN\n[1] 2143.972\n[1] 1998.26\n[1] 1798.294\n[1] 2041.556\n[1] 1766.255\n[1] 1722.328\n[1] 1708.205\n[1] 1703.191\n[1] 1701.117\n[1] 1700.231\n[1] 1699.876",
        "\n[1] 1699.74\n[1] 1699.689\n[1] 1699.671\n[1] 1699.664\n[1] 1699.661\n[1] 1699.66\n[1] 1699.66\n[1] 1699.66\n",
        "Ci sono stati 15 avvertimenti (utilizza warnings() per visualizzarli)\n",
        "> ",
        "fit$iterations",
        "[1] 232\n",
        "> ",
        "fit$coef",
        " [1]   1.5601758  -1.2263610  -1.0088734  -1.7925289  -0.5195221\n [6]  -0.8186945  -0.9179393  -0.9909396  -0.4611403  -0.8847887\n[11]  -1.8037160  -2.4958724 -14.1719361\n",
        "> ",
        "alph <- fit$estimate[1:3]",
        "> ",
        "alph/alph[1]",
        "numeric(0)\n",
        "> ",
        "alph <- fit$coefficients[1:3]",
        "> ",
        "alph/alph[1]",
        "[1]  1.0000000 -0.7860403 -0.6466408\n",
        "> ",
        "f1 <- f1$eval(fit$estimate, deriv = 2)",
        "Errore in exp(beta[-1]) : \n  argomento non-numerico per una funzione matematica\n",
        "> ",
        "f1 <- f1$eval(fit$coefficients, deriv = 2)",
        "> ",
        " log.htx(f1, deriv=0)$h",
        "   [1] -3.1127652708 -0.9762826040 -0.5126140192  0.3482657773\n   [5] -0.6652117256 -3.4538116056 -0.2088757608 -0.6806192436\n   [9] -0.8868684307 -0.8554641492  1.1256411104 -0.6135590976\n  [13] -0.8645614397 -0.4277063122 -0.1383344252 -0.3742142054\n  [17] -1.3285522170  0.9760295924 -0.7974054136 -0.6013924647\n  [21] -0.8140924021 -0.2056929291 -0.2843498165 -0.4912307886\n  [25]  0.7050051269 -1.2899487421 -0.3640276034 -0.9746758305\n  [29] -0.4853661020  1.7920805106  0.6847195665  2.0495606620\n  [33] -",
        "1.0527549198 -0.8364382833 -1.0898025126 -0.3185350900\n  [37]  1.1550612786 -0.6832723322 -0.5566494680 -0.2501824408\n  [41] -1.1606579583 -0.9728234873 -0.7037493022  0.0949886354\n  [45] -0.7904790503 -0.5769015510  0.4958652079 -0.9940935871\n  [49] -1.3131990537 -0.6008475529 -0.9067374415 -0.9768351742\n  [53] -0.2370589465 -0.8296374136  0.2768708061  0.0792715009\n  [57] -0.3160135108 -0.2451332798  0.6562583572 -3.0497763206\n  [61]  0.3555453942 -0.0098331661 -0.6938016096 -0.8070893762\n  [65] -0.671057",
        "8524 -0.2787166463 -0.0061611626  1.1467396298\n  [69] -0.7602319780 -0.2099873850  0.2755911172  0.6000041955\n  [73] -1.4620712848  0.4445202595 -0.7438413848 -0.4914518618\n  [77] -0.6580618750  1.8248340472 -0.8616214901 -0.6107226603\n  [81] -1.1427920811 -0.6285099357  0.2398091794  0.0026756058\n  [85] -0.9308371759 -0.6944977321 -1.5322920164 -0.2391504419\n  [89]  0.2231195712 -0.5551219025 -0.6024156563 -1.6216637152\n  [93] -0.7912190434  1.5852824971 -0.8021529555 -0.7408775776\n  [97]  1.3598183886 -0.",
        "9524511457  0.9678060913  0.9869976156\n [101] -0.7887134711 -0.6482911674 -0.2345848764 -0.6166696915\n [105]  1.6162106685 -0.4698051369 -0.6476038155  1.8314045357\n [109]  0.0105150910 -0.8176275835 -0.6690521601 -1.9947300893\n [113] -0.5290174960 -1.2481774641  1.3369674046 -0.4895591110\n [117]  0.2911530630 -0.6209751039  0.2029469669 -0.1740183963\n [121] -0.9069210382  0.3676468215 -0.4578090134 -0.4986493062\n [125] -0.2488646236  0.7321552384  0.2700484069  0.2669549032\n [129] -0.8546208742  1.77417333",
        "89 -0.8180826344 -0.4433231581\n [133] -0.2756870923 -0.4219286402 -1.0326419754 -0.7313859697\n [137] -0.2323211953 -0.2120616463 -1.0824944688 -0.2322690663\n [141]  0.5085071914 -0.6759153529 -0.4962473303 -0.5985808903\n [145]  0.9513344364  0.2402145043 -0.8065917620  0.6690772202\n [149]  1.7775976449 -0.7936616744  0.3532991924 -0.6707652851\n [153]  1.4671969406  1.2124036455 -0.3254980655  1.5881566261\n [157]  0.8611103076  1.2908580249 -0.1702747172  0.3346452051\n [161] -1.6075668163 -0.7472645469 -0.18",
        "56047565 -1.0321776433\n [165]  0.6640727947 -0.6540853082 -0.6754916908 -0.4545996798\n [169] -0.6186388563 -0.9118484413 -0.4801095535 -0.5115727960\n [173] -0.7463327831  0.8977759035 -0.7817749417 -2.2458492751\n [177]  0.6432817770  0.6929492232  0.5860645158  0.1232256812\n [181] -0.7446673040 -0.8699372147 -0.5990733387  1.4115830094\n [185] -0.1913094763 -0.6319281209  0.2199805658 -0.7720325665\n [189] -0.1031503233 -3.3408799213 -1.1837890304 -3.6138295825\n [193] -1.6235956146 -0.5824293833 -0.4582003012",
        " -2.7298834773\n [197] -0.5099856279 -0.0499853435 -0.2315357953  0.1929073657\n [201] -1.3523595642 -0.8600380315 -0.9535459974  0.2945347554\n [205] -0.6982020345 -0.9762881380  0.7851044317  0.2729633430\n [209] -0.8573540781 -2.4921336561  0.1993710565  1.6595989057\n [213] -1.0386982223 -0.4098499158 -0.9510693900 -0.5898466343\n [217] -0.8997216150  1.9996902494 -0.1161589901 -0.5971782485\n [221] -0.9407396531  0.5316642540 -0.5346402524  0.4796997186\n [225] -0.8622698389 -0.3223301202 -1.7099309137  1.2787",
        "697006\n [229] -0.7526712664 -1.2003948051 -0.7096196520 -0.7939098780\n [233] -0.9878160883 -0.4706432229 -1.7645164937 -1.4628742948\n [237]  1.3993410912 -0.3910144694 -0.9840779630 -0.5187784858\n [241] -0.7734743955 -0.5379340985 -0.4534840524 -0.6389460113\n [245]  0.2373753042 -0.1964980325 -0.6198066062 -0.7872858245\n [249] -0.2849231206 -0.7046094456 -0.8278366032  1.7279590568\n [253] -0.1356521468  1.8109211942 -0.4835238654 -0.7366360052\n [257] -1.0439328853 -0.2612627898  0.8433733501  0.7223719130\n ",
        "[261]  0.2854051739  0.7520800657  0.4838733443 -0.0654167327\n [265]  1.1598294088 -0.8811077818 -0.6493802170 -0.0050170687\n [269] -0.6937905271 -1.2000696345 -0.6729762862 -0.8893000161\n [273] -1.6931988257  0.9778555205 -0.5557673081 -0.4880452724\n [277] -0.1958010525 -0.2298778433 -0.4710355249 -0.3542679214\n [281]  0.5601327154 -0.6213208845 -0.8665867626 -1.1883965052\n [285] -0.8342693450 -0.7250741163  0.6159439692 -0.4152733942\n [289] -0.6271837925 -0.4649965908 -0.7605923673  1.8432224766\n [293] -0",
        ".7379412161 -0.3872656492  1.4129935288 -1.2615764801\n [297] -0.7593975297 -0.5429772302 -0.8520957904 -0.6600658215\n [301]  0.6221676662  1.3608305490  0.9523156079 -0.7922006939\n [305] -0.5397962788 -0.2941646149 -1.3932718022 -1.0153029800\n [309]  0.8680480138 -0.8303010537 -0.9839925876 -0.7709951679\n [313]  0.4116578504 -0.2846551270 -1.0005173412 -0.9523633652\n [317]  1.3070163230 -0.9094567366  1.4596887165 -0.8483897875\n [321] -0.6669124046 -0.7739162600  0.1125647109 -0.5899098461\n [325] -0.3744756",
        "632  0.0105409048 -0.7299395436 -0.9595433867\n [329] -1.0778970234  1.1270059742 -0.9572430408 -0.8111378157\n [333]  0.6169977507  2.0621078210 -0.6597053085 -0.7327319940\n [337]  1.5392336690 -0.2540775942 -0.1773275809  0.5540208842\n [341]  0.2917333336 -0.6320537964 -1.2530408542  1.2638738313\n [345] -0.7533084898  0.0380884387 -0.6924858123 -0.6993375203\n [349] -0.6493219619 -0.6440404287 -0.0943566927 -1.9443135256\n [353] -0.5597770285  0.4414406686 -0.5600058507 -0.5138358297\n [357] -0.5622718980 -0.1",
        "697973316 -0.5782914672 -0.9884179617\n [361] -0.4167048221 -0.9162390026 -0.7343189594 -0.8981600122\n [365] -2.2482350160 -0.7210106317 -0.8034892949 -1.9341625249\n [369] -0.2164657442 -0.1559421074 -0.2253050989  0.6332942881\n [373]  0.5387130201  1.1572051432 -1.5973978837  1.3931698731\n [377]  0.6596822762 -1.0203575614 -0.1954411262 -1.2932389717\n [381] -0.5091982384 -0.0226458800 -0.2407225847 -0.7942138384\n [385] -0.6729548320 -0.3568847001 -0.7681342435  1.5391076795\n [389] -0.4532018517  0.900997067",
        "9  0.8650608287  0.6988286616\n [393] -0.5675298491 -1.1807179488  1.8296038544 -0.8111241300\n [397] -0.7778260521 -0.8373077479 -1.2154983634  0.3856211209\n [401] -0.8074875904 -1.0828570454 -1.8151770128 -0.6540658089\n [405] -0.3657720034 -0.3125558283  0.2901266124 -0.6472750395\n [409] -0.3686749407  1.3823092999 -0.5860630426 -0.7254543452\n [413]  0.1039809332 -1.0324497943 -0.4478240393 -0.7167341189\n [417] -0.2580017833  0.3780671386 -0.6103415802 -0.1924144908\n [421] -0.7669939872 -0.0180712090  0.539",
        "8890282  0.5064391253\n [425] -0.8587653079  1.3953999035  0.5323497903 -0.7803201701\n [429] -0.6695640901 -0.6676462580 -0.4925852689 -0.7204797530\n [433] -0.7108634799 -0.3154929006 -0.6499736939 -0.0634999649\n [437] -0.7483227044 -1.6053139433 -0.2349845336 -0.8851827790\n [441] -0.6181363045 -0.5760980876  1.2847205256  1.0770950191\n [445] -1.1405034845  0.2847798274  0.4859480579 -0.5775091674\n [449] -0.6663596872 -0.6594476827  0.0513462699 -0.2931539229\n [453] -0.8686575227  1.1445186985 -1.3093399391 ",
        "-0.4130357069\n [457] -0.4432751511 -0.5835786462 -0.5308067019 -0.1339626466\n [461]  0.2181121486 -0.6922329168  1.1924207486 -0.6931635123\n [465] -0.7017285054 -0.0008032305 -0.6004308323  1.5681587184\n [469]  0.0726675384  0.6056626686 -0.4495305026 -0.8063599845\n [473] -0.7211789207 -1.1783219541  0.0786506502 -0.1436134150\n [477]  1.4882106860 -0.4351034206 -0.5833127314 -0.4233342600\n [481] -0.4371273356  1.0755711102 -0.6796967728 -0.0341676778\n [485] -0.0266327128 -0.4533006814  0.2138720447 -0.83870",
        "92846\n [489] -0.6598242571 -0.6655399782 -0.7406616245 -0.6172331922\n [493] -0.9169456893  0.2867220200 -1.2678331908 -0.0711160245\n [497] -0.4790749938 -1.3054776840 -4.6184149513 -0.5962862062\n [501] -0.3296513408  0.1265008092 -0.7641896206 -2.4661272871\n [505] -0.8575117105 -0.0396862560 -0.3316146047 -1.5596802263\n [509] -4.1255322247 -0.8458438791  0.6423300824 -0.4967061661\n [513] -0.0897406911 -0.4352837818 -2.1314005959 -0.5804242865\n [517] -0.4067505428 -1.3717150121 -0.4773456986 -0.5920548374\n [",
        "521] -1.4266616005 -0.4066930627 -0.6750095928  0.6090812675\n [525] -0.7653404703  0.2300086373 -0.1031227882 -0.9172463272\n [529]  0.8275168555 -0.6903295411 -0.8490260267 -1.1412006833\n [533] -0.9366831250  1.7254194917  2.0845833032 -0.2203474240\n [537] -0.5314814283 -0.8229514124 -0.0203889922 -0.2918834866\n [541] -0.9175770534  0.2918298951  0.4174154994  1.2063759490\n [545] -1.0131856755  0.3451437768 -0.8732519166  0.3175782103\n [549] -0.4972377768 -0.0337074300  0.7398543199 -0.4213146980\n [553]  0.",
        "3530895129  1.6275834680  1.2873299594 -0.8730996360\n [557] -0.2668651768 -0.2781023316 -0.6744348149 -0.3183801955\n [561] -0.3124856078 -0.9486819500 -0.3653544346  1.6284957362\n [565] -0.3252499658  0.4486263251 -0.8901139006  1.4561785966\n [569] -0.6842844225  0.0254103322  0.4142419797 -1.1259293317\n [573] -0.6149341246 -0.5309732218  0.6173423701 -0.6843044967\n [577] -0.6029126827 -0.0504996945 -0.1940071839 -0.5584025121\n [581] -1.0730753785 -0.2568559079 -0.4893304968 -0.3175520885\n [585] -0.55757228",
        "39 -0.2933719534 -0.3392641554 -0.6312261882\n [589] -0.8814374035  0.3155787872  1.5175550349 -0.8220926148\n [593] -1.0867847385 -0.2586043212 -0.8309459158 -0.4556316093\n [597] -0.7097236686  1.4716256467 -0.6410123268 -0.1875455299\n [601] -0.6222517247 -0.5870943423 -0.7807180158 -1.2017999426\n [605] -0.2113475144 -0.7453580740 -0.4980096439  0.6196795873\n [609] -0.1212089547 -0.2850556617 -0.6159302049  0.0305455705\n [613] -1.3531282206 -0.4550913622  1.1255069816  0.1748958932\n [617] -0.5274456698 -0.27",
        "47910584 -0.2387222653 -0.1325260341\n [621]  0.4575521889 -0.0354571489 -0.3072223428  0.6720575888\n [625] -1.0820954192 -0.9637484305 -0.3069626069 -0.4440277956\n [629]  0.2865429806  0.3021869919  0.5163076395 -0.7803120393\n [633] -0.4549058465  0.9467852047 -0.5872520365 -0.4249966054\n [637] -0.0934518208 -0.2615920013  0.8305168733 -0.3583356108\n [641] -0.6144228254 -2.7433691881 -0.3122561547 -0.5066625676\n [645]  1.0651690932 -0.1563098427 -0.2162013971 -1.6780884111\n [649] -0.8621618598 -0.2713293434",
        " -0.3689718837 -0.7029188725\n [653] -0.9183770161 -2.2814902263 -0.4463138079 -0.2674828376\n [657] -0.7872959007  0.1796414030 -0.4909621955  0.0169882699\n [661] -0.0451747610 -0.8914395018 -0.8990152460  0.9196484579\n [665]  1.8149135202 -0.2127338109  0.0169226839  0.2081707991\n [669]  1.8770623514  0.6648341904 -0.6433172587 -0.7520943630\n [673] -3.0054757583 -0.6365155261 -0.8139183307 -0.1949510886\n [677] -0.7074473518  0.7932880901 -0.6123788229 -0.6235112725\n [681] -0.6956810113 -0.7451286422  1.1112",
        "295262 -0.7333155430\n [685] -0.6798751483 -1.0205435115  1.3360785856  1.6138418038\n [689] -0.3700765354 -0.6996008917 -1.1011201987 -1.0032249881\n [693] -0.9362419629 -0.4313572772 -0.7002575991  1.9235214175\n [697] -0.7711388702 -1.2122809983 -0.5369527872 -1.0233424249\n [701] -0.4931957051 -0.4687479179  0.1668648593  1.5509798049\n [705] -0.6044395197 -0.3933754724 -0.2347738031 -1.1356764866\n [709]  0.6602938099  0.5913224089 -0.4017342997 -0.9453728690\n [713] -0.5411939331  0.4119110796  0.4539709247 -",
        "0.7047740597\n [717] -0.5390377212 -0.8806650971  0.9645071156 -0.6209762560\n [721] -0.5044466389 -2.1558686633 -0.3691601269 -0.4424786850\n [725] -1.3083020752 -0.3369678759 -0.3758743552 -0.6048320301\n [729]  0.7834615904 -0.8152297177 -0.7257900714 -0.6061131236\n [733] -0.7290054064 -0.5484398734 -0.0799545099 -0.7833429672\n [737] -0.0373612473 -0.8023126234 -0.7095180476 -1.5923677647\n [741] -0.4204369093 -0.7527757620 -0.9044848824 -0.2799311565\n [745] -0.1703395303 -0.0257986733  0.9088158923 -0.934648",
        "2264\n [749] -0.5973623671 -0.7778388755 -0.7290078533  1.0650871605\n [753] -0.8711198796  1.5561430790  0.5307911506 -0.5303603709\n [757] -0.5426069232  1.1118244751 -0.5063966446 -0.5568947126\n [761] -0.5459018824  0.6751377176 -0.1814696405 -0.9722553644\n [765]  0.3440876689 -0.6500278662 -0.9480789118  0.5771705557\n [769] -0.9364316153 -0.5445963333 -0.4646663115 -0.0540089712\n [773] -0.7400819567 -0.5015596589 -1.0970443762 -1.4833444208\n [777] -0.7087647480  0.6408262579 -0.6991535351 -0.4704641616\n [7",
        "81] -0.7637582959 -0.3080844012  0.1326218702 -0.3755591202\n [785] -0.5029547544 -0.6327163517  0.9547917459 -0.8550421744\n [789] -0.4544436721  1.6218454157 -1.8627277000 -0.6295556848\n [793] -0.7264703335 -0.4971449159 -0.6072235445 -0.7313227287\n [797]  1.7783280627  0.1834181936  1.7799740883 -0.1902173669\n [801] -1.1885288781 -0.8386001637 -0.8661378718  1.4744655409\n [805] -2.7411235903 -0.2767817306  0.3301401647  0.0263369920\n [809] -0.3964637034 -0.7220551261 -0.0925204913  0.2547220870\n [813]  1.1",
        "795081062  1.0211820918 -0.5581130420 -0.3122659094\n [817] -0.5802817593  1.2870779070 -0.5571250392 -0.4573362630\n [821] -0.4731435966 -0.7645868671 -0.3459667891 -0.2927620142\n [825] -0.2226492032 -0.8570583332 -0.3644072803  2.1017537957\n [829] -0.4565448512 -0.9179491074 -2.4744007668  0.8824011886\n [833] -0.2526967440 -0.6532540127 -0.6447109428  0.0291988556\n [837] -0.9147383332 -0.0422491107 -1.0225907076 -0.6832956860\n [841] -0.5437356273 -0.4000438284 -0.4894804625 -0.6981851651\n [845] -0.553582020",
        "2  0.9945545774  0.0522876862 -0.3796776421\n [849] -0.5544981010 -1.1446347600  2.0347064576 -0.6583109755\n [853] -0.5691549767 -0.6182105428 -2.5944655443 -1.5085472915\n [857] -0.8914478054 -0.0789235490 -0.5182082743  0.0892985031\n [861] -1.4531202724  1.1974794905 -0.2776065752 -1.0783736587\n [865] -0.5278907982 -0.3353284037 -0.5116014828  0.1514521696\n [869] -0.5639595768  0.7445315834  1.4509077431 -0.0358679560\n [873] -0.8190809344  0.3043863500 -1.0252947038 -0.6825427596\n [877] -0.9765937501  1.198",
        "9152625 -0.9342730947 -1.1498055527\n [881] -0.3225525655 -0.2973819519 -0.7280379893  0.7118939245\n [885]  1.0072045791 -0.3770004803 -0.6796560245 -0.3460867792\n [889]  1.8259134324 -0.4130791471  0.7786641798 -1.2211048970\n [893] -0.0976453925 -1.2928308479 -0.2283208875 -0.8037297253\n [897]  0.9635356521  0.0856485065 -0.3474740399 -0.3278311197\n [901] -1.0700931205 -0.6267259459 -0.2677521537 -1.4351604542\n [905] -0.2697611941 -0.8420038537  0.5067088537 -0.1696286035\n [909] -0.5647107718 -0.5486416501 ",
        " 1.6110929516 -0.4141392869\n [913] -0.1431376236  0.8822380585 -0.8541857815 -0.2476237516\n [917] -0.3536543927 -0.8962046648 -1.8623990300  0.7554780148\n [921]  0.7164424724 -0.7921901671 -0.5381184400 -0.7136959208\n [925] -0.0263757801 -0.4418850078 -0.8627088098 -1.2605264955\n [929] -3.4561338558 -1.0884923804 -0.2329377006 -0.5434688319\n [933] -0.4337566428 -0.5445727367 -0.5951931219 -0.6759776113\n [937] -0.2709702690 -0.5289287886  0.7147210872  0.2244128158\n [941]  1.0424062149 -0.0665468811 -0.50647",
        "65750 -2.3072990506\n [945]  0.8210401418 -0.2964416484 -0.7522186556 -1.0274515970\n [949] -0.4837836706 -0.0476801585  0.3709512236  1.0151817488\n [953] -0.6009449336  1.4314160179  0.4380343431  0.0320496300\n [957] -2.1556877663 -0.2259955017 -0.2793298548 -0.0401067586\n [961] -3.9533513252 -0.6294812371 -0.4168320655 -0.5800320887\n [965] -1.2828205756 -0.8700070435 -0.4110767925  1.1223783940\n [969] -0.6484055786 -0.6585896846 -0.7421359121 -0.2991687991\n [973] -0.8521702601  0.8713856919 -0.4323231389 -0",
        ".8442873664\n [977] -0.3447681431 -0.7414311901 -0.7356202240 -0.2617144128\n [981] -0.8796268929 -0.8604621342 -0.6638896136 -1.2569810577\n [985] -0.2561497614 -0.8651340968 -0.2495104761 -1.1705035849\n [989] -0.7551460004 -0.3545513622 -0.7781674927  1.4152901847\n [993]  1.6151166203 -0.8589417133 -0.9534766056  1.3593140683\n [997]  0.4997141322 -0.4325573786 -0.5401622216 -1.0466402438\n",
        "> ",
        "gridExtra::grid.arrange(",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    log_htx = log.htx(f1, deriv=0)$h), aes(x = x, y=log_htx))+",
        "+ ",
        "    geom_line()+geom_point(),",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    stx = exp(log.Stx(f1, deriv=0)$s)), aes(x = x, y=stx))+",
        "+ ",
        "    geom_line()+geom_point(),",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    f = f1$f), aes(x = x, y=f))+",
        "+ ",
        "    geom_line()+geom_point(), ncol=2)",
        "> ",
        "gridExtra::grid.arrange(",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    log_htx = log.htx(f1, deriv=0)$h), aes(x = x, y=log_htx))+",
        "+ ",
        "    geom_line()+geom_point(),",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    stx = exp(log.Stx(f1, deriv=0)$s)), aes(x = x, y=stx))+",
        "+ ",
        "    geom_line()+geom_point(),",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    f = f1$f), aes(x = x, y=f))+",
        "+ ",
        "    geom_line()+geom_point(),",
        "+ ",
        "  ggplot(data.frame(x = dat$times,",
        "+ ",
        "                    f = S0(dat$times)), aes(x = x, y=f))+",
        "+ ",
        "    geom_line()+geom_point(), ncol=2)",
        "Errore in S0(dat$times) : argomento \"p\" assente, senza valore predefinito\n",
        "> ",
        "gridExtra::grid.arrange(",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    log_htx = log.htx(f1, deriv=0)$h), aes(x = x, y=log_htx))+",
        "+ ",
        "    geom_line()+geom_point(),",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    stx = exp(log.Stx(f1, deriv=0)$s)), aes(x = x, y=stx))+",
        "+ ",
        "    geom_line()+geom_point(),",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    f = f1$f), aes(x = x, y=f))+",
        "+ ",
        "    geom_line()+geom_point(),",
        "+ ",
        "  ggplot(data.frame(x = dat$times,",
        "+ ",
        "                    f = S0(dat$times, p=pp)), aes(x = x, y=f))+",
        "+ ",
        "    geom_line()+geom_point(), ncol=2)",
        "> ",
        "gridExtra::grid.arrange(",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    log_htx = log.htx(f1, deriv=0)$h), aes(x = x, y=log_htx))+",
        "+ ",
        "    geom_line()+geom_point(),",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    stx = exp(log.Stx(f1, deriv=0)$s)), aes(x = x, y=stx))+",
        "+ ",
        "    geom_line()+geom_point(),",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    f = f1$f), aes(x = x, y=f))+",
        "+ ",
        "    geom_line()+geom_point(),",
        "+ ",
        "  ggplot(data.frame(x = dat$times,",
        "+ ",
        "                    f = S0(dat$times, p=pp)), aes(x = x, y=f))+",
        "+ ",
        "    geom_point(), ncol=2)",
        "> ",
        "gridExtra::grid.arrange(",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    log_htx = log.htx(f1, deriv=0)$h), aes(x = x, y=log_htx))+",
        "+ ",
        "    geom_line()+geom_point(),",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    stx = exp(log.Stx(f1, deriv=0)$s)), aes(x = x, y=stx))+",
        "+ ",
        "    geom_line()+geom_point(),",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    f = f1$f), aes(x = x, y=f))+",
        "+ ",
        "    geom_line()+geom_point(),",
        "+ ",
        "  ggplot(data.frame(x = dat$times,",
        "+ ",
        "                    f = S0(dat$times, p=pp)), aes(x = x, y=f))+",
        "+ ",
        "    geom_point()+ylab(\"true s0\"), ncol=2)",
        "> ",
        "S0 <- function(t, p=0.8, lambda1 = 0.1, gamma1 = 3, lambda2=0.1, gamma2=1.6){",
        "+ ",
        "  p*exp(-lambda1*t^gamma1) + (1-p)*exp(-lambda2 * t^gamma2)",
        "+ ",
        "}",
        "> ",
        "gridExtra::grid.arrange(",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    log_htx = log.htx(f1, deriv=0)$h), aes(x = x, y=log_htx))+",
        "+ ",
        "    geom_line()+geom_point(),",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    stx = exp(log.Stx(f1, deriv=0)$s)), aes(x = x, y=stx))+",
        "+ ",
        "    geom_line()+geom_point(),",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    f = f1$f), aes(x = x, y=f))+",
        "+ ",
        "    geom_line()+geom_point(),",
        "+ ",
        "  ggplot(data.frame(x = dat$times,",
        "+ ",
        "                    f = S0(dat$times)), aes(x = x, y=f))+",
        "+ ",
        "    geom_point()+ylab(\"true s0\"), ncol=2)",
        "> ",
        "gridExtra::grid.arrange(",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    htx = exp(log.htx(f1, deriv=0)$h)), aes(x = x, y=log_htx))+",
        "+ ",
        "    geom_line()+geom_point()+ylab(\"hazard function\"),",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    stx = exp(log.Stx(f1, deriv=0)$s)), aes(x = x, y=stx))+",
        "+ ",
        "    geom_line()+geom_point()+ylab(\"estimated s0\"),",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    f = f1$f), aes(x = x, y=f))+",
        "+ ",
        "    geom_line()+geom_point()+ylab(\"smooth function\"),",
        "+ ",
        "  ggplot(data.frame(x = dat$times,",
        "+ ",
        "                    f = S0(dat$times)), aes(x = x, y=f))+",
        "+ ",
        "    geom_point()+ylab(\"true s0\"), ncol=2)",
        "\u001B[1m\u001B[33mError\u001B[39m in `geom_line()`:\u001B[22m\n\u001B[38;5;232m\u001B[33m!\u001B[38;5;232m Problem while computing aesthetics.\n\u001B[36mℹ\u001B[38;5;232m Error occurred in the 1st layer.\u001B[39m\n\u001B[1mCaused by error:\u001B[22m\n\u001B[33m!\u001B[39m oggetto 'log_htx' non trovato\n\u001B[90mRun `\u001B]8;;x-r-run:rlang::last_trace()\u0007rlang::last_trace()\u001B]8;;\u0007` to see where the error occurred.\u001B[39m\n",
        "> ",
        "                    htx = exp(log.htx(f1, deriv=0)$h), aes(x = x, y=log_htx))+",
        "Errore: ',' inatteso in \"                    htx = exp(log.htx(f1, deriv=0)$h),\"\n",
        "> ",
        "exp(log.htx(f1, deriv=0)$h))",
        "Errore: ')' inatteso in \"exp(log.htx(f1, deriv=0)$h))\"\n",
        "> ",
        "exp(log.htx(f1, deriv=0)$h))",
        "Errore: ')' inatteso in \"exp(log.htx(f1, deriv=0)$h))\"\n",
        "> ",
        "exp(log.htx(f1, deriv=0)$h)",
        "   [1] 0.044477792 0.376708875 0.598927922 1.416608702 0.514164654\n   [6] 0.031624865 0.811496049 0.506303370 0.411943765 0.425085842\n  [11] 3.082192241 0.541420468 0.421236250 0.652002872 0.870807423\n  [16] 0.687829559 0.264860444 2.653898238 0.450496301 0.548047967\n  [21] 0.443041248 0.814083019 0.752503361 0.611872844 2.023857061\n  [26] 0.275284893 0.694872014 0.377314648 0.615471830 6.001926558\n  [31] 1.983215597 7.764489122 0.348975025 0.433250896 0.336282899\n  [36] 0.727213560 3.174217923 0.504961883 ",
        "0.573126128 0.778658711\n  [41] 0.313279988 0.378014212 0.494726941 1.099646358 0.453627433\n  [46] 0.561635874 1.641918225 0.370058719 0.268958267 0.548346686\n  [51] 0.403839627 0.376500775 0.788944781 0.436207421 1.318995954\n  [56] 1.082498181 0.729049600 0.782600226 1.927566559 0.047369519\n  [61] 1.426958697 0.990215021 0.499672893 0.446154767 0.511167552\n  [66] 0.756754302 0.993857778 3.147912799 0.467557951 0.810594472\n  [71] 1.317309129 1.822126445 0.231755745 1.559741745 0.475284653\n  [76] 0.611737591 ",
        "0.517854028 6.201765733 0.422476485 0.542958353\n  [81] 0.318927307 0.533385989 1.271006593 1.002679188 0.394223538\n  [86] 0.499325180 0.216039932 0.787296431 1.249970025 0.574002285\n  [91] 0.547487496 0.197569726 0.453291876 4.880669959 0.448362619\n  [96] 0.476695395 3.895485773 0.385794226 2.632163394 2.683166470\n [101] 0.454429055 0.522938628 0.790899102 0.539738945 5.033978715\n [106] 0.625124070 0.523298195 6.242648527 1.010570569 0.441477782\n [111] 0.512193826 0.136050371 0.589183561 0.287027438 3.80747",
        "9435\n [116] 0.612896554 1.337969362 0.537420142 1.225007501 0.840281439\n [121] 0.403765491 1.444331842 0.632668296 0.607350450 0.779685517\n [126] 2.079557724 1.310027864 1.305981549 0.425444457 5.895405619\n [131] 0.441276933 0.641899738 0.759050406 0.655780834 0.356065002\n [136] 0.481241541 0.792691474 0.808914829 0.338749471 0.792732797\n [141] 1.662807089 0.508690576 0.608811045 0.549591013 2.589162428\n [146] 1.271521868 0.446376835 1.952434822 5.915627896 0.452186002\n [151] 1.423757057 0.511317125 4.33706",
        "1047 3.361554936 0.722167577\n [156] 4.894717812 2.365785986 3.635904915 0.843433079 1.397444491\n [161] 0.200374570 0.473660458 0.830601820 0.356230373 1.942688415\n [166] 0.519917409 0.508906135 0.634702001 0.538677156 0.401780869\n [171] 0.618715606 0.599551864 0.474102004 2.454138795 0.457593089\n [176] 0.105837617 1.902714930 1.999604124 1.796902799 1.131139669\n [181] 0.474892268 0.418977854 0.549320434 4.102444475 0.825876959\n [186] 0.531565889 1.246052514 0.462072919 0.901991373 0.035405790\n [191] 0.30611",
        "6653 0.026948448 0.197188409 0.558539810 0.632420789\n [196] 0.065226890 0.600504209 0.951243366 0.793314298 1.212770444\n [201] 0.258629288 0.423145989 0.385372069 1.342501622 0.497478950\n [206] 0.376706791 2.192635909 1.313852082 0.424283219 0.082733254\n [211] 1.220634806 5.257201788 0.353915101 0.663749861 0.386327668\n [216] 0.554412306 0.406682858 7.386767689 0.890333658 0.550362433\n [221] 0.390339013 1.701762118 0.585880021 1.615589198 0.422202662\n [226] 0.724458992 0.180878288 3.592217503 0.471106420 0.",
        "301075322\n [231] 0.491831229 0.452073782 0.372389068 0.624600382 0.171269576\n [236] 0.231569718 4.052528840 0.676370369 0.373783711 0.595247207\n [241] 0.461407169 0.583953397 0.635410487 0.527848477 1.267916883\n [246] 0.821602948 0.538048483 0.455078283 0.752072071 0.494301588\n [251] 0.436993655 5.629153394 0.873146306 6.116078935 0.616606720\n [256] 0.478721627 0.352067315 0.770078524 2.324194088 2.059311931\n [261] 1.330300922 2.121408099 1.622346153 0.936677038 3.189389148\n [266] 0.414323677 0.522369432 0.",
        "994995496 0.499678430 0.301173239\n [271] 0.510187851 0.410943306 0.183930221 2.658748492 0.573631940\n [276] 0.613825083 0.822175788 0.794630666 0.624355398 0.701686945\n [281] 1.750904857 0.537234344 0.420383974 0.304709473 0.434191610\n [286] 0.484288674 1.851403443 0.660159772 0.534093804 0.628137247\n [291] 0.467389479 6.316861436 0.478097202 0.678910719 4.108235135\n [296] 0.283207204 0.467948267 0.581015857 0.426520098 0.516817316\n [301] 1.862961948 3.899430626 2.591704087 0.452847120 0.582866983\n [306] 0.",
        "745153818 0.248261711 0.362292646 2.382256181 0.435918032\n [311] 0.373815624 0.462552522 1.509317935 0.752273648 0.367689171\n [316] 0.385828092 3.695132167 0.402742960 4.304619363 0.428103715\n [321] 0.513290968 0.461203335 1.119144675 0.554377262 0.687649744\n [326] 1.010596656 0.481938125 0.383067760 0.340310439 3.086401886\n [331] 0.383949963 0.444352188 1.853355446 7.862525152 0.517003669\n [336] 0.480594214 4.661017020 0.775631615 0.837505389 1.740236258\n [341] 1.338745971 0.531499088 0.285634901 3.5391048",
        "62 0.470806315\n [346] 1.038823101 0.500330794 0.496914390 0.522399864 0.525166235\n [351] 0.909958129 0.143085414 0.571336441 1.554945767 0.571205722\n [356] 0.598196592 0.569912808 0.843835818 0.560855789 0.372165005\n [361] 0.659215477 0.400020692 0.479832133 0.407318432 0.105585417\n [366] 0.486260577 0.447763855 0.144545271 0.805360123 0.855608722\n [371] 0.798272629 1.883806169 1.713799816 3.181030316 0.202422560\n [376] 4.027596810 1.934177702 0.360466028 0.822471764 0.274380631\n [381] 0.600977226 0.9776086",
        "13 0.786059661 0.451936390 0.510198797\n [386] 0.699853186 0.463877744 4.660429818 0.635589826 2.462056725\n [391] 2.375150559 2.011395302 0.566924099 0.307058207 6.231417621\n [396] 0.444358269 0.459403646 0.432874363 0.296562182 1.470527413\n [401] 0.445977137 0.338626670 0.162809087 0.519927547 0.693660935\n [406] 0.731574785 1.336596707 0.523470271 0.691650201 3.984091474\n [411] 0.556513949 0.484104568 1.109579299 0.356133437 0.639017116\n [416] 0.488344530 0.772593854 1.459460926 0.543165303 0.824964857\n [42",
        "1] 0.464406986 0.982091096 1.715816444 1.659371847 0.423684880\n [426] 4.036588496 1.702929137 0.458259267 0.511931685 0.512914426\n [431] 0.611044636 0.486518791 0.491219856 0.729429250 0.522059510\n [436] 0.938474152 0.473159516 0.200826497 0.790583077 0.412638745\n [441] 0.538947937 0.562087309 3.613657891 2.936137726 0.319658038\n [446] 1.329469283 1.625715551 0.561294718 0.513574752 0.517136879\n [451] 1.052687344 0.745907320 0.419514360 3.140929259 0.269998213\n [456] 0.661638657 0.641930555 0.557898269 0.58",
        "8130332 0.874622734\n [461] 1.243726542 0.500457341 3.295048044 0.499991834 0.495727695\n [466] 0.999197092 0.548575241 4.797805944 1.075372957 1.832466124\n [471] 0.637927587 0.446480307 0.486178752 0.307794799 1.081826320\n [476] 0.866222552 4.429163261 0.647197730 0.558046643 0.654859703\n [481] 0.645889181 2.931666727 0.506770636 0.966409446 0.973718810\n [486] 0.635527014 1.238464177 0.432268099 0.516942175 0.513995906\n [491] 0.476798350 0.539434887 0.399738103 1.332053878 0.281440790\n [496] 0.931353826 0.61",
        "9356035 0.271043031 0.009868426 0.550853599\n [501] 0.719174437 1.134850370 0.465711181 0.084913067 0.424216343\n [506] 0.961090928 0.717763892 0.210203278 0.016154894 0.429195017\n [511] 1.900904988 0.608531765 0.914168206 0.647081011 0.118670967\n [516] 0.559660860 0.665810261 0.253671537 0.620428011 0.553189402\n [521] 0.240109166 0.665848533 0.509151536 1.838741311 0.465175526\n [526] 1.258610881 0.902016210 0.399617944 2.287631163 0.501410806\n [531] 0.427831425 0.319435251 0.391925650 5.614875930 8.041240025",
        "\n [536] 0.802240032 0.587733639 0.439133675 0.979817458 0.746855550\n [541] 0.399485802 1.338875249 1.518033124 3.341353449 0.363060542\n [546] 1.412192946 0.417591367 1.373796686 0.608208349 0.966854336\n [551] 2.095630201 0.656183569 1.423458556 5.091555932 3.623099806\n [556] 0.417654962 0.765776309 0.757219330 0.509444270 0.727326210\n [561] 0.731626159 0.387251104 0.693950647 5.096202916 0.722346769\n [566] 1.566159313 0.410608981 4.289536120 0.504451074 1.025735927\n [571] 1.513223252 0.324350898 0.540676511",
        " 0.588032405 1.853994258\n [576] 0.504440948 0.547215448 0.950754219 0.823651987 0.572122293\n [581] 0.341955257 0.773479658 0.613036687 0.727928763 0.572597482\n [586] 0.745744707 0.712294268 0.531939143 0.414187130 1.371052629\n [591] 4.561059919 0.439510964 0.337299257 0.772128478 0.435637015\n [596] 0.634047371 0.491780073 4.356311211 0.526758902 0.828991373\n [601] 0.536734498 0.555940312 0.458076987 0.300652567 0.809492708\n [606] 0.474564340 0.607739074 1.858332513 0.885848838 0.751972397\n [611] 0.540138222",
        " 1.031016873 0.258430567 0.634390006 3.081778858\n [616] 1.191122206 0.590110383 0.759730846 0.787633605 0.875880131\n [621] 1.580201213 0.965164092 0.735487052 1.958262477 0.338884676\n [626] 0.381460325 0.735678110 0.641447591 1.331815409 1.352814168\n [631] 1.675828449 0.458262993 0.634507706 2.577410479 0.555852651\n [636] 0.653772004 0.910781897 0.769825047 2.294504402 0.698838498\n [641] 0.540953030 0.064353163 0.731794052 0.602503040 2.901329538\n [646] 0.855294143 0.805573045 0.186730587 0.422248253 0.7623",
        "65375\n [651] 0.691444851 0.495137948 0.399166356 0.102131894 0.639982909\n [656] 0.765303465 0.455073697 1.196788122 0.612037211 1.017133391\n [661] 0.955830425 0.410065038 0.406970228 2.508408424 6.140545121\n [666] 0.808371288 1.017066684 1.231423478 6.534281218 1.944168133\n [671] 0.525546157 0.471378281 0.049515191 0.529132966 0.443118376\n [676] 0.822874905 0.492900795 2.210653316 0.542059870 0.536058880\n [681] 0.498734688 0.474673233 3.038091512 0.480313846 0.506680248\n [686] 0.360399006 3.804096778 5.0220",
        "68014 0.690681467 0.496783535\n [691] 0.332498411 0.366694945 0.392098591 0.649626772 0.496457400\n [696] 6.845020253 0.462486057 0.297517867 0.584526719 0.359391691\n [701] 0.610671746 0.625785313 1.181594573 4.716088766 0.546380576\n [706] 0.674775340 0.790749694 0.321204757 1.935360879 1.806375604\n [711] 0.669158518 0.388534671 0.582052905 1.509700187 1.574552216\n [716] 0.494220226 0.583309289 0.414507132 2.623494258 0.537419522\n [721] 0.603839624 0.115802553 0.691314703 0.642442034 0.270278580\n [726] 0.7139",
        "31774 0.686688606 0.546166158 2.189036714 0.442537657\n [731] 0.483942069 0.545466916 0.482388532 0.577850628 0.923158340\n [736] 0.456876134 0.963328073 0.448291036 0.491881204 0.203443335\n [741] 0.656759813 0.471057194 0.404750325 0.755835774 0.843378415\n [746] 0.974531269 2.481382569 0.392723991 0.550261110 0.459397755\n [751] 0.482387352 2.901091834 0.418482637 4.740502198 1.700276952\n [756] 0.588392892 0.581231051 3.039899559 0.602663281 0.572985589\n [761] 0.579319070 1.964303477 0.834043566 0.378229031 1",
        ".410702305\n [766] 0.522031230 0.387484701 1.780992077 0.392024236 0.580075893\n [771] 0.628344742 0.947423607 0.477074814 0.605585416 0.333856381\n [776] 0.226877644 0.492251877 1.898048509 0.497005824 0.624712234\n [781] 0.465912097 0.734853293 1.141818161 0.686905109 0.604741156\n [786] 0.531147057 2.598129455 0.425265255 0.634801027 5.062423978\n [791] 0.155248581 0.532828492 0.483612974 0.608264830 0.544861555\n [796] 0.481271977 5.919950354 1.201316686 5.929702768 0.826779400\n [801] 0.304669140 0.432315271 0",
        ".420572722 4.368700257 0.064497837\n [806] 0.758219975 1.391163107 1.026686875 0.672694693 0.485752946\n [811] 0.911630530 1.290103035 3.252773790 2.776474873 0.572287929\n [816] 0.731786913 0.559740632 3.622186710 0.572853630 0.632967461\n [821] 0.623040598 0.465526215 0.707535985 0.746199705 0.800395576\n [826] 0.424408717 0.694608237 8.180504272 0.633468597 0.399337200\n [831] 0.084213439 2.416695687 0.776703386 0.520349794 0.524814222\n [836] 1.029629322 0.400621442 0.958630946 0.359661953 0.504950090\n [841] 0",
        ".580575383 0.670290668 0.612944759 0.497487342 0.574886861\n [846] 2.703519864 1.053678828 0.684081893 0.574360460 0.318340167\n [851] 7.650006195 0.517725047 0.566003523 0.538907928 0.074685782\n [856] 0.221231129 0.410061633 0.924110571 0.595586721 1.093406993\n [861] 0.233839506 3.311759074 0.757594819 0.340148273 0.589847767\n [866] 0.715103205 0.599534665 1.163522649 0.568951790 2.105454974\n [871] 4.266986085 0.964767677 0.440836626 1.355792765 0.358690742\n [876] 0.505330424 0.376591682 3.316517420 0.392871",
        "342 0.316698345\n [881] 0.724297858 0.742760259 0.482855429 2.037847135 2.737936622\n [886] 0.685915744 0.506791286 0.707451092 6.208463441 0.661609916\n [891] 2.178560156 0.294904148 0.906970465 0.274492635 0.795868834\n [896] 0.447656212 2.620946867 1.089423336 0.706470354 0.720484685\n [901] 0.342976578 0.534338393 0.765097384 0.238077160 0.763561816\n [906] 0.430846305 1.659819487 0.843978209 0.568524556 0.577734043\n [911] 5.008282047 0.660908889 0.866634791 2.416301484 0.425629606\n [916] 0.780653608 0.702117",
        "582 0.408115660 0.155299615 2.128628796\n [921] 2.047137493 0.452851887 0.583845760 0.489830473 0.973969023\n [926] 0.642823551 0.422017368 0.283504723 0.031551509 0.336723763\n [931] 0.792202926 0.580730299 0.648069949 0.580089581 0.551456057\n [936] 0.508658907 0.762639170 0.589235828 2.043616612 1.251587588\n [941] 2.836032915 0.935619052 0.602615112 0.099529714 2.272862708\n [946] 0.743459008 0.471319696 0.357917918 0.616446543 0.953438688\n [951] 1.449112389 2.759864954 0.548293290 4.184620496 1.549658127\n [9",
        "56] 1.032568750 0.115823504 0.797721690 0.756290396 0.960686872\n [961] 0.019190281 0.532868162 0.659131602 0.559880400 0.277254180\n [966] 0.418948598 0.662936021 3.072152309 0.522878802 0.517580772\n [971] 0.476095930 0.741434245 0.426488336 2.390220669 0.648999626\n [976] 0.429863584 0.708384578 0.476431563 0.479208150 0.769730818\n [981] 0.414937699 0.422966570 0.514844887 0.284511656 0.774026041\n [986] 0.420995095 0.779182118 0.310210685 0.469941998 0.701488087\n [991] 0.459246814 4.117681181 5.028474312 0.4",
        "23610146 0.385398812\n [996] 3.893521696 1.648250022 0.648847622 0.582653726 0.351115432\n",
        "> ",
        "exp(log.htx(f1, deriv=0)$h)",
        "   [1] 0.044477792 0.376708875 0.598927922 1.416608702 0.514164654\n   [6] 0.031624865 0.811496049 0.506303370 0.411943765 0.425085842\n  [11] 3.082192241 0.541420468 0.421236250 0.652002872 0.870807423\n  [16] 0.687829559 0.264860444 2.653898238 0.450496301 0.548047967\n  [21] 0.443041248 0.814083019 0.752503361 0.611872844 2.023857061\n  [26] 0.275284893 0.694872014 0.377314648 0.615471830 6.001926558\n  [31] 1.983215597 7.764489122 0.348975025 0.433250896 0.336282899\n  [36] 0.727213560 3.174217923 0.504961883 ",
        "0.573126128 0.778658711\n  [41] 0.313279988 0.378014212 0.494726941 1.099646358 0.453627433\n  [46] 0.561635874 1.641918225 0.370058719 0.268958267 0.548346686\n  [51] 0.403839627 0.376500775 0.788944781 0.436207421 1.318995954\n  [56] 1.082498181 0.729049600 0.782600226 1.927566559 0.047369519\n  [61] 1.426958697 0.990215021 0.499672893 0.446154767 0.511167552\n  [66] 0.756754302 0.993857778 3.147912799 0.467557951 0.810594472\n  [71] 1.317309129 1.822126445 0.231755745 1.559741745 0.475284653\n  [76] 0.611737591 ",
        "0.517854028 6.201765733 0.422476485 0.542958353\n  [81] 0.318927307 0.533385989 1.271006593 1.002679188 0.394223538\n  [86] 0.499325180 0.216039932 0.787296431 1.249970025 0.574002285\n  [91] 0.547487496 0.197569726 0.453291876 4.880669959 0.448362619\n  [96] 0.476695395 3.895485773 0.385794226 2.632163394 2.683166470\n [101] 0.454429055 0.522938628 0.790899102 0.539738945 5.033978715\n [106] 0.625124070 0.523298195 6.242648527 1.010570569 0.441477782\n [111] 0.512193826 0.136050371 0.589183561 0.287027438 3.80747",
        "9435\n [116] 0.612896554 1.337969362 0.537420142 1.225007501 0.840281439\n [121] 0.403765491 1.444331842 0.632668296 0.607350450 0.779685517\n [126] 2.079557724 1.310027864 1.305981549 0.425444457 5.895405619\n [131] 0.441276933 0.641899738 0.759050406 0.655780834 0.356065002\n [136] 0.481241541 0.792691474 0.808914829 0.338749471 0.792732797\n [141] 1.662807089 0.508690576 0.608811045 0.549591013 2.589162428\n [146] 1.271521868 0.446376835 1.952434822 5.915627896 0.452186002\n [151] 1.423757057 0.511317125 4.33706",
        "1047 3.361554936 0.722167577\n [156] 4.894717812 2.365785986 3.635904915 0.843433079 1.397444491\n [161] 0.200374570 0.473660458 0.830601820 0.356230373 1.942688415\n [166] 0.519917409 0.508906135 0.634702001 0.538677156 0.401780869\n [171] 0.618715606 0.599551864 0.474102004 2.454138795 0.457593089\n [176] 0.105837617 1.902714930 1.999604124 1.796902799 1.131139669\n [181] 0.474892268 0.418977854 0.549320434 4.102444475 0.825876959\n [186] 0.531565889 1.246052514 0.462072919 0.901991373 0.035405790\n [191] 0.30611",
        "6653 0.026948448 0.197188409 0.558539810 0.632420789\n [196] 0.065226890 0.600504209 0.951243366 0.793314298 1.212770444\n [201] 0.258629288 0.423145989 0.385372069 1.342501622 0.497478950\n [206] 0.376706791 2.192635909 1.313852082 0.424283219 0.082733254\n [211] 1.220634806 5.257201788 0.353915101 0.663749861 0.386327668\n [216] 0.554412306 0.406682858 7.386767689 0.890333658 0.550362433\n [221] 0.390339013 1.701762118 0.585880021 1.615589198 0.422202662\n [226] 0.724458992 0.180878288 3.592217503 0.471106420 0.",
        "301075322\n [231] 0.491831229 0.452073782 0.372389068 0.624600382 0.171269576\n [236] 0.231569718 4.052528840 0.676370369 0.373783711 0.595247207\n [241] 0.461407169 0.583953397 0.635410487 0.527848477 1.267916883\n [246] 0.821602948 0.538048483 0.455078283 0.752072071 0.494301588\n [251] 0.436993655 5.629153394 0.873146306 6.116078935 0.616606720\n [256] 0.478721627 0.352067315 0.770078524 2.324194088 2.059311931\n [261] 1.330300922 2.121408099 1.622346153 0.936677038 3.189389148\n [266] 0.414323677 0.522369432 0.",
        "994995496 0.499678430 0.301173239\n [271] 0.510187851 0.410943306 0.183930221 2.658748492 0.573631940\n [276] 0.613825083 0.822175788 0.794630666 0.624355398 0.701686945\n [281] 1.750904857 0.537234344 0.420383974 0.304709473 0.434191610\n [286] 0.484288674 1.851403443 0.660159772 0.534093804 0.628137247\n [291] 0.467389479 6.316861436 0.478097202 0.678910719 4.108235135\n [296] 0.283207204 0.467948267 0.581015857 0.426520098 0.516817316\n [301] 1.862961948 3.899430626 2.591704087 0.452847120 0.582866983\n [306] 0.",
        "745153818 0.248261711 0.362292646 2.382256181 0.435918032\n [311] 0.373815624 0.462552522 1.509317935 0.752273648 0.367689171\n [316] 0.385828092 3.695132167 0.402742960 4.304619363 0.428103715\n [321] 0.513290968 0.461203335 1.119144675 0.554377262 0.687649744\n [326] 1.010596656 0.481938125 0.383067760 0.340310439 3.086401886\n [331] 0.383949963 0.444352188 1.853355446 7.862525152 0.517003669\n [336] 0.480594214 4.661017020 0.775631615 0.837505389 1.740236258\n [341] 1.338745971 0.531499088 0.285634901 3.5391048",
        "62 0.470806315\n [346] 1.038823101 0.500330794 0.496914390 0.522399864 0.525166235\n [351] 0.909958129 0.143085414 0.571336441 1.554945767 0.571205722\n [356] 0.598196592 0.569912808 0.843835818 0.560855789 0.372165005\n [361] 0.659215477 0.400020692 0.479832133 0.407318432 0.105585417\n [366] 0.486260577 0.447763855 0.144545271 0.805360123 0.855608722\n [371] 0.798272629 1.883806169 1.713799816 3.181030316 0.202422560\n [376] 4.027596810 1.934177702 0.360466028 0.822471764 0.274380631\n [381] 0.600977226 0.9776086",
        "13 0.786059661 0.451936390 0.510198797\n [386] 0.699853186 0.463877744 4.660429818 0.635589826 2.462056725\n [391] 2.375150559 2.011395302 0.566924099 0.307058207 6.231417621\n [396] 0.444358269 0.459403646 0.432874363 0.296562182 1.470527413\n [401] 0.445977137 0.338626670 0.162809087 0.519927547 0.693660935\n [406] 0.731574785 1.336596707 0.523470271 0.691650201 3.984091474\n [411] 0.556513949 0.484104568 1.109579299 0.356133437 0.639017116\n [416] 0.488344530 0.772593854 1.459460926 0.543165303 0.824964857\n [42",
        "1] 0.464406986 0.982091096 1.715816444 1.659371847 0.423684880\n [426] 4.036588496 1.702929137 0.458259267 0.511931685 0.512914426\n [431] 0.611044636 0.486518791 0.491219856 0.729429250 0.522059510\n [436] 0.938474152 0.473159516 0.200826497 0.790583077 0.412638745\n [441] 0.538947937 0.562087309 3.613657891 2.936137726 0.319658038\n [446] 1.329469283 1.625715551 0.561294718 0.513574752 0.517136879\n [451] 1.052687344 0.745907320 0.419514360 3.140929259 0.269998213\n [456] 0.661638657 0.641930555 0.557898269 0.58",
        "8130332 0.874622734\n [461] 1.243726542 0.500457341 3.295048044 0.499991834 0.495727695\n [466] 0.999197092 0.548575241 4.797805944 1.075372957 1.832466124\n [471] 0.637927587 0.446480307 0.486178752 0.307794799 1.081826320\n [476] 0.866222552 4.429163261 0.647197730 0.558046643 0.654859703\n [481] 0.645889181 2.931666727 0.506770636 0.966409446 0.973718810\n [486] 0.635527014 1.238464177 0.432268099 0.516942175 0.513995906\n [491] 0.476798350 0.539434887 0.399738103 1.332053878 0.281440790\n [496] 0.931353826 0.61",
        "9356035 0.271043031 0.009868426 0.550853599\n [501] 0.719174437 1.134850370 0.465711181 0.084913067 0.424216343\n [506] 0.961090928 0.717763892 0.210203278 0.016154894 0.429195017\n [511] 1.900904988 0.608531765 0.914168206 0.647081011 0.118670967\n [516] 0.559660860 0.665810261 0.253671537 0.620428011 0.553189402\n [521] 0.240109166 0.665848533 0.509151536 1.838741311 0.465175526\n [526] 1.258610881 0.902016210 0.399617944 2.287631163 0.501410806\n [531] 0.427831425 0.319435251 0.391925650 5.614875930 8.041240025",
        "\n [536] 0.802240032 0.587733639 0.439133675 0.979817458 0.746855550\n [541] 0.399485802 1.338875249 1.518033124 3.341353449 0.363060542\n [546] 1.412192946 0.417591367 1.373796686 0.608208349 0.966854336\n [551] 2.095630201 0.656183569 1.423458556 5.091555932 3.623099806\n [556] 0.417654962 0.765776309 0.757219330 0.509444270 0.727326210\n [561] 0.731626159 0.387251104 0.693950647 5.096202916 0.722346769\n [566] 1.566159313 0.410608981 4.289536120 0.504451074 1.025735927\n [571] 1.513223252 0.324350898 0.540676511",
        " 0.588032405 1.853994258\n [576] 0.504440948 0.547215448 0.950754219 0.823651987 0.572122293\n [581] 0.341955257 0.773479658 0.613036687 0.727928763 0.572597482\n [586] 0.745744707 0.712294268 0.531939143 0.414187130 1.371052629\n [591] 4.561059919 0.439510964 0.337299257 0.772128478 0.435637015\n [596] 0.634047371 0.491780073 4.356311211 0.526758902 0.828991373\n [601] 0.536734498 0.555940312 0.458076987 0.300652567 0.809492708\n [606] 0.474564340 0.607739074 1.858332513 0.885848838 0.751972397\n [611] 0.540138222",
        " 1.031016873 0.258430567 0.634390006 3.081778858\n [616] 1.191122206 0.590110383 0.759730846 0.787633605 0.875880131\n [621] 1.580201213 0.965164092 0.735487052 1.958262477 0.338884676\n [626] 0.381460325 0.735678110 0.641447591 1.331815409 1.352814168\n [631] 1.675828449 0.458262993 0.634507706 2.577410479 0.555852651\n [636] 0.653772004 0.910781897 0.769825047 2.294504402 0.698838498\n [641] 0.540953030 0.064353163 0.731794052 0.602503040 2.901329538\n [646] 0.855294143 0.805573045 0.186730587 0.422248253 0.7623",
        "65375\n [651] 0.691444851 0.495137948 0.399166356 0.102131894 0.639982909\n [656] 0.765303465 0.455073697 1.196788122 0.612037211 1.017133391\n [661] 0.955830425 0.410065038 0.406970228 2.508408424 6.140545121\n [666] 0.808371288 1.017066684 1.231423478 6.534281218 1.944168133\n [671] 0.525546157 0.471378281 0.049515191 0.529132966 0.443118376\n [676] 0.822874905 0.492900795 2.210653316 0.542059870 0.536058880\n [681] 0.498734688 0.474673233 3.038091512 0.480313846 0.506680248\n [686] 0.360399006 3.804096778 5.0220",
        "68014 0.690681467 0.496783535\n [691] 0.332498411 0.366694945 0.392098591 0.649626772 0.496457400\n [696] 6.845020253 0.462486057 0.297517867 0.584526719 0.359391691\n [701] 0.610671746 0.625785313 1.181594573 4.716088766 0.546380576\n [706] 0.674775340 0.790749694 0.321204757 1.935360879 1.806375604\n [711] 0.669158518 0.388534671 0.582052905 1.509700187 1.574552216\n [716] 0.494220226 0.583309289 0.414507132 2.623494258 0.537419522\n [721] 0.603839624 0.115802553 0.691314703 0.642442034 0.270278580\n [726] 0.7139",
        "31774 0.686688606 0.546166158 2.189036714 0.442537657\n [731] 0.483942069 0.545466916 0.482388532 0.577850628 0.923158340\n [736] 0.456876134 0.963328073 0.448291036 0.491881204 0.203443335\n [741] 0.656759813 0.471057194 0.404750325 0.755835774 0.843378415\n [746] 0.974531269 2.481382569 0.392723991 0.550261110 0.459397755\n [751] 0.482387352 2.901091834 0.418482637 4.740502198 1.700276952\n [756] 0.588392892 0.581231051 3.039899559 0.602663281 0.572985589\n [761] 0.579319070 1.964303477 0.834043566 0.378229031 1",
        ".410702305\n [766] 0.522031230 0.387484701 1.780992077 0.392024236 0.580075893\n [771] 0.628344742 0.947423607 0.477074814 0.605585416 0.333856381\n [776] 0.226877644 0.492251877 1.898048509 0.497005824 0.624712234\n [781] 0.465912097 0.734853293 1.141818161 0.686905109 0.604741156\n [786] 0.531147057 2.598129455 0.425265255 0.634801027 5.062423978\n [791] 0.155248581 0.532828492 0.483612974 0.608264830 0.544861555\n [796] 0.481271977 5.919950354 1.201316686 5.929702768 0.826779400\n [801] 0.304669140 0.432315271 0",
        ".420572722 4.368700257 0.064497837\n [806] 0.758219975 1.391163107 1.026686875 0.672694693 0.485752946\n [811] 0.911630530 1.290103035 3.252773790 2.776474873 0.572287929\n [816] 0.731786913 0.559740632 3.622186710 0.572853630 0.632967461\n [821] 0.623040598 0.465526215 0.707535985 0.746199705 0.800395576\n [826] 0.424408717 0.694608237 8.180504272 0.633468597 0.399337200\n [831] 0.084213439 2.416695687 0.776703386 0.520349794 0.524814222\n [836] 1.029629322 0.400621442 0.958630946 0.359661953 0.504950090\n [841] 0",
        ".580575383 0.670290668 0.612944759 0.497487342 0.574886861\n [846] 2.703519864 1.053678828 0.684081893 0.574360460 0.318340167\n [851] 7.650006195 0.517725047 0.566003523 0.538907928 0.074685782\n [856] 0.221231129 0.410061633 0.924110571 0.595586721 1.093406993\n [861] 0.233839506 3.311759074 0.757594819 0.340148273 0.589847767\n [866] 0.715103205 0.599534665 1.163522649 0.568951790 2.105454974\n [871] 4.266986085 0.964767677 0.440836626 1.355792765 0.358690742\n [876] 0.505330424 0.376591682 3.316517420 0.392871",
        "342 0.316698345\n [881] 0.724297858 0.742760259 0.482855429 2.037847135 2.737936622\n [886] 0.685915744 0.506791286 0.707451092 6.208463441 0.661609916\n [891] 2.178560156 0.294904148 0.906970465 0.274492635 0.795868834\n [896] 0.447656212 2.620946867 1.089423336 0.706470354 0.720484685\n [901] 0.342976578 0.534338393 0.765097384 0.238077160 0.763561816\n [906] 0.430846305 1.659819487 0.843978209 0.568524556 0.577734043\n [911] 5.008282047 0.660908889 0.866634791 2.416301484 0.425629606\n [916] 0.780653608 0.702117",
        "582 0.408115660 0.155299615 2.128628796\n [921] 2.047137493 0.452851887 0.583845760 0.489830473 0.973969023\n [926] 0.642823551 0.422017368 0.283504723 0.031551509 0.336723763\n [931] 0.792202926 0.580730299 0.648069949 0.580089581 0.551456057\n [936] 0.508658907 0.762639170 0.589235828 2.043616612 1.251587588\n [941] 2.836032915 0.935619052 0.602615112 0.099529714 2.272862708\n [946] 0.743459008 0.471319696 0.357917918 0.616446543 0.953438688\n [951] 1.449112389 2.759864954 0.548293290 4.184620496 1.549658127\n [9",
        "56] 1.032568750 0.115823504 0.797721690 0.756290396 0.960686872\n [961] 0.019190281 0.532868162 0.659131602 0.559880400 0.277254180\n [966] 0.418948598 0.662936021 3.072152309 0.522878802 0.517580772\n [971] 0.476095930 0.741434245 0.426488336 2.390220669 0.648999626\n [976] 0.429863584 0.708384578 0.476431563 0.479208150 0.769730818\n [981] 0.414937699 0.422966570 0.514844887 0.284511656 0.774026041\n [986] 0.420995095 0.779182118 0.310210685 0.469941998 0.701488087\n [991] 0.459246814 4.117681181 5.028474312 0.4",
        "23610146 0.385398812\n [996] 3.893521696 1.648250022 0.648847622 0.582653726 0.351115432\n",
        "> ",
        "gridExtra::grid.arrange(",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    htx = exp(log.htx(f1, deriv=0)$h)), aes(x = x, y=htx))+",
        "+ ",
        "    geom_line()+geom_point()+ylab(\"hazard function\"),",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    stx = exp(log.Stx(f1, deriv=0)$s)), aes(x = x, y=stx))+",
        "+ ",
        "    geom_line()+geom_point()+ylab(\"estimated s0\"),",
        "+ ",
        "  ggplot(data.frame(x = f1$ax,",
        "+ ",
        "                    f = f1$f), aes(x = x, y=f))+",
        "+ ",
        "    geom_line()+geom_point()+ylab(\"smooth function\"),",
        "+ ",
        "  ggplot(data.frame(x = dat$times,",
        "+ ",
        "                    f = S0(dat$times)), aes(x = x, y=f))+",
        "+ ",
        "    geom_point()+ylab(\"true s0\"), ncol=2)",
        "> ",
        "## optimization",
        "> ",
        "fit <- aft_nl(~s_ncon(st, m=c(4,2), k = 7, trans = trans_linear()), data = dat,",
        "+ ",
        "              censored = dat$c, trace = TRUE)",
        "[1] 284391.3\n[1] 284391.3\n[1] 284392\n[1] 284392\n[1] 284392\n[1] 284391.6\n[1] 284391.6\n[1] 284391.5\n[1] 284391.4\n[1] 284391.7\n[1] 284391.4\n[1] 284392.4\n[1] 284392\n[1] 284392\n[1] 284392\n[1] 284391.6\n[1] 284391.6\n[1] 284391.5\n[1] 284391.4\n[1] 284391.7\n[1] 284391.4\n[1] 284392.4\n[1] 284391.3\n[1] 171830.5\n[1] 105247.7\n[1] 65308.39\n[1] 41076.15\n[1] 26260.19\n[1] 17166.42\n[1] 11571.21\n[1] 8058.692\n[1] 5809.459\n[1] 4380.617\n[1] 3571.563\n[1] 3178.442\n[1] 2992.744\n[1] 2871.075\n[1] 2773.065\n[1] 2687.244\n[1] 2609.049\n[1] ",
        "2536.237\n[1] 2467.296\n[1] 2400.883\n[1] 2335.586\n[1] 2269.785\n[1] 2201.533\n[1] 2128.394\n[1] 2047.197\n[1] 1953.592\n[1] 1841.617\n[1] 1715.969\n[1] 1625.246\n[1] 1559.353\n[1] 1499.59\n[1] 2260.15\n[1] 1375.644\n[1] 4.473911e+33\n[1] 1325.067\n[1] 1288.718\n[1] 1283.012\n[1] 1280.286\n[1] 1539.368\n[1] 1277.872\n[1] 1275.528\n[1] 1271.769\n[1] 1271.229\n[1] 1271.211\n[1] 1271.211\n",
        "> ",
        "fit$iterations",
        "[1] 42\n",
        "> ",
        "fit$coef",
        " [1]  1.7879927 -0.5688303 -0.7701740 -1.0765880 -0.5840063\n [6] -1.0729800 -1.2967899 -1.0070970 -1.6619653 -0.4817514\n",
        "> ",
        "alph <- fit$coefficients[1:3]",
        "> ",
        "alph/alph[1]",
        "[1]  1.0000000 -0.3181391 -0.4307478\n",
        "> ",
        "f1 <- f1$eval(fit$coefficients, deriv = 2)",
        "Errore in store$X1 %*% betat : gli argomenti non sono compatibili\n",
        "> ",
        "source(\"~/Dropbox/dottorato pd/Accelerated_failure_time/code/simulations.R\", echo=TRUE)",
        "\n> rm(list = ls())\n\n> #set.seed(123)\n> ## simulate data ####\n> n <- 1000\n\n> p <- 2\n\n> X <- matrix(runif(n*p), ncol = p)\n\n> params <- rnorm(p)\n\n> theta <- c(lambda1 = 0.1, gamma1 = 3, lambda2=0.1, gamma2=1.6, p=0.8)\n\n> S0 <- function(t, p=0.8, lambda1 = 0.1, gamma1 = 3, lambda2=0.1, gamma2=1.6){\n+   p*exp(-lambda1*t^gamma1) + (1-p)*exp(-lambda2 * t^gamma2)\n+ }\n\n> wrap_rweibull <- function(n, lambda, gamma){\n+   # generate from a weibull using the parametrization in the draft\n+   sc <- lambda^(-1/gamma); sh <",
        "- .... [TRUNCATED] \n\n> pp <- rbinom(n, size = 1, prob = theta[\"p\"])\n\n> rw1 <- apply(X, 1,\n+              FUN = function(xx) wrap_rweibull(1, theta[\"lambda1\"]*exp(- xx%*%params * theta[\"gamma1\"]),\n+                       .... [TRUNCATED] \n\n> rw2 <- apply(X, 1,\n+              FUN = function(xx) wrap_rweibull(1, theta[\"lambda2\"]*exp(- xx%*%params * theta[\"gamma2\"]),\n+                       .... [TRUNCATED] \n\n> times <- rw1*pp + (1-pp)*rw2\n\n> par(mfrow = c(1,2))\n\n> hist(times, breaks = 50)\n\n> dat <- data.frame(",
        "times = times)\n\n> dat$st <- cbind(log(times), X)\n\n> # add censoring ####\n> C <- quantile(times, 0.9)\n\n> dat$c <- as.numeric(dat$times<C)\n\n> dat$st[dat$c==0,1] <- log(C)\n\n> dat$times[dat$c==0] <- C\n\n> hist(dat$times, breaks = 50)\n\n> ## generate basis ####\n> library(devtools)\n\n> load_all()\n\u001B[38;5;232m\u001B[36mℹ\u001B[38;5;232m Loading \u001B[34maftNested\u001B[38;5;232m\u001B[39m\n\n> sm_misi <- aftNested::smooth.construct.misi.smooth.spec(object = s_ncon(st, m=c(4,2), k = 7,\n+                                                       .",
        "... [TRUNCATED] \n\n> beta <- rnorm(ncol(sm_misi$X)-length(sm_misi$xt$si$alpha))\n\n> betat <- c(beta[1], exp(beta[-1]))\n\n> z <- dat[[sm_misi$term]] %*% sm_misi$xt$si$alpha\n\n> X <- sm_misi$xt$basis$evalX(z, deriv = 1)\n\n> ss <- X$X0%*%betat\n\n> ss1 <- X$X1%*% betat\n\n> plot(ss~z)\n\n> plot(ss1~z);abline(h=0, col=\"grey\")\n\n> xx <- seq(-10,10, length.out = 1000)\n\n> matplot(sm_misi$xt$basis$evalX(xx, deriv = 1)$X0, x = xx, type = 'l')\n\n> # define the smooth function\n> alph <- sm_misi$xt$si$alpha\n\n> bet <- rnorm(ncol(sm_",
        "misi$X)-(p+1))\n\n> f1 <- eff_misi(dat$st, basis = sm_misi$xt$basis)\n\n> f1 <- f1$eval(c(alph, bet), deriv = 2)\n\n> ## define likelihood\n> llk <- llk_afc(f1, sm = sm_misi, delta = dat$c, lambda = 1, vpen = 1e4)\n\n> llk(c(alph, bet))\n[1] 2.59402e+37\nattr(,\"gradient\")\n              [,1]\n [1,] 2.783192e+39\n [2,] 7.222140e+38\n [3,] 7.129345e+38\n [4,] 2.841259e+38\n [5,] 3.209429e+38\n [6,] 6.772254e+38\n [7,] 2.506285e+38\n [8,] 3.045541e+38\n [9,] 1.768080e+38\n[10,] 6.892483e+37\nattr(,\"hessian\")\n              [,1]      ",
        "   [,2]         [,3]         [,4]\n [1,] 2.991124e+41 7.762050e+40 7.662397e+40 3.086429e+40\n [2,] 7.762050e+40 2.017141e+40 1.988218e+40 8.011946e+39\n [3,] 7.662397e+40 1.988218e+40 1.966292e+40 7.909646e+39\n [4,] 3.086429e+40 8.011946e+39 7.909646e+39 3.112842e+39\n [5,] 3.485569e+40 9.047999e+39 8.932456e+39 3.516188e+39\n [6,] 7.355131e+40 1.909280e+40 1.884899e+40 7.419556e+39\n [7,] 2.726037e+40 7.076684e+39 6.986384e+39 2.745922e+39\n [8,] 3.304847e+40 8.578663e+39 8.469067e+39 3.336580e+39\n [9,] 1.915895",
        "e+40 4.973038e+39 4.909460e+39 1.936985e+39\n[10,] 7.450599e+39 1.933794e+39 1.909041e+39 7.550555e+38\n              [,5]         [,6]         [,7]         [,8]\n [1,] 3.485569e+40 7.355131e+40 2.726037e+40 3.304847e+40\n [2,] 9.047999e+39 1.909280e+40 7.076684e+39 8.578663e+39\n [3,] 8.932456e+39 1.884899e+40 6.986384e+39 8.469067e+39\n [4,] 3.516188e+39 7.419556e+39 2.745922e+39 3.336580e+39\n [5,] 4.292741e+39 8.380944e+39 3.101723e+39 3.768918e+39\n [6,] 8.380944e+39 1.836197e+40 6.544987e+39 7.952845e+39\n [7,",
        "] 3.101723e+39 6.544987e+39 2.672887e+39 2.943281e+39\n [8,] 3.768918e+39 7.952845e+39 2.943281e+39 3.880960e+39\n [9,] 2.187972e+39 4.616868e+39 1.708658e+39 2.076217e+39\n[10,] 8.528932e+38 1.799701e+39 6.660479e+38 8.093325e+38\n              [,9]        [,10]\n [1,] 1.915895e+40 7.450599e+39\n [2,] 4.973038e+39 1.933794e+39\n [3,] 4.909460e+39 1.909041e+39\n [4,] 1.936985e+39 7.550555e+38\n [5,] 2.187972e+39 8.528932e+38\n [6,] 4.616868e+39 1.799701e+39\n [7,] 1.708658e+39 6.660479e+38\n [8,] 2.076217e+39 8.093325e",
        "+38\n [9,] 1.382121e+39 4.698473e+38\n[10,] 4.698473e+38 2.520794e+38\n\n> ## optimization\n> fit <- aft_nl(~s_ncon(st, m=c(4,2), k = 7, trans = trans_linear()), data = dat,\n+               censored = dat$c, trace = TRUE)\n[1] 1.751205e+26\n[1] 1.751205e+26\n[1] 1.751331e+26\n[1] 1.751237e+26\n[1] 1.751237e+26\n[1] 1.751224e+26\n[1] 1.751225e+26\n[1] 1.751225e+26\n[1] 1.751223e+26\n[1] 1.751225e+26\n[1] 1.751221e+26\n[1] 1.751213e+26\n[1] 1.751331e+26\n[1] 1.751237e+26\n[1] 1.751237e+26\n[1] 1.751224e+26\n[1] 1.751225e+26\n[1] 1.",
        "751225e+26\n[1] 1.751223e+26\n[1] 1.751225e+26\n[1] 1.751221e+26\n[1] 1.751213e+26\n[1] 1.751205e+26\n[1] 8.599946e+25\n[1] 4.221632e+25\n[1] 2.071537e+25\n[1] 1.016094e+25\n[1] 4.98203e+24\n[1] 2.441807e+24\n[1] 1.196331e+24\n[1] 5.859062e+23\n[1] 2.868429e+23\n[1] 1.403789e+23\n[1] 6.867583e+22\n[1] 3.358558e+22\n[1] 1.641919e+22\n[1] 8.024227e+21\n[1] 3.920222e+21\n[1] 1.914596e+21\n[1] 9.34773e+20\n[1] 4.562481e+20\n[1] 2.226207e+20\n[1] 1.085933e+20\n[1] 5.295629e+19\n[1] 2.581742e+19\n[1] 1.258324e+19\n[1] 6.131414e+18\n[1] 2.9869",
        "03e+18\n[1] 1.454714e+18\n[1] 7.083267e+17\n[1] 3.448204e+17\n[1] 1.678258e+17\n[1] 8.166462e+16\n[1] 3.973023e+16\n[1] 1.932512e+16\n[1] 9.398075e+15\n[1] 4.569531e+15\n[1] 2.221368e+15\n[1] 1.079655e+15\n[1] 5.246421e+14\n[1] 2.548908e+14\n[1] 1.238101e+14\n[1] 6.012665e+13\n[1] 2.919346e+13\n[1] 1.417132e+13\n[1] 6.877637e+12\n[1] 3.337119e+12\n[1] 1.618852e+12\n[1] 785136642229\n[1] 380704134195\n[1] 184559637825\n[1] 89453497422\n[1] 43348767918\n[1] 21003227137\n[1] 10175153214\n[1] 4929055962\n[1] 2387729049\n[1] 1156768828\n[1] 5",
        "60537458\n[1] 271728080\n[1] 131806290\n[1] 63994304\n[1] 31111682\n[1] 15153433\n[1] 7399651\n[1] 3626259\n[1] 1786126\n[1] 886442.2\n[1] 445241\n[1] 228291.6\n[1] 121994.9\n[1] NaN\n[1] 115349.4\n[1] NaN\n[1] 109448.1\n[1] NaN\n[1] 104380.4\n[1] NaN\n[1] 100242.1\n[1] NaN\n[1] 96991.78\n[1] NaN\n[1] 94365.92\n[1] NaN\n[1] 92087.26\n[1] NaN\n[1] 90001.9\n[1] 75216.25\n[1] 62158.36\n[1] 51943.09\n[1] 43936.37\n[1] 37653.04\n[1] 32721.88\n[1] 28856.64\n[1] 25832.32\n[1] 23467.52\n[1] 21614.46\n[1] 20155\n[1] 18997.84\n[1] 18073.81\n[1] 17330.59\n[1] ",
        "16728.22\n[1] 16235.93\n[1] 15829.87\n[1] 15491.53\n[1] 15206.51\n[1] 14963.6\n[1] 14754.09\n[1] 14571.17\n[1] 14409.55\n[1] 14265.08\n[1] 14134.48\n[1] 14015.2\n[1] 13905.17\n[1] 13802.78\n[1] 13706.7\n[1] 13615.85\n[1] 13529.36\n[1] 13446.49\n[1] 13366.62\n[1] 13289.22\n[1] 13213.81\n[1] 13139.95\n[1] 13067.23\n[1] 12995.24\n[1] 12923.56\n[1] 12851.72\n[1] 12779.21\n[1] 12705.42\n[1] 12629.63\n[1] 12550.96\n[1] 12468.32\n[1] 12380.34\n[1] 12285.33\n[1] 12181.11\n[1] 12064.98\n[1] 11933.57\n[1] 11782.71\n[1] 11607.42\n[1] 11401.96\n[1] 11160.1\n",
        "[1] 10875.82\n[1] 10544.34\n[1] 10163.77\n[1] 9736.725\n[1] 9271.603\n[1] 8782.547\n[1] 8287.671\n[1] 7805.878\n[1] 7353.357\n[1] NaN\n[1] NaN\n[1] 6195.108\n[1] NaN\n[1] NaN\n[1] 5970.159\n[1] 5129.578\n[1] 4666.48\n[1] NaN\n[1] NaN\n[1] 4521.13\n[1] 4295.36\n[1] Inf\n[1] NaN\n[1] 4028.73\n[1] 3966.699\n[1] 3922.036\n[1] 3889.544\n[1] Inf\n[1] 39047.56\n[1] 3828.232\n[1] 3808.181\n[1] 3793.069\n[1] 3781.073\n[1] 3771.124\n[1] 3762.565\n[1] 3754.98\n[1] 3748.1\n[1] 3741.746\n[1] 3735.795\n[1] 3730.163\n[1] 3724.788\n[1] 3719.627\n[1] 3714.648\n[1] 3",
        "709.824\n[1] 3705.139\n[1] 3700.576\n[1] 3696.125\n[1] 3691.777\n[1] 3687.522\n[1] 3683.356\n[1] 3679.274\n[1] 3675.27\n[1] 3671.341\n[1] 3667.484\n[1] 3663.696\n[1] 3659.974\n[1] 3656.317\n[1] 3652.722\n[1] 3649.188\n[1] 3645.712\n[1] 3642.293\n[1] 3638.533\n[1] 3633.364\n[1] 3625.963\n[1] 3588.454\n[1] 3585.912\n[1] 3583.42\n[1] 3580.968\n[1] 3578.554\n[1] 3576.175\n[1] 3573.83\n[1] 3571.519\n[1] 3569.242\n[1] 3566.998\n[1] 3564.786\n[1] 3562.607\n[1] 3560.459\n[1] 3558.343\n[1] 3556.258\n[1] 3554.203\n[1] 3552.178\n[1] 3550.183\n[1] 3548.216\n",
        "[1] 3546.279\n[1] 3544.37\n[1] 3542.488\n[1] 3540.634\n[1] 3538.751\n[1] 3534.764\n[1] 3515.061\n[1] 3459.773\n[1] 3400.732\n[1] 3316.264\n[1] 3296.986\n[1] 3290.842\n[1] 3290.591\n[1] 3290.587\n[1] 3290.587\n\n> fit$iterations\n[1] 218\n\n> fit$coef\n [1]  1.529768249 -5.276227257 -2.832020953 -1.586597332\n [5] -0.377393814 -0.851085574 -1.111511628 -2.113732677\n [9] -2.704801990 -0.009333187\n\n> alph <- fit$coefficients[1:3]\n\n> alph/alph[1]\n[1]  1.000000 -3.449037 -1.851275\n\n> f1 <- f1$eval(fit$coefficients, deriv = 2)\n\n> lib",
        "rary(ggplot2)\n\n> gridExtra::grid.arrange(\n+   ggplot(data.frame(x = f1$ax,\n+                     htx = exp(log.htx(f1, deriv=0)$h)), aes(x = x, y=htx))+\n+     geom_l .... [TRUNCATED] \n\n> #################### check derivatives ##################\n> library(numDeriv)\n\n> f2 <- f1$eval(c(alph, bet), deriv = 2)\n\n> nd <- jacobian(function(a) f1$eval(c(a, bet), deriv = 1)$f, x = alph)\n\n> nd-f2$store$f1*f2$store$g1\n                 [,1]          [,2]          [,3]\n   [1,]  1.274820e-10  4.731859e-11  3.143263e-12\n  ",
        " [2,] -5.671019e-11  7.771339e-12  1.548273e-11\n   [3,] -1.095515e-10  2.083267e-11 -1.992362e-11\n   [4,]  1.757599e-10  4.334044e-11  2.050005e-11\n   [5,]  9.026380e-11  1.704992e-11 -2.906608e-11\n   [6,]  7.077006e-11  1.103961e-11 -1.630696e-12\n   [7,]  1.717879e-10  1.494076e-10 -7.808865e-12\n   [8,]  1.086775e-11  1.706857e-12 -5.458078e-12\n   [9,]  1.767386e-11  3.896172e-11  2.737099e-11\n  [10,]  1.348432e-10  3.389911e-11  6.918910e-13\n  [11,]  7.723955e-11  8.477152e-11 -4.482725e-11\n  [12,]  4.913",
        "403e-11  3.439560e-11 -6.634693e-13\n  [13,]  1.375611e-10  6.975132e-11  6.856471e-11\n  [14,]  2.852474e-11  3.059242e-11 -1.046985e-11\n  [15,] -2.049205e-11  3.237144e-11  3.882894e-12\n  [16,]  8.257572e-11  7.429524e-11  3.276224e-11\n  [17,]  7.550227e-11  1.041123e-10  4.134471e-13\n  [18,]  2.219203e-11 -3.194189e-11  8.349582e-11\n  [19,]  8.514434e-11  1.238938e-10 -1.262812e-11\n  [20,] -2.381277e-10 -1.297777e-11  1.135954e-10\n  [21,] -1.151292e-10  3.578648e-11 -9.633627e-12\n  [22,] -8.298873e-11 -1.3",
        "48166e-11  5.729284e-11\n  [23,]  7.293011e-11  3.711786e-11 -6.372680e-14\n  [24,]  1.377209e-10  6.226575e-11  5.945910e-12\n  [25,]  7.489120e-11  3.570111e-11  2.900791e-12\n  [26,] -2.079048e-11  3.057421e-11  4.199174e-11\n  [27,]  5.773515e-11  1.156586e-11  2.635225e-11\n  [28,]  4.273915e-12  3.407030e-11  1.891642e-11\n  [29,] -6.855672e-11  2.817746e-11 -3.574430e-11\n  [30,]  8.441070e-11  1.878009e-11  1.223355e-11\n  [31,] -2.003020e-11 -1.757294e-11 -6.671286e-11\n  [32,]  5.786482e-11  3.016321e-11  2",
        ".223732e-11\n  [33,]  2.734701e-11 -1.025180e-12 -1.358025e-11\n  [34,]  4.608935e-11 -2.122746e-13  1.016698e-11\n  [35,]  1.515588e-10  1.150608e-10  1.054623e-11\n  [36,]  1.636380e-10  1.161897e-10 -2.985168e-12\n  [37,]  2.225065e-11  3.078071e-11 -1.624745e-11\n  [38,] -4.396306e-11  9.648282e-12  1.464029e-11\n  [39,] -3.472600e-11  1.543227e-11  7.171597e-12\n  [40,]  2.827711e-10  5.426237e-11 -7.958079e-13\n  [41,] -3.483436e-11  5.086020e-11  1.246891e-11\n  [42,] -7.942091e-11  2.862333e-11 -1.462608e-11\n",
        "  [43,]  1.157829e-11 -2.807971e-11  7.805312e-12\n  [44,] -1.783533e-10  2.189315e-11  3.584066e-11\n  [45,]  8.643042e-11  7.195311e-11 -1.982103e-11\n  [46,] -1.755645e-10  2.339656e-11  5.004441e-11\n  [47,]  8.810730e-12  1.598810e-11  8.525181e-12\n  [48,]  2.276153e-10  4.358514e-11  1.000977e-12\n  [49,]  2.110312e-11  1.141895e-10  3.932499e-11\n  [50,] -3.082334e-11  1.775913e-12  2.231548e-11\n  [51,]  7.917222e-11  1.958034e-11 -1.830802e-11\n  [52,]  8.899548e-12  3.560263e-11 -4.662937e-13\n  [53,]  1.9",
        "30900e-11  4.149303e-11 -2.642220e-12\n  [54,]  1.702816e-10  5.857004e-11 -1.278927e-11\n  [55,]  9.369217e-11 -1.419087e-12  2.679235e-11\n  [56,] -3.580514e-11  1.609957e-11 -1.196598e-11\n  [57,]  1.129852e-10  3.388290e-11 -2.659023e-11\n  [58,] -2.907115e-10  6.649703e-11 -1.012435e-10\n  [59,]  1.508518e-10  9.324719e-11  5.113243e-12\n  [60,]  1.324523e-10  1.294307e-10 -4.450929e-11\n  [61,] -7.035084e-11  4.951595e-12 -1.469180e-11\n  [62,] -2.173550e-11  2.023337e-11  4.208101e-11\n  [63,]  1.882938e-12  5",
        ".215206e-11 -7.622347e-12\n  [64,]  7.054979e-11  3.302469e-11  5.715695e-11\n  [65,]  8.191847e-11  4.172307e-11 -3.340439e-12\n  [66,]  1.860414e-10  2.396350e-11 -2.737544e-11\n  [67,]  7.003109e-11  3.490586e-11  1.612044e-12\n  [68,]  1.802718e-10  8.442136e-11 -4.222400e-12\n  [69,] -6.619061e-11  3.123102e-11  2.147171e-11\n  [70,]  9.126921e-12  1.300116e-11  8.531398e-12\n  [71,]  2.414069e-11  2.850475e-11 -1.250022e-11\n  [72,] -1.625615e-10  9.284129e-12  7.191137e-12\n  [73,] -2.451372e-11 -1.649236e-12 ",
        " 1.630118e-11\n  [74,] -1.370815e-11  1.205325e-11 -1.584244e-11\n  [75,] -1.464029e-11  6.909806e-12  6.549206e-12\n  [76,] -4.314771e-11  9.539036e-12  6.084910e-12\n  [77,]  7.219825e-11  9.175771e-12 -6.765838e-11\n  [78,]  2.130207e-11  5.985878e-11  1.848210e-11\n  [79,]  7.383250e-11  1.478284e-10  6.036949e-11\n  [80,]  4.134648e-11  8.116174e-12 -4.413359e-12\n  [81,]  1.081162e-10  3.317191e-11 -4.992007e-12\n  [82,]  2.459544e-11  6.618761e-12  3.075495e-11\n  [83,]  2.179377e-10  3.077094e-11  3.373657e-1",
        "1\n  [84,] -2.765788e-11  4.630252e-11 -1.735723e-11\n  [85,]  1.189662e-10  8.042189e-11 -4.046763e-12\n  [86,]  1.499423e-11  2.318545e-11  3.628875e-12\n  [87,] -4.891021e-11  4.113154e-11 -5.479261e-11\n  [88,] -6.374989e-11 -9.566770e-11  2.833396e-10\n  [89,]  1.757883e-11  3.852030e-11  9.944046e-12\n  [90,] -3.548806e-11  7.989831e-12  4.220624e-12\n  [91,] -1.634248e-11  3.188916e-11 -1.992362e-11\n  [92,]  4.792611e-12 -3.181150e-12 -9.660273e-12\n  [93,]  1.637126e-10  7.436007e-11  2.072859e-11\n  [94,]  8",
        ".867929e-11  3.000888e-11  8.592238e-12\n  [95,] -7.159429e-11  3.158585e-11  6.930012e-12\n  [96,] -2.453930e-10  8.637002e-11  3.377032e-11\n  [97,] -6.135625e-11  4.321432e-11  3.371925e-11\n  [98,]  4.172662e-11  1.587597e-11  2.500045e-11\n  [99,]  8.717649e-11  2.908829e-11 -3.269562e-11\n [100,]  2.278673e-10  1.334821e-11  1.312843e-10\n [101,]  1.999183e-10  9.575718e-11 -1.801137e-11\n [102,]  8.595080e-11  3.543388e-12  4.519496e-12\n [103,]  1.906741e-10  5.129230e-12  2.888179e-11\n [104,] -7.991474e-11 ",
        " 7.829737e-11 -2.562164e-10\n [105,]  2.583889e-11  5.314682e-11  4.607292e-11\n [106,]  5.822898e-12  8.747225e-12 -9.675039e-12\n [107,]  5.767475e-11 -1.167821e-11  2.287326e-11\n [108,]  2.544382e-10  1.370033e-10  2.174261e-12\n [109,]  6.067147e-11  1.973022e-11  2.376144e-11\n [110,] -1.370992e-11  2.027267e-13 -1.244915e-11\n [111,]  9.099921e-11  2.643530e-11  6.338041e-12\n [112,]  1.635954e-10  2.705480e-11 -1.970779e-11\n [113,]  1.498925e-10  6.676082e-11 -1.930062e-11\n [114,] -1.510152e-10  9.279155e-1",
        "1 -2.791989e-12\n [115,]  2.247447e-11  2.435563e-11  1.711065e-11\n [116,] -8.480328e-12  1.480349e-11  3.031264e-11\n [117,] -2.942357e-11  7.165379e-12  1.294698e-11\n [118,]  2.972023e-10 -1.192380e-13 -1.783995e-11\n [119,]  9.648460e-11  4.973355e-11 -5.946710e-11\n [120,]  3.005596e-11 -7.411627e-12 -9.716672e-12\n [121,]  4.221192e-10 -1.396097e-10  3.382601e-10\n [122,]  1.188063e-10  4.706413e-11  1.954881e-11\n [123,]  3.735110e-10  1.241336e-10  1.392308e-11\n [124,]  1.440235e-10  3.945022e-11  1.682654e",
        "-11\n [125,] -3.360867e-12  2.530376e-11 -7.018386e-12\n [126,]  1.770069e-10  6.533529e-11  3.205924e-11\n [127,]  1.211973e-10  2.763567e-11  3.899903e-11\n [128,]  2.191074e-10  4.315570e-11  1.736644e-11\n [129,]  2.696687e-11  2.305311e-11  1.095790e-11\n [130,]  3.850786e-11  8.707812e-12 -5.830891e-13\n [131,] -1.647216e-11  1.705014e-11  1.942624e-11\n [132,] -3.835510e-11  3.562395e-11  1.011280e-11\n [133,]  1.095941e-10  1.982503e-11 -3.355227e-11\n [134,]  1.226450e-10 -3.692469e-11  3.040412e-11\n [135,] ",
        " 4.275691e-12 -4.568679e-12 -1.980993e-11\n [136,]  3.046097e-11  3.493428e-11 -6.474821e-12\n [137,]  5.557155e-11  1.570122e-11  1.655920e-11\n [138,]  6.094680e-11  1.474021e-10 -2.944311e-13\n [139,]  1.993783e-10  6.519141e-11 -1.140776e-11\n [140,]  1.523759e-11  7.565060e-11 -3.093614e-11\n [141,]  7.547912e-11  1.344352e-11  9.417689e-12\n [142,]  1.549978e-10  1.987654e-11  5.987566e-11\n [143,] -3.457856e-11  7.967227e-11 -3.456346e-12\n [144,]  5.075407e-11  1.937916e-11  1.631267e-11\n [145,] -7.851497e-1",
        "3  3.513323e-11 -3.000267e-12\n [146,]  1.132339e-11  3.716250e-12 -7.022161e-12\n [147,] -3.216414e-10  9.638157e-11 -1.563194e-13\n [148,] -1.653788e-12  9.758860e-12  7.673417e-12\n [149,]  1.040945e-10  9.725387e-12  1.353184e-11\n [150,]  1.036717e-10  1.526468e-11  7.989165e-13\n [151,] -2.614087e-11  6.792789e-11  8.877343e-13\n [152,] -6.608758e-11  5.677325e-11  1.706768e-11\n [153,]  3.769429e-11  5.093259e-11  2.986944e-12\n [154,]  1.466880e-10 -1.198153e-11  2.675193e-11\n [155,] -3.060485e-11  3.246714e",
        "-11 -1.030287e-11\n [156,] -3.659295e-13  5.143885e-11  1.266631e-11\n [157,]  1.474021e-11  6.930367e-11  8.470336e-12\n [158,] -5.785594e-12 -5.144773e-13  9.101164e-12\n [159,]  9.872636e-11  7.830092e-11 -2.922751e-11\n [160,]  2.663825e-11  3.568523e-11 -8.404943e-12\n [161,] -3.115019e-11  2.366685e-11  7.062351e-12\n [162,]  1.040981e-10  9.558399e-11  1.721912e-11\n [163,] -3.899814e-11  3.750955e-11  7.129364e-11\n [164,]  1.064251e-10  2.442757e-11  1.446598e-11\n [165,]  1.739942e-10  4.819389e-11 -1.42517",
        "1e-11\n [166,]  1.074980e-10  3.299228e-11 -2.046363e-11\n [167,] -9.034196e-11  6.339107e-11 -2.642686e-11\n [168,]  2.638512e-11  2.233302e-11  9.217183e-12\n [169,]  1.106173e-10  1.859535e-11 -1.334088e-11\n [170,]  7.324275e-11  5.776712e-12 -2.455702e-12\n [171,]  1.187637e-10  9.191758e-11 -7.000622e-12\n [172,] -1.422507e-11  1.842615e-11  2.038814e-11\n [173,] -1.869083e-11  3.234657e-11 -1.162181e-11\n [174,]  7.895906e-11  2.281020e-11  2.084288e-11\n [175,]  9.492140e-11  3.414424e-11  1.924505e-11\n [176,",
        "]  9.878676e-11 -1.507061e-11 -4.394796e-11\n [177,]  1.718803e-10  2.329026e-11  1.473754e-11\n [178,] -5.669776e-11  7.063150e-11  3.152323e-11\n [179,] -7.695533e-11  6.774492e-11 -6.073098e-11\n [180,] -8.344436e-12  2.201084e-11  2.591816e-12\n [181,]  3.461409e-11  5.087752e-11 -1.126099e-11\n [182,]  3.636735e-11  2.318279e-11 -2.402611e-11\n [183,]  1.003144e-10  2.600231e-11 -1.544032e-11\n [184,]  9.914913e-11  1.008282e-10 -9.567369e-11\n [185,]  1.073381e-10  2.924505e-11  7.313705e-12\n [186,]  3.648495e",
        "-10  1.246381e-10 -1.296296e-10\n [187,] -2.186695e-12  3.374129e-11  2.016343e-11\n [188,] -5.265122e-12  4.876433e-12  1.729816e-11\n [189,]  2.695799e-11  3.295614e-12  1.892619e-11\n [190,] -7.003997e-11  2.126521e-11  6.089707e-11\n [191,] -2.453859e-11  2.087930e-11  1.212319e-11\n [192,]  1.967670e-11  1.933809e-11  5.584866e-12\n [193,]  1.364597e-11  3.467449e-12  9.875434e-12\n [194,] -7.196377e-11  3.622302e-11  5.947243e-12\n [195,]  6.478551e-11  3.409273e-11  9.025847e-11\n [196,]  3.633716e-11 -1.22357",
        "7e-12 -3.586198e-11\n [197,]  1.245333e-10  7.426948e-11  3.640821e-11\n [198,]  4.872902e-11  1.786571e-11 -4.985096e-12\n [199,]  1.139107e-10  7.865886e-11  1.884892e-11\n [200,] -1.458265e-10 -7.321099e-11  4.294165e-11\n [201,]  3.065139e-10  9.293366e-11  2.736744e-11\n [202,]  1.408083e-10  1.848122e-11  3.899991e-12\n [203,]  2.958700e-11 -2.088024e-12 -1.110223e-13\n [204,]  1.201137e-10  5.738965e-11  4.872192e-11\n [205,] -7.928946e-11  1.718092e-11  4.552803e-12\n [206,]  8.812151e-11  5.428635e-11 -1.156",
        "497e-11\n [207,]  1.429257e-10  8.503687e-11  2.746781e-11\n [208,]  1.014300e-11  1.200817e-11  4.837908e-12\n [209,]  1.701856e-10  2.498268e-11 -1.504574e-11\n [210,]  3.892886e-11  7.155165e-12  6.486811e-12\n [211,]  8.927969e-12  4.224621e-11  7.127188e-12\n [212,] -9.062617e-11  2.192824e-11  2.792908e-11\n [213,] -6.227907e-12  3.225020e-11 -2.487877e-11\n [214,]  4.604139e-11  1.212830e-11 -4.031242e-11\n [215,]  1.462119e-11  3.412159e-11  9.461321e-12\n [216,]  3.734968e-11  1.935563e-11  2.747091e-11\n [21",
        "7,] -3.612755e-11  7.216272e-11 -3.415046e-12\n [218,]  4.566303e-11  5.712497e-11  1.471601e-12\n [219,]  1.415579e-10  3.121370e-11  2.481215e-11\n [220,]  4.742517e-11  3.492318e-11 -4.404255e-12\n [221,]  1.363709e-10  6.628209e-11  2.938805e-11\n [222,] -1.687255e-10  1.306599e-11 -4.056844e-11\n [223,]  2.823342e-11 -3.901990e-12  3.550227e-11\n [224,]  3.256062e-11  7.751666e-11  6.688516e-11\n [225,]  4.355343e-10  4.686651e-11  1.528200e-11\n [226,] -3.000089e-11  3.488543e-11 -4.495071e-12\n [227,]  7.25304",
        "3e-11  1.567324e-11 -1.119371e-11\n [228,] -2.210498e-11  2.998624e-11  1.215028e-11\n [229,]  1.258016e-11  6.693579e-11  6.576961e-13\n [230,]  1.570513e-10  1.006422e-10  5.370904e-11\n [231,]  1.785239e-11  5.263479e-11  4.602096e-11\n [232,]  1.497220e-10  7.944756e-12  6.256773e-12\n [233,]  9.723067e-11  7.456524e-11 -1.407546e-11\n [234,]  7.063328e-11  5.893508e-12 -7.108536e-12\n [235,]  2.713563e-10  1.712142e-10 -1.645439e-11\n [236,] -6.509282e-11 -6.142198e-12 -5.643708e-11\n [237,]  7.730883e-11 -1.020",
        "073e-12 -2.019540e-11\n [238,] -8.469669e-12  7.363443e-11  7.088552e-11\n [239,] -5.222489e-12  7.084289e-11 -2.943867e-12\n [240,]  6.338752e-11  3.228040e-11 -8.279377e-12\n [241,]  1.939036e-10  4.434320e-11  4.086953e-12\n [242,] -3.088729e-11 -1.837863e-11 -5.964917e-11\n [243,] -8.126833e-11  2.031220e-11  1.216094e-11\n [244,]  1.012346e-11 -1.036504e-12 -4.607958e-11\n [245,]  9.448442e-12  1.113476e-11 -1.973044e-11\n [246,] -9.874768e-12  2.341505e-11  3.388845e-12\n [247,] -4.099476e-11  1.244178e-10 -1.3",
        "36773e-10\n [248,]  1.286899e-10  1.920064e-11  7.752021e-12\n [249,]  1.756177e-10  3.878220e-11  8.863488e-11\n [250,] -1.239577e-10  8.302337e-11  3.186784e-12\n [251,] -1.460876e-11  1.932454e-11 -8.716583e-12\n [252,]  3.666401e-12  8.228085e-12 -9.611867e-12\n [253,]  1.760512e-10  1.137863e-10  5.004352e-11\n [254,]  2.729337e-10  1.201101e-10 -2.329381e-11\n [255,] -3.850076e-11 -1.610934e-12 -1.158007e-11\n [256,]  2.848211e-11  5.141665e-12  2.278711e-11\n [257,] -3.549161e-12  7.294787e-11  1.064127e-11\n [",
        "258,]  5.578471e-11  4.075318e-11  3.766054e-11\n [259,]  7.367262e-11 -1.854850e-12 -1.049849e-10\n [260,] -2.904343e-12  1.971934e-11 -1.752953e-11\n [261,]  1.306759e-10  1.482725e-11  1.501554e-11\n [262,] -1.302585e-10  2.605294e-11  5.101342e-11\n [263,]  1.848264e-10  8.744117e-11 -6.979306e-12\n [264,]  5.845990e-11  6.337864e-11  3.935252e-11\n [265,]  6.249934e-11  9.428902e-12 -4.382050e-11\n [266,]  2.875900e-11 -6.694478e-12  3.957501e-12\n [267,]  9.127277e-11  4.272138e-11 -5.163869e-12\n [268,]  5.838",
        "174e-11  3.931744e-11  1.024070e-12\n [269,]  5.990586e-11  1.043094e-10 -5.892176e-12\n [270,]  1.489653e-11  3.109557e-11 -1.686651e-11\n [271,]  5.808154e-11  1.754996e-11  1.467226e-11\n [272,] -5.478284e-12  6.419310e-11 -1.815319e-12\n [273,]  1.497398e-10 -5.536505e-11 -7.705125e-11\n [274,] -5.215739e-11  5.167955e-11  1.613421e-11\n [275,]  1.018705e-10  1.534017e-11  1.716938e-11\n [276,]  1.466489e-10  3.404921e-11  2.135403e-11\n [277,]  1.353442e-10  5.594636e-11  3.515943e-11\n [278,]  3.700507e-11  1.5",
        "63194e-13  2.180744e-11\n [279,]  7.273826e-11  5.314860e-12  2.941558e-11\n [280,]  1.229381e-10  1.519176e-10  5.896794e-11\n [281,]  1.078604e-10  1.952882e-11 -1.733702e-11\n [282,]  2.589360e-10  9.910295e-12 -2.249756e-12\n [283,] -7.077716e-11  9.006662e-11  4.814038e-12\n [284,]  5.638512e-11  1.379874e-11  1.589839e-12\n [285,]  1.461586e-11  1.153087e-10  7.746337e-11\n [286,]  1.216858e-10 -3.276224e-11 -1.229417e-11\n [287,] -6.901146e-12  2.749001e-11 -6.331380e-12\n [288,]  3.171241e-11  1.470069e-11 -7",
        ".788437e-12\n [289,]  1.072209e-10  5.009593e-11  4.375167e-12\n [290,]  1.895337e-10 -7.926015e-11  1.439329e-10\n [291,] -5.138445e-12  5.701661e-12 -1.152589e-11\n [292,]  1.151292e-10  3.693224e-11 -2.117462e-11\n [293,]  5.487344e-11  1.518163e-11  7.633361e-11\n [294,] -5.585576e-11  2.577805e-11 -7.350565e-12\n [295,] -4.115996e-11 -2.838618e-12 -1.414346e-11\n [296,] -5.795719e-11  6.393663e-12 -7.642775e-12\n [297,]  8.446577e-11  2.456213e-11  3.353851e-11\n [298,] -2.225242e-11  1.764766e-11  7.327194e-13\n",
        " [299,]  9.347900e-11  4.323386e-11 -1.741007e-11\n [300,] -4.263079e-11  2.865663e-11 -7.176704e-12\n [301,] -2.823768e-10  6.778755e-11 -4.363798e-11\n [302,]  1.160565e-10  5.769607e-11  6.528413e-12\n [303,] -3.911538e-11  6.420420e-12  1.544764e-11\n [304,]  8.313528e-11  5.576983e-12 -1.655298e-11\n [305,] -1.816147e-11  1.273825e-11 -3.359535e-12\n [306,] -1.135056e-10  9.062795e-11  2.268674e-11\n [307,]  2.410161e-11  1.851195e-10  8.188827e-11\n [308,]  8.201795e-11  2.186196e-11  5.500489e-12\n [309,]  4.0",
        "50271e-11 -3.886780e-12 -5.449863e-12\n [310,] -7.027268e-12  5.896172e-12  9.669598e-12\n [311,] -4.699707e-11  9.747647e-12  1.098144e-11\n [312,]  5.718803e-11  2.907541e-11 -1.505751e-11\n [313,]  4.248335e-11  2.766765e-11  3.954170e-12\n [314,]  1.631371e-10  5.633272e-11  1.603828e-12\n [315,]  7.523582e-11  3.904299e-11  4.408029e-12\n [316,]  4.975576e-12  4.465939e-11  7.995382e-12\n [317,] -6.966872e-11  1.753686e-11  3.224088e-13\n [318,] -2.528111e-11 -1.458407e-11 -8.721912e-13\n [319,] -9.716317e-11  1",
        ".487488e-11  1.383782e-12\n [320,]  2.531344e-10  3.119371e-11  4.245493e-12\n [321,] -3.820944e-12  3.046807e-11  9.439116e-13\n [322,]  1.115552e-11  8.379519e-12 -6.926681e-12\n [323,] -3.545342e-11  5.777268e-12  1.871392e-12\n [324,] -1.010925e-11  8.766765e-12  1.978995e-11\n [325,] -4.980905e-12  2.762013e-11  7.795542e-12\n [326,]  3.707257e-12  1.575318e-11  6.608325e-13\n [327,]  8.574119e-11  2.853096e-11  2.369660e-12\n [328,] -8.031975e-11  2.414069e-11 -7.271517e-12\n [329,]  1.292051e-10  3.967848e-11 ",
        " 2.758060e-11\n [330,] -7.820589e-11  9.617018e-11  3.438583e-12\n [331,]  1.701927e-10  6.202683e-11 -1.112666e-12\n [332,]  6.067324e-11  1.867484e-11 -7.928769e-12\n [333,]  2.190532e-10  6.968914e-11 -2.076561e-12\n [ raggiunto getOption(\"max.print\") -- omesse 667 righe ]\n\n> nd <- jacobian(function(b) f1$eval(c(alph, b), deriv = 1)$f, x = bet)\n\n> max(abs(nd-f2$store$fb))\n[1] 1.395106e-08\n\n> ## ltx derivatives\n> ltx <- log.htx(f2, deriv = 2)\n\n> nd <- jacobian(function(a) sum(log.htx(f1, param=c(a,bet), deriv=",
        "0)$h), x = alph)\n\n> ltx$dhda-nd\n              [,1]          [,2]          [,3]\n[1,] -5.056063e-08 -3.341302e-08 -1.663466e-09\n\n> nd <- jacobian(function(b) sum(log.htx(f1, param=c(alph,b), deriv=0)$h), x = bet)\n\n> ltx$dhdb-nd\n              [,1]          [,2]         [,3]          [,4]\n[1,] -5.864725e-09 -4.878868e-08 2.058528e-09 -8.229374e-08\n             [,5]         [,6]         [,7]\n[1,] 2.660338e-07 8.513801e-09 1.249586e-08\n\n> nd <- hessian(function(p) sum(log.htx(f1, param=c(p,bet), deriv=0)$h), x = ",
        "alph)\n\n> ltx$dhab[1:3,1:3]-nd\n           [,1]         [,2]          [,3]\n[1,] 0.02115400 0.0347489040  1.285783e-02\n[2,] 0.03474890 0.0005443512  1.362018e-03\n[3,] 0.01285783 0.0013620183 -8.050152e-05\n\n> nd <- hessian(function(b) sum(log.htx(f1, param=c(alph,b), deriv=0)$h), x = bet)\n\n> diag(ltx$dhab[-(1:3),-(1:3)]-nd)\n[1] -7.474679e-10 -2.159438e-07 -1.411991e-09 -1.347317e-07\n[5] -1.305438e-07 -5.144166e-09 -8.672330e-09\n\n> max(abs(ltx$dhab[-(1:3),-(1:3)]-nd))\n[1] 2.266331e-07\n\n> nd <- hessian(function(p",
        ") sum(log.htx(f1, param=p, deriv=0)$h), x = c(alph, bet))\n\n> ltx$dhab[1:3, -(1:3)]-nd[1:3, -(1:3)]\n             [,1]         [,2]          [,3]          [,4]\n[1,] 3.141144e-05 3.154003e-05 -6.333201e-05 -2.266470e-05\n[2,] 8.326591e-07 9.702613e-07 -4.455685e-06 -1.798293e-06\n[3,] 7.176463e-07 1.064333e-06 -9.616335e-07 -2.333684e-07\n              [,5]          [,6]          [,7]\n[1,] -2.901371e-05 -2.790098e-05 -2.016268e-05\n[2,] -1.154753e-06 -1.061948e-06 -1.472613e-06\n[3,] -2.109077e-07 -3.226279e-07 -2.",
        "541762e-07\n\n> ## stx derivatives\n> ltx <- log.Stx(f2, deriv = 2, param = c(alph, bet))\n\n> nd <- jacobian(function(a) sum(log.Stx(f1, param=c(a,bet), deriv=0)$s), x = alph)\n\n> ltx$dhda/nd\n     [,1] [,2] [,3]\n[1,]    1    1    1\n\n> nd <- jacobian(function(b) sum(log.Stx(f1, param=c(alph,b), deriv=0)$s), x = bet)\n\n> ltx$dhdb/nd\n     [,1] [,2] [,3] [,4] [,5] [,6] [,7]\n[1,]    1    1    1    1    1    1    1\n\n> nd <- hessian(function(p) sum(log.Stx(f1, param=c(p,bet), deriv=0)$s), x = alph)\n\n> ltx$dhab[1:3,1:3]-",
        "nd\n              [,1]          [,2]          [,3]\n[1,] -2.035725e+25 -1.820916e+25 -8.517810e+23\n[2,] -1.820916e+25 -3.644005e+15 -3.382786e+15\n[3,] -8.517810e+23 -3.382786e+15  1.166719e+11\n\n> nd <- hessian(function(b) sum(log.Stx(f1, param=c(alph,b), deriv=0)$s), x = bet)\n\n> ltx$dhab[-(1:3),-(1:3)]-nd\n              [,1]          [,2]          [,3]          [,4]\n[1,] -1.109508e+14 -1.039918e+15 -2.375094e+18 -6.020940e+14\n[2,] -1.039918e+15  1.852119e+14 -3.180560e+17 -8.249022e+11\n[3,] -2.375094e+18 -3.18",
        "0560e+17 -1.547751e+17 -2.105368e+17\n[4,] -6.020943e+14 -8.249022e+11 -2.105368e+17 -1.412725e+14\n[5,] -6.421717e+14 -1.624571e+13 -2.618308e+17 -1.972276e+13\n[6,] -9.485127e+14 -8.732205e+11 -2.303183e+17 -5.033165e+11\n[7,] -4.434684e+14 -1.142461e+12 -1.018566e+17 -3.757425e+11\n              [,5]          [,6]          [,7]\n[1,] -6.421717e+14 -9.485127e+14 -4.434684e+14\n[2,] -1.624625e+13 -8.732205e+11 -1.142461e+12\n[3,] -2.618308e+17 -2.303183e+17 -1.018566e+17\n[4,] -1.972276e+13 -5.031823e+11 -3.758096e",
        "+11\n[5,]  1.843147e+15  2.531078e+12 -1.418413e+12\n[6,]  2.530809e+12  5.655667e+12  7.133672e+10\n[7,] -1.418547e+12  7.140383e+10  1.493072e+12\n\n> nd <- hessian(function(p) sum(log.Stx(f1, param=p, deriv=0)$s), x = c(alph, bet))\n\n> ltx$dhab[1:3, -(1:3)]-nd[1:3, -(1:3)]\n              [,1]          [,2]          [,3]          [,4]\n[1,] -2.875931e+25 -1.810750e+25 -1.118906e+26 -1.327334e+25\n[2,] -7.224213e+17 -6.697990e+16 -1.127286e+19 -4.417136e+16\n[3,] -7.541697e+13 -3.677247e+12 -2.123686e+16  4.901313e+",
        "12\n              [,5]          [,6]          [,7]\n[1,] -1.668490e+25 -1.096483e+25 -4.515368e+24\n[2,] -5.214525e+16 -4.848200e+16 -2.053657e+16\n[3,]  8.940864e+12  8.330391e+11  4.264349e+10\n",
        "Ci sono stati 47 avvertimenti (utilizza warnings() per visualizzarli)\n",
        "> ",
        "source(\"~/Dropbox/dottorato pd/Accelerated_failure_time/code/simulations.R\", echo=TRUE)",
        "\n> rm(list = ls())\n\n> #set.seed(123)\n> ## simulate data ####\n> n <- 1000\n\n> p <- 2\n\n> X <- matrix(runif(n*p), ncol = p)\n\n> params <- rnorm(p)\n\n> theta <- c(lambda1 = 0.1, gamma1 = 3, lambda2=0.1, gamma2=1.6, p=0.8)\n\n> S0 <- function(t, p=0.8, lambda1 = 0.1, gamma1 = 3, lambda2=0.1, gamma2=1.6){\n+   p*exp(-lambda1*t^gamma1) + (1-p)*exp(-lambda2 * t^gamma2)\n+ }\n\n> wrap_rweibull <- function(n, lambda, gamma){\n+   # generate from a weibull using the parametrization in the draft\n+   sc <- lambda^(-1/gamma); sh <",
        "- .... [TRUNCATED] \n\n> pp <- rbinom(n, size = 1, prob = theta[\"p\"])\n\n> rw1 <- apply(X, 1,\n+              FUN = function(xx) wrap_rweibull(1, theta[\"lambda1\"]*exp(- xx%*%params * theta[\"gamma1\"]),\n+                       .... [TRUNCATED] \n\n> rw2 <- apply(X, 1,\n+              FUN = function(xx) wrap_rweibull(1, theta[\"lambda2\"]*exp(- xx%*%params * theta[\"gamma2\"]),\n+                       .... [TRUNCATED] \n\n> times <- rw1*pp + (1-pp)*rw2\n\n> par(mfrow = c(1,2))\n\n> hist(times, breaks = 50)\n\n> dat <- data.frame(",
        "times = times)\n\n> dat$st <- cbind(log(times), X)\n\n> # add censoring ####\n> C <- quantile(times, 0.9)\n\n> dat$c <- as.numeric(dat$times<C)\n\n> dat$st[dat$c==0,1] <- log(C)\n\n> dat$times[dat$c==0] <- C\n\n> hist(dat$times, breaks = 50)\n\n> ## generate basis ####\n> library(devtools)\n\n> load_all()\n\u001B[38;5;232m\u001B[36mℹ\u001B[38;5;232m Loading \u001B[34maftNested\u001B[38;5;232m\u001B[39m\n\n> sm_misi <- aftNested::smooth.construct.misi.smooth.spec(object = s_ncon(st, m=c(4,2), k = 7,\n+                                                       .",
        "... [TRUNCATED] \n\n> beta <- rnorm(ncol(sm_misi$X)-length(sm_misi$xt$si$alpha))\n\n> betat <- c(beta[1], exp(beta[-1]))\n\n> z <- dat[[sm_misi$term]] %*% sm_misi$xt$si$alpha\n\n> X <- sm_misi$xt$basis$evalX(z, deriv = 1)\n\n> ss <- X$X0%*%betat\n\n> ss1 <- X$X1%*% betat\n\n> plot(ss~z)\n\n> plot(ss1~z);abline(h=0, col=\"grey\")\n\n> xx <- seq(-10,10, length.out = 1000)\n\n> matplot(sm_misi$xt$basis$evalX(xx, deriv = 1)$X0, x = xx, type = 'l')\n\n> # define the smooth function\n> alph <- sm_misi$xt$si$alpha\n\n> bet <- rnorm(ncol(sm_",
        "misi$X)-(p+1))\n\n> f1 <- eff_misi(dat$st, basis = sm_misi$xt$basis)\n\n> f1 <- f1$eval(c(alph, bet), deriv = 2)\n\n> ## define likelihood\n> llk <- llk_afc(f1, sm = sm_misi, delta = dat$c, lambda = 1, vpen = 1e4)\n\n> llk(c(alph, bet))\n[1] 1.560292e+29\nattr(,\"gradient\")\n              [,1]\n [1,] 4.029948e+30\n [2,] 3.055510e+30\n [3,] 3.169076e+30\n [4,] 1.837644e+30\n [5,] 1.658536e+30\n [6,] 3.884625e+30\n [7,] 4.501599e+29\n [8,] 1.103944e+30\n [9,] 2.109416e+30\n[10,] 8.098078e+29\nattr(,\"hessian\")\n              [,1]     ",
        "    [,2]         [,3]         [,4]\n [1,] 1.041802e+32 7.898460e+31 8.192498e+31 4.824072e+31\n [2,] 7.898460e+31 5.994107e+31 6.211762e+31 3.659018e+31\n [3,] 8.192498e+31 6.211762e+31 6.442563e+31 3.793737e+31\n [4,] 4.824072e+31 3.659018e+31 3.793737e+31 2.164645e+31\n [5,] 4.352379e+31 3.301216e+31 3.422785e+31 1.953659e+31\n [6,] 1.019403e+32 7.732019e+31 8.016756e+31 4.575863e+31\n [7,] 1.183363e+31 8.975994e+30 9.306211e+30 5.302714e+30\n [8,] 2.893501e+31 2.194616e+31 2.275491e+31 1.300366e+31\n [9,] 5.51907",
        "2e+31 4.185843e+31 4.340256e+31 2.484696e+31\n[10,] 2.112293e+31 1.601916e+31 1.661115e+31 9.538492e+30\n              [,5]         [,6]         [,7]         [,8]\n [1,] 4.352379e+31 1.019403e+32 1.183363e+31 2.893501e+31\n [2,] 3.301216e+31 7.732019e+31 8.975994e+30 2.194616e+31\n [3,] 3.422785e+31 8.016756e+31 9.306211e+30 2.275491e+31\n [4,] 1.953659e+31 4.575863e+31 5.302714e+30 1.300366e+31\n [5,] 1.929091e+31 4.129859e+31 4.785862e+30 1.173621e+31\n [6,] 4.129859e+31 1.006142e+32 1.120945e+31 2.748858e+31\n [7",
        ",] 4.785862e+30 1.120945e+31 1.749163e+30 3.185493e+30\n [8,] 1.173621e+31 2.748858e+31 3.185493e+30 8.915642e+30\n [9,] 2.242516e+31 5.252426e+31 6.086723e+30 1.492635e+31\n[10,] 8.608796e+30 2.016354e+31 2.336624e+30 5.730090e+30\n              [,9]        [,10]\n [1,] 5.519072e+31 2.112293e+31\n [2,] 4.185843e+31 1.601916e+31\n [3,] 4.340256e+31 1.661115e+31\n [4,] 2.484696e+31 9.538492e+30\n [5,] 2.242516e+31 8.608796e+30\n [6,] 5.252426e+31 2.016354e+31\n [7,] 6.086723e+30 2.336624e+30\n [8,] 1.492635e+31 5.730090",
        "e+30\n [9,] 3.063028e+31 1.094894e+31\n[10,] 1.094894e+31 5.013043e+30\n\n> ## optimization\n> fit <- aft_nl(~s_ncon(st, m=c(4,2), k = 7, trans = trans_linear()), data = dat,\n+               censored = dat$c, trace = TRUE)\n[1] 2.265492e+27\n[1] 2.265492e+27\n[1] 2.265578e+27\n[1] 2.265557e+27\n[1] 2.26556e+27\n[1] 2.265519e+27\n[1] 2.265519e+27\n[1] 2.265519e+27\n[1] 2.265518e+27\n[1] 2.26552e+27\n[1] 2.265516e+27\n[1] 2.265504e+27\n[1] 2.265578e+27\n[1] 2.265557e+27\n[1] 2.26556e+27\n[1] 2.265519e+27\n[1] 2.265519e+27\n[1] 2.26",
        "5519e+27\n[1] 2.265518e+27\n[1] 2.26552e+27\n[1] 2.265516e+27\n[1] 2.265504e+27\n[1] 2.265492e+27\n[1] 1.384287e+27\n[1] 8.458523e+26\n[1] 5.168528e+26\n[1] 3.158217e+26\n[1] 1.92983e+26\n[1] 1.179226e+26\n[1] 7.205673e+25\n[1] 4.403022e+25\n[1] 2.690449e+25\n[1] 1.643976e+25\n[1] 1.004527e+25\n[1] 6.13793e+24\n[1] 3.750384e+24\n[1] 2.29151e+24\n[1] 1.4001e+24\n[1] 8.554339e+23\n[1] 5.226401e+23\n[1] 3.19306e+23\n[1] 1.950734e+23\n[1] 1.191722e+23\n[1] 7.280087e+22\n[1] 4.44715e+22\n[1] 2.716499e+22\n[1] 1.659277e+22\n[1] 1.013464e+22\n[",
        "1] 6.189814e+21\n[1] 3.78029e+21\n[1] 2.308607e+21\n[1] 1.409779e+21\n[1] 8.608502e+20\n[1] 5.25628e+20\n[1] 3.209244e+20\n[1] 1.959293e+20\n[1] 1.196101e+20\n[1] 7.301408e+19\n[1] 4.45672e+19\n[1] 2.720151e+19\n[1] 1.660118e+19\n[1] 1.0131e+19\n[1] 6.18205e+18\n[1] 3.772061e+18\n[1] 2.301391e+18\n[1] 1.404e+18\n[1] 8.564621e+17\n[1] 5.224122e+17\n[1] 3.186266e+17\n[1] 1.943185e+17\n[1] 1.184976e+17\n[1] 7.225504e+16\n[1] 4.405445e+16\n[1] 2.685806e+16\n[1] 1.63728e+16\n[1] 9.980103e+15\n[1] 6.08291e+15\n[1] 3.707257e+15\n[1] 2.259226e+",
        "15\n[1] 1.376681e+15\n[1] 8.388321e+14\n[1] 5.110765e+14\n[1] 3.113634e+14\n[1] 1.896801e+14\n[1] 1.155449e+14\n[1] 7.038128e+13\n[1] 4.286899e+13\n[1] 2.611032e+13\n[1] 1.590258e+13\n[1] 9.6853e+12\n[1] 5.898655e+12\n[1] 3.592462e+12\n[1] 2.187943e+12\n[1] 1.332571e+12\n[1] 811636790815\n[1] 494376374942\n[1] 301152504462\n[1] 183466707249\n[1] 111784195959\n[1] 68118883403\n[1] 41517552991\n[1] 25309757613\n[1] 15433098454\n[1] 9413396445\n[1] 5743669483\n[1] 3505961658\n[1] 2141054215\n[1] 1308226523\n[1] 799851547\n[1] 489382333\n[1] ",
        "299672232\n[1] 183677987\n[1] 112704202\n[1] 69240973\n[1] 42599292\n[1] 26250838\n[1] 16206200\n[1] 10025907\n[1] 6217146\n[1] 3865630\n[1] 2410848\n[1] 1508793\n[1] 948062.5\n[1] 598560\n[1] 380089.2\n[1] 243123.4\n[1] 157011.4\n[1] 102738.9\n[1] 68478.94\n[1] 46883.69\n[1] 33369.12\n[1] 24956.16\n[1] 19785.44\n[1] 16678.1\n[1] 14852.52\n[1] 13752.58\n[1] 13010.58\n[1] 12429.86\n[1] 11888.35\n[1] 11265.98\n[1] 10424.47\n[1] 9430.885\n[1] 8297.984\n[1] 7065.388\n[1] 5785.028\n[1] 4512.344\n[1] 3403.757\n[1] 2687.2\n[1] 2239.027\n[1] 1973.371\n[1",
        "] Inf\n[1] Inf\n[1] NaN\n[1] 1806.734\n[1] NaN\n[1] 1760.84\n[1] 1623.004\n[1] 1556.164\n[1] 1519.252\n[1] 1505.235\n[1] 1499.058\n[1] 1495.807\n[1] 1493.958\n[1] 1492.927\n[1] 1492.391\n[1] 1492.136\n[1] 1492.024\n[1] 1491.979\n[1] 1491.962\n[1] 1491.955\n[1] 1491.953\n[1] 1491.952\n[1] 1491.952\n[1] 1491.952\n[1] 1491.952\n\n> fit$iterations\n[1] 148\n\n> fit$coef\n [1]   1.65097870  -0.65820698  -1.45259845  -1.97191768\n [5]   0.23480204  -0.09702095  -0.58897266  -1.38627278\n [9]  -2.15338433 -13.45106643\n\n> alph <- fit$coefficients",
        "[1:3]\n\n> alph/alph[1]\n[1]  1.0000000 -0.3986768 -0.8798408\n\n> f1 <- f1$eval(fit$coefficients, deriv = 2)\n\n> library(ggplot2)\n\n> gridExtra::grid.arrange(\n+   ggplot(data.frame(x = f1$ax,\n+                     htx = exp(log.htx(f1, deriv=0)$h)), aes(x = x, y=htx))+\n+     geom_l .... [TRUNCATED] \n\n> #################### check derivatives ##################\n> library(numDeriv)\n\n> f2 <- f1$eval(c(alph, bet), deriv = 2)\n\n> nd <- jacobian(function(a) f1$eval(c(a, bet), deriv = 1)$f, x = alph)\n\n> nd-f2$store$f1*f2$",
        "store$g1\n                 [,1]          [,2]          [,3]\n   [1,]  1.835190e-10 -8.002399e-11  1.777467e-11\n   [2,]  6.346568e-11  3.429079e-11  1.900435e-11\n   [3,]  1.614708e-10 -9.668444e-11  6.404388e-11\n   [4,] -8.391332e-11 -1.261919e-10  6.031997e-11\n   [5,]  4.404921e-11  6.587941e-11  6.831335e-11\n   [6,] -1.540101e-12 -2.909273e-11  9.268142e-13\n   [7,]  3.762501e-11  7.925660e-12  3.267475e-11\n   [8,] -1.678094e-11 -4.679324e-11 -1.197209e-12\n   [9,] -2.195422e-11  1.411882e-11  2.083755e-11\n  [",
        "10,] -2.259526e-11  1.561884e-11 -2.028817e-11\n  [11,] -2.266543e-11  5.106504e-11  3.736500e-11\n  [12,]  6.313172e-12  3.563660e-11 -6.923351e-12\n  [13,]  1.618083e-11 -3.990008e-11  4.917400e-12\n  [14,]  1.123546e-13 -4.699485e-11  1.390266e-11\n  [15,]  8.168932e-11 -1.120997e-10 -9.647705e-11\n  [16,]  5.510659e-11  4.765521e-12  1.638512e-11\n  [17,] -2.180855e-11  9.149570e-11  3.564704e-11\n  [18,]  3.123279e-12 -3.969602e-11  3.515144e-11\n  [19,]  6.155076e-13 -4.922374e-11  5.995648e-11\n  [20,] -1.4724",
        "00e-11  2.860112e-11  2.709655e-11\n  [21,]  3.564082e-11  2.271072e-12  4.435208e-11\n  [22,]  8.812506e-12 -7.569323e-11 -2.799050e-11\n  [23,] -6.961898e-11  3.356160e-11  6.300516e-13\n  [24,] -5.325518e-12  5.731171e-11  4.158895e-11\n  [25,]  4.151812e-11 -8.719248e-11  4.483791e-11\n  [26,] -5.327472e-11 -1.728249e-10  2.050057e-11\n  [27,] -1.278977e-13 -2.791456e-11  1.214140e-11\n  [28,]  7.711165e-12 -3.820055e-12  1.798828e-11\n  [29,] -8.263168e-11 -7.498357e-11 -1.253220e-11\n  [30,] -3.468916e-12  2.58",
        "7264e-12 -5.620115e-12\n  [31,] -1.218442e-11  5.550893e-12  6.965262e-14\n  [32,] -6.504797e-12 -1.407852e-11 -8.853723e-12\n  [33,]  2.008704e-11  4.950640e-11  6.023981e-11\n  [34,] -2.082068e-11  1.034759e-10  7.827072e-11\n  [35,] -1.153955e-11 -7.818102e-11  6.585310e-11\n  [36,]  1.199485e-12 -1.851319e-11  1.634204e-11\n  [37,] -1.152056e-11 -6.450618e-11  3.346390e-11\n  [38,] -1.420863e-11  5.345457e-11  1.221689e-11\n  [39,]  8.141487e-12  2.614708e-11  3.564571e-11\n  [40,]  8.214762e-12  9.918932e-11  2.",
        "849054e-11\n  [41,]  3.712586e-12 -6.195666e-11 -4.289813e-11\n  [42,]  1.819185e-10 -1.338067e-10  6.921619e-11\n  [43,]  4.609202e-11 -4.626020e-11  3.109957e-11\n  [44,] -7.620793e-12 -2.510703e-11  1.747713e-12\n  [45,] -1.607958e-11 -6.535261e-11  3.376410e-11\n  [46,] -9.004442e-11  1.916831e-10 -1.318678e-11\n  [47,] -1.465725e-10  2.727134e-10  1.335865e-11\n  [48,]  3.598144e-11  1.191403e-11  6.101786e-12\n  [49,] -6.047607e-12  3.410872e-11  5.142020e-11\n  [50,]  1.594458e-11  2.470557e-11 -2.611245e-13\n ",
        " [51,] -1.512290e-11  2.127987e-11  1.852207e-11\n  [52,] -2.496492e-11  1.566924e-11  6.596279e-12\n  [53,] -1.427969e-11  5.100674e-11 -2.702993e-11\n  [54,]  6.924723e-11 -5.378720e-11  2.402556e-11\n  [55,]  2.004441e-11 -4.265499e-11 -9.599876e-12\n  [56,]  1.387601e-10 -3.304601e-11 -5.223111e-11\n  [57,]  6.172840e-14 -4.161438e-11 -7.548129e-12\n  [58,]  3.508305e-12 -2.767386e-11  2.451994e-11\n  [59,] -9.591439e-12  5.160361e-11  1.744072e-11\n  [60,] -8.064660e-13 -5.755307e-11  4.319300e-11\n  [61,] -1.54",
        "0066e-10 -3.115357e-10  6.497913e-11\n  [62,] -4.288681e-12 -2.610268e-11  9.400658e-11\n  [63,]  1.534772e-11  8.595524e-11  8.176571e-12\n  [64,]  4.050094e-13 -7.700862e-11  1.306590e-11\n  [65,]  5.156764e-12 -3.249223e-11  2.548894e-11\n  [66,]  5.293543e-12 -1.058198e-10  2.038592e-11\n  [67,] -2.447820e-11 -1.401790e-11  9.708678e-12\n  [68,] -1.322764e-11 -8.702816e-11 -7.019786e-13\n  [69,] -8.170353e-12 -7.751666e-11  6.768364e-11\n  [70,]  6.437073e-11 -1.507416e-10  1.149436e-11\n  [71,] -1.819167e-11 -9.",
        "575007e-12  7.947865e-12\n  [72,]  7.695844e-12 -2.152817e-11  2.863265e-12\n  [73,]  6.216361e-12 -2.396927e-11  1.142531e-11\n  [74,]  1.019695e-11 -5.948975e-11 -8.062884e-12\n  [75,]  8.183676e-12 -6.408563e-11 -1.364375e-11\n  [76,] -8.728129e-12  3.830558e-11  2.241940e-11\n  [77,] -6.776801e-13  5.955661e-11  1.805045e-11\n  [78,] -2.105560e-11 -1.728218e-11  1.897482e-11\n  [79,]  3.099743e-13  4.215184e-11  1.063061e-11\n  [80,] -1.229017e-10 -6.353766e-10  1.889138e-10\n  [81,]  2.377698e-11 -1.520638e-11  ",
        "1.864597e-11\n  [82,]  2.359446e-11 -8.359535e-12 -8.884671e-12\n  [83,]  1.153797e-10  6.923750e-11  1.141309e-12\n  [84,]  7.904788e-11  1.488940e-10 -4.950484e-11\n  [85,] -4.511946e-13  5.907452e-11  2.257883e-11\n  [86,]  8.043344e-11  6.938095e-11  1.045559e-10\n  [87,]  4.691358e-12  4.312994e-12  1.377654e-11\n  [88,]  1.049356e-10  2.038636e-11  1.056346e-10\n  [89,] -1.015454e-11  1.814637e-11  2.748890e-11\n  [90,]  1.917222e-11 -3.074296e-11  2.960654e-11\n  [91,] -1.943556e-11  4.000800e-12 -1.318587e-11",
        "\n  [92,]  3.608669e-12  4.728207e-11  8.024248e-12\n  [93,]  4.821782e-12  8.478107e-12  1.682210e-12\n  [94,]  3.094947e-11 -3.086242e-11  7.542322e-11\n  [95,]  9.601919e-11  5.702283e-11  8.035173e-11\n  [96,]  1.834088e-11  1.316769e-11 -6.286527e-12\n  [97,] -2.369926e-11 -2.794165e-11  5.977496e-11\n  [98,]  1.033751e-11  2.247456e-10  2.674883e-11\n  [99,]  4.899192e-12  7.878143e-13  2.040035e-11\n [100,]  2.695011e-11 -1.463274e-11 -9.453327e-12\n [101,]  2.178790e-11  7.271883e-11  4.666845e-11\n [102,]  9.",
        "319656e-12  2.651657e-11  7.608225e-11\n [103,] -1.593303e-11  2.673861e-11  2.655343e-11\n [104,] -2.571277e-12  2.942119e-11  5.839773e-11\n [105,]  2.611511e-11  7.923440e-12  2.240874e-12\n [106,]  9.556800e-13 -4.361667e-11  1.482103e-11\n [107,]  1.799005e-10  3.858069e-11  1.119806e-10\n [108,] -2.600742e-11 -1.702802e-10  5.509371e-11\n [109,]  5.406875e-11  2.518075e-11  7.906564e-12\n [110,]  1.642242e-11  8.125500e-12  4.240697e-11\n [111,] -8.563372e-12 -3.967715e-12  2.490630e-11\n [112,] -9.201528e-12 -",
        "1.414158e-11  8.060441e-12\n [113,] -2.393263e-11  2.346390e-11 -3.320366e-11\n [114,]  3.653594e-11 -1.152234e-11 -2.552358e-11\n [115,] -2.377432e-11 -1.192264e-10  1.483862e-10\n [116,] -1.097078e-11  3.139977e-11  4.675726e-11\n [117,]  2.837802e-11  6.734080e-11  8.083756e-11\n [118,]  4.604339e-11  5.381939e-11  9.000178e-11\n [119,]  1.872391e-11  2.814371e-11 -1.074862e-11\n [120,]  1.828093e-11 -3.834555e-11  1.702105e-11\n [121,]  5.217604e-12 -1.376232e-12  3.196066e-11\n [122,] -2.853096e-11 -4.907807e-11",
        "  6.002310e-12\n [123,] -9.857143e-12  1.378941e-11  6.737433e-11\n [124,] -2.870304e-11 -3.331224e-11 -2.806572e-11\n [125,]  1.752145e-10  2.256861e-12  1.270006e-11\n [126,]  1.180167e-11  1.960210e-12  7.549161e-11\n [127,] -4.141043e-11 -1.387868e-11  6.556267e-11\n [128,] -2.673950e-11  2.816933e-11  2.543832e-11\n [129,] -1.504841e-11 -7.928769e-12  2.546674e-11\n [130,] -1.151124e-11  1.435119e-11  2.763878e-11\n [131,] -4.188871e-12 -2.158451e-11  5.747935e-11\n [132,] -1.386163e-11 -6.296252e-11  8.635226e-",
        "11\n [133,]  2.276401e-11  4.622169e-11  1.535394e-11\n [134,] -7.181811e-12 -6.575362e-11  4.475709e-11\n [135,] -5.289369e-11 -5.485079e-11  1.474376e-12\n [136,]  1.260325e-12  1.377869e-10  3.238654e-11\n [137,] -1.404210e-11  1.168172e-10  3.215761e-11\n [138,]  6.830092e-13 -3.360245e-11  2.399614e-11\n [139,] -3.170442e-11 -4.439293e-11  3.463763e-11\n [140,]  1.389644e-10 -2.483409e-10 -1.129319e-11\n [141,]  4.616751e-12  2.861755e-11  4.848566e-11\n [142,] -4.471534e-11  5.853984e-12 -8.992052e-11\n [143,]  ",
        "1.140013e-10  2.665459e-10 -9.538814e-11\n [144,] -1.310330e-11  5.569900e-11  6.808554e-12\n [145,] -7.924772e-11 -8.294965e-11  2.693179e-12\n [146,] -3.102407e-12  9.466428e-12  5.249579e-12\n [147,] -6.434409e-12 -6.947332e-12  9.732049e-12\n [148,] -1.548983e-12  1.576240e-10  6.191136e-11\n [149,] -1.629163e-11  5.752732e-12  7.087930e-11\n [150,]  8.322232e-13 -7.087220e-12  6.091661e-11\n [151,]  1.416200e-10  1.047074e-11  2.062306e-11\n [152,]  1.273603e-11  2.671041e-11  1.503464e-11\n [153,]  5.377121e-11",
        "  8.263701e-11 -3.539591e-11\n [154,]  1.027933e-11 -3.116400e-10  2.892531e-11\n [155,]  1.231406e-10 -1.579845e-10  2.700062e-12\n [156,]  1.723865e-11 -5.807221e-11  2.282752e-11\n [157,]  5.073986e-11 -1.352873e-11  6.723400e-12\n [158,] -7.308598e-12  9.623857e-12  1.561618e-11\n [159,]  4.147793e-12 -3.211720e-11  4.378720e-12\n [160,] -2.244915e-11 -2.807526e-11 -3.067546e-12\n [161,]  1.514611e-11 -5.870859e-13  1.980438e-11\n [162,]  3.739675e-12  6.530776e-12  2.513145e-11\n [163,] -4.053557e-11 -4.439116e-",
        "12  3.818279e-12\n [164,] -1.116396e-11  5.069123e-11 -6.056777e-11\n [165,]  2.548184e-12  1.402722e-11  1.309042e-11\n [166,] -1.186891e-10 -2.147704e-10  1.780851e-10\n [167,] -9.221512e-12 -2.205791e-11  4.400968e-11\n [168,]  5.683898e-12 -5.826006e-12  2.563549e-11\n [169,] -1.875977e-11 -1.291323e-11  4.900524e-13\n [170,]  9.474199e-11 -1.542260e-10  4.533085e-11\n [171,] -5.650458e-11  2.120348e-11  3.035705e-11\n [172,] -1.484635e-11  3.334222e-12  3.010081e-11\n [173,] -1.353051e-11 -3.179457e-11  2.120704",
        "e-11\n [174,]  2.154952e-10 -1.673941e-10 -3.373124e-11\n [175,] -1.388933e-11 -3.519973e-11  3.903899e-11\n [176,] -1.702638e-12  1.143900e-11  8.315570e-12\n [177,]  1.375788e-12  2.965495e-11  1.004929e-11\n [178,]  2.101341e-11 -1.732925e-11  7.398526e-12\n [179,] -1.541576e-10  2.298619e-10  1.568710e-10\n [180,] -2.541078e-12 -2.565448e-12  1.939027e-11\n [181,] -1.266454e-11 -8.195222e-12  7.981615e-12\n [182,]  3.276313e-11 -3.124345e-11  4.721112e-12\n [183,]  1.246270e-11  1.504974e-11  2.350964e-11\n [184,]",
        " -5.774492e-11  9.922485e-11  4.087308e-11\n [185,] -1.593392e-11  1.164044e-11  5.877898e-11\n [186,]  1.790368e-11  7.391210e-11 -9.430234e-13\n [187,] -7.748469e-12 -6.038270e-11  6.893874e-12\n [188,] -4.825829e-11 -8.412826e-12  4.616574e-11\n [189,] -2.003642e-11  1.011280e-11  4.800693e-11\n [190,]  4.517720e-12 -1.960920e-11  3.547296e-11\n [191,]  1.537437e-12 -3.798273e-11  3.684697e-11\n [192,]  3.226486e-11 -1.314115e-10 -4.096279e-12\n [193,] -4.140333e-11 -1.258036e-10 -6.437584e-11\n [194,]  1.816591e-",
        "11 -4.972422e-11  7.185030e-12\n [195,] -5.575984e-12  4.599943e-11  8.515633e-12\n [196,] -2.721068e-11 -4.207612e-11  2.594902e-11\n [197,]  8.062440e-13  3.546585e-11 -3.441603e-11\n [198,]  5.562661e-11  3.874590e-11  9.206413e-12\n [199,] -7.059242e-12 -5.332623e-12  4.171927e-11\n [200,]  1.127232e-10  7.394974e-12  1.389378e-11\n [201,] -1.851808e-11  1.060521e-10  1.800782e-11\n [202,] -5.580425e-12 -9.619794e-11  2.406075e-11\n [203,]  1.837446e-10 -2.499632e-10  3.185896e-12\n [204,] -8.787637e-12 -3.255884",
        "e-11 -7.242429e-12\n [205,]  5.460876e-11  9.059331e-11  1.552314e-10\n [206,] -8.390622e-12 -3.842926e-11  1.748157e-11\n [207,] -2.099698e-11 -3.173284e-11  6.057377e-12\n [208,]  1.874723e-12  8.229462e-11  1.430411e-11\n [209,] -3.083223e-11  7.512835e-11  2.404804e-11\n [210,] -1.088019e-11  4.838796e-11  5.867262e-11\n [211,]  1.022897e-10  1.633556e-10  8.165424e-11\n [212,] -1.493117e-11 -2.083045e-11 -5.553558e-12\n [213,]  1.525509e-10  1.285825e-10  7.968293e-11\n [214,] -1.674483e-11 -4.787992e-11 -1.9113",
        "79e-11\n [215,] -1.542588e-11  8.600098e-11  7.636169e-12\n [216,]  9.177992e-12  6.290479e-11  1.149321e-10\n [217,]  7.139178e-12 -1.040590e-11 -3.509759e-11\n [218,]  3.376854e-12  2.413802e-11  7.161161e-12\n [219,] -3.136824e-11  3.871126e-11  3.828804e-11\n [220,] -2.829159e-11  9.541257e-12  3.605916e-11\n [221,] -1.295808e-11  1.532485e-11 -1.707967e-11\n [222,]  2.910205e-11  7.514878e-12  8.321566e-12\n [223,]  8.179413e-11  7.276757e-11  6.807617e-12\n [224,] -1.967093e-11  7.899903e-12  1.122213e-11\n [225",
        ",]  2.535305e-11 -1.919576e-11  4.197620e-11\n [226,]  1.451617e-11 -4.480438e-11  5.622036e-11\n [227,]  2.933742e-11 -1.186757e-10  5.095679e-11\n [228,]  8.575363e-12  1.649170e-11 -2.387979e-12\n [229,]  4.737988e-12 -6.350476e-12  9.806378e-12\n [230,] -4.923972e-11 -2.355005e-12  2.316547e-11\n [231,] -9.900081e-12  1.409628e-11  4.434675e-12\n [232,] -2.610656e-11 -3.916989e-11  1.435341e-11\n [233,] -1.244471e-11  2.136469e-11 -3.707035e-12\n [234,]  4.033751e-11 -2.181455e-11 -1.431566e-11\n [235,]  1.181406",
        "e-10  1.073728e-10  4.925971e-11\n [236,]  1.063727e-11  2.006262e-11  2.128783e-11\n [237,]  1.275868e-11  3.555384e-11  1.202949e-11\n [238,]  2.739320e-11 -1.879163e-11  4.325473e-11\n [239,]  9.056311e-11 -7.266499e-11  1.421085e-14\n [240,] -5.695888e-12  1.661604e-11 -7.222667e-12\n [241,]  6.483702e-12 -4.220801e-11  4.944489e-11\n [242,]  1.044803e-12 -7.848078e-11 -5.924150e-12\n [243,] -1.274536e-11 -4.222400e-11  4.732825e-12\n [244,] -1.366818e-11  3.627676e-11  5.989875e-12\n [245,]  1.600142e-11 -6.2110",
        "32e-12  5.590861e-12\n [246,]  4.066791e-11 -7.687717e-11  3.613332e-12\n [247,]  9.778178e-11 -1.427853e-10  6.552536e-11\n [248,]  4.769252e-11  1.461857e-10  3.030709e-11\n [249,] -1.822009e-11  2.521983e-11  4.100720e-12\n [250,]  1.292211e-11 -2.427125e-11  5.081047e-12\n [251,]  1.108793e-10  1.586287e-11  1.462968e-10\n [252,] -1.278089e-12 -5.021317e-11  4.964873e-11\n [253,]  2.418288e-11  4.509637e-11  4.821210e-11\n [254,] -3.781730e-11 -3.549161e-12  1.419798e-11\n [255,] -1.446399e-11 -2.385869e-11 -2.79",
        "2433e-12\n [256,] -8.399725e-12 -1.567591e-10 -5.764544e-11\n [257,] -1.279510e-11  2.217604e-11  2.031375e-11\n [258,] -3.414147e-11 -2.183249e-10 -1.994938e-11\n [259,]  3.683609e-11 -2.814549e-11  1.427436e-11\n [260,] -1.679035e-11 -5.305179e-11  6.158007e-11\n [261,]  7.560175e-12  1.231015e-12  3.097522e-12\n [262,] -4.804868e-11  5.513079e-11  4.758416e-11\n [263,]  1.727098e-10 -1.455431e-10  7.929218e-11\n [264,]  9.378720e-12  5.577760e-12  2.075923e-11\n [265,]  7.458478e-13 -2.036171e-11  4.933609e-12\n [2",
        "66,]  3.532641e-11  7.104434e-11 -4.386269e-12\n [267,]  1.173728e-10  6.214784e-11  3.765965e-11\n [268,]  3.350742e-11  1.078730e-10  3.126521e-11\n [269,]  5.089262e-13 -6.378986e-11  4.489124e-11\n [270,]  4.640377e-11 -1.003267e-10  1.194630e-10\n [271,]  3.612666e-11  6.428191e-12  1.562128e-11\n [272,] -3.624923e-11  8.688353e-11 -6.880596e-11\n [273,] -4.529710e-12  1.030198e-11 -2.074307e-11\n [274,]  7.427836e-12 -1.223170e-10  3.726797e-12\n [275,]  9.467627e-11 -3.722178e-11  7.444712e-12\n [276,]  8.7345",
        "24e-11  1.757816e-10  6.469714e-12\n [277,] -1.478773e-11 -4.272982e-11  2.721912e-11\n [278,]  4.422485e-11  1.088276e-10  3.532907e-11\n [279,] -1.139622e-11  8.192114e-12  4.708323e-11\n [280,] -4.794964e-11  1.791367e-11  2.594569e-11\n [281,] -6.660894e-12 -6.632028e-12  5.321743e-12\n [282,] -8.848033e-12 -4.627521e-11  3.423040e-12\n [283,]  4.383316e-11 -4.621903e-11 -3.441292e-11\n [284,]  1.334595e-10 -1.771898e-10  2.955813e-11\n [285,] -8.332890e-12  1.106085e-10  1.027978e-11\n [286,]  1.323635e-10  1.13",
        "8338e-10  3.368505e-11\n [287,]  1.379110e-10 -1.593898e-10 -1.235012e-12\n [288,]  7.397638e-12 -1.185624e-11  5.325118e-11\n [289,]  9.174883e-12 -1.126961e-10  1.704104e-11\n [290,]  1.317835e-12  3.558043e-11  1.020878e-11\n [291,]  9.421797e-12  6.366019e-11  6.823164e-11\n [292,] -6.906919e-12 -2.598322e-11  1.130673e-11\n [293,]  9.296564e-12 -9.152235e-12  1.317391e-12\n [294,]  8.373213e-11  1.133582e-11  3.556888e-11\n [295,] -5.469314e-11  3.323830e-11  3.715073e-11\n [296,] -1.172218e-11  2.403411e-12  5.",
        "676526e-11\n [297,] -1.137934e-11  6.767387e-11  1.489275e-11\n [298,] -6.958878e-12 -6.017631e-11  6.770584e-11\n [299,] -2.951372e-11 -1.652811e-11  1.201572e-11\n [300,]  1.389537e-10 -6.840550e-11 -3.550049e-11\n [301,] -2.101164e-11 -5.966561e-11  6.536993e-13\n [302,] -1.421085e-14  5.172507e-11  3.647149e-11\n [303,]  2.948566e-10 -1.584435e-10  1.334044e-11\n [304,] -1.070360e-11  4.891731e-11  1.155165e-11\n [305,]  3.189449e-11 -2.765344e-11  2.989253e-11\n [306,]  3.182787e-12  6.471446e-11  3.856648e-11\n ",
        "[307,]  2.330225e-11  2.784528e-11  1.446754e-11\n [308,]  1.702638e-12  9.715784e-12  6.957990e-12\n [309,] -1.351141e-12 -4.022915e-11  3.292245e-12\n [310,]  1.450351e-11 -7.401368e-11  7.258638e-13\n [311,] -2.678089e-10  2.991722e-10  8.966161e-11\n [312,]  2.483680e-12 -6.639267e-11  1.731015e-11\n [313,] -9.324097e-12  9.141798e-12  1.823697e-11\n [314,]  1.451705e-11 -1.699196e-11  4.347367e-11\n [315,]  1.423377e-10  2.363514e-10  8.314804e-11\n [316,]  2.770673e-11 -8.264744e-11  5.897860e-11\n [317,]  4.41",
        "5335e-11  4.058620e-11  9.072298e-12\n [318,]  1.293388e-11  1.502398e-11  1.573075e-11\n [319,] -2.622189e-11  1.097202e-10  5.419087e-11\n [320,] -6.295942e-11 -2.778222e-12  3.009060e-11\n [321,]  9.648105e-11  7.616663e-11 -9.175727e-11\n [322,] -2.483769e-11  9.947088e-11  2.031153e-11\n [323,]  7.393552e-11  5.382805e-12 -2.026912e-11\n [324,] -8.292567e-11 -5.022027e-11  3.346612e-11\n [325,] -1.430156e-11  3.993428e-11  1.560330e-11\n [326,] -3.201883e-12 -4.217426e-11  3.955725e-11\n [327,] -4.563905e-12 -5.",
        "026801e-11  2.233591e-11\n [328,] -1.331646e-11  1.164024e-11  9.010126e-12\n [329,]  2.947065e-11 -7.268408e-11 -3.164291e-11\n [330,]  1.286882e-10  3.372662e-10  1.730704e-11\n [331,] -5.712320e-12  6.921930e-11  5.735101e-11\n [332,]  2.387424e-11  1.092134e-10 -4.634182e-11\n [333,] -5.431655e-12 -5.130651e-11  2.346878e-11\n [ raggiunto getOption(\"max.print\") -- omesse 667 righe ]\n\n> nd <- jacobian(function(b) f1$eval(c(alph, b), deriv = 1)$f, x = bet)\n\n> max(abs(nd-f2$store$fb))\n[1] 5.261229e-09\n\n> ## ltx d",
        "erivatives\n> ltx <- log.htx(f2, deriv = 2)\n\n> nd <- jacobian(function(a) sum(log.htx(f1, param=c(a,bet), deriv=0)$h), x = alph)\n\n> ltx$dhda-nd\n             [,1]          [,2]          [,3]\n[1,] -1.38316e-08 -3.058176e-09 -1.838953e-08\n\n> nd <- jacobian(function(b) sum(log.htx(f1, param=c(alph,b), deriv=0)$h), x = bet)\n\n> ltx$dhdb-nd\n             [,1]          [,2]         [,3]         [,4]\n[1,] 2.307075e-09 -2.765128e-08 1.321979e-09 1.888674e-09\n              [,5]        [,6]         [,7]\n[1,] -2.871516e-0",
        "9 -8.1736e-09 -7.57511e-08\n\n> nd <- hessian(function(p) sum(log.htx(f1, param=c(p,bet), deriv=0)$h), x = alph)\n\n> ltx$dhab[1:3,1:3]-nd\n              [,1]          [,2]          [,3]\n[1,] -1.649342e-04 -9.914035e-05 -3.562450e-04\n[2,] -9.914035e-05  1.519157e-06 -1.479586e-05\n[3,] -3.562450e-04 -1.479586e-05 -1.778419e-05\n\n> nd <- hessian(function(b) sum(log.htx(f1, param=c(alph,b), deriv=0)$h), x = bet)\n\n> diag(ltx$dhab[-(1:3),-(1:3)]-nd)\n[1] 6.576865e-09 6.795086e-08 3.213955e-09 7.764278e-10 1.564587e-09\n",
        "[6] 1.369557e-08 3.396426e-07\n\n> max(abs(ltx$dhab[-(1:3),-(1:3)]-nd))\n[1] 3.396426e-07\n\n> nd <- hessian(function(p) sum(log.htx(f1, param=p, deriv=0)$h), x = c(alph, bet))\n\n> ltx$dhab[1:3, -(1:3)]-nd[1:3, -(1:3)]\n              [,1]          [,2]          [,3]          [,4]\n[1,]  2.094296e-07  1.707309e-07 -2.577441e-07  1.796235e-08\n[2,] -4.808328e-09 -6.125958e-09  3.681180e-10 -7.508731e-10\n[3,]  2.577821e-08  3.711648e-09  1.267222e-08  7.359233e-10\n              [,5]          [,6]          [,7]\n[1,]  8.",
        "357119e-08 -1.160439e-07  7.290146e-08\n[2,] -1.347303e-09  7.689778e-10 -8.214670e-09\n[3,] -1.990713e-09 -5.007337e-09 -3.085120e-09\n\n> ## stx derivatives\n> ltx <- log.Stx(f2, deriv = 2, param = c(alph, bet))\n\n> nd <- jacobian(function(a) sum(log.Stx(f1, param=c(a,bet), deriv=0)$s), x = alph)\n\n> ltx$dhda/nd\n     [,1] [,2] [,3]\n[1,]    1    1    1\n\n> nd <- jacobian(function(b) sum(log.Stx(f1, param=c(alph,b), deriv=0)$s), x = bet)\n\n> ltx$dhdb/nd\n     [,1] [,2] [,3] [,4] [,5] [,6] [,7]\n[1,]    1    1    1    ",
        "1    1    1    1\n\n> nd <- hessian(function(p) sum(log.Stx(f1, param=c(p,bet), deriv=0)$s), x = alph)\n\n> ltx$dhab[1:3,1:3]/nd\n         [,1]     [,2]     [,3]\n[1,] 1.000001 1.000004 1.000004\n[2,] 1.000004 1.000000 1.000000\n[3,] 1.000004 1.000000 1.000000\n\n> nd <- hessian(function(b) sum(log.Stx(f1, param=c(alph,b), deriv=0)$s), x = bet)\n\n> ltx$dhab[-(1:3),-(1:3)]/nd\n     [,1] [,2] [,3] [,4] [,5] [,6] [,7]\n[1,]    1    1    1    1    1    1    1\n[2,]    1    1    1    1    1    1    1\n[3,]    1    1    1    1 ",
        "   1    1    1\n[4,]    1    1    1    1    1    1    1\n[5,]    1    1    1    1    1    1    1\n[6,]    1    1    1    1    1    1    1\n[7,]    1    1    1    1    1    1    1\n\n> nd <- hessian(function(p) sum(log.Stx(f1, param=p, deriv=0)$s), x = c(alph, bet))\n\n> ltx$dhab[1:3, -(1:3)]/nd[1:3, -(1:3)]\n         [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]\n[1,] 1.000005 1.000005 1.000013 1.000007 1.000006 1.000006 1.000004\n[2,] 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000\n[3,] 1.",
        "000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000\n",
        "Messaggi di avvertimento:\n1: In nlm(f = llk, p = c(sm$xt$si$alpha, rep(0, ncol(sm$X) - length(sm$xt$si$alpha))),  :\n  NA/Inf sostituito da valore massimo positivo\n2: In nlm(f = llk, p = c(sm$xt$si$alpha, rep(0, ncol(sm$X) - length(sm$xt$si$alpha))),  :\n  NA/Inf sostituito da valore massimo positivo\n3: In log(d1) : Si è prodotto un NaN\n4: In log(o$store$f1) : Si è prodotto un NaN\n5: In nlm(f = llk, p = c(sm$xt$si$alpha, rep(0, ncol(sm$X) - length(sm$xt$si$alpha))),  :\n  NA/Inf sostituito da valore massimo ",
        "positivo\n6: In log(d1) : Si è prodotto un NaN\n7: In log(o$store$f1) : Si è prodotto un NaN\n8: In nlm(f = llk, p = c(sm$xt$si$alpha, rep(0, ncol(sm$X) - length(sm$xt$si$alpha))),  :\n  NA/Inf sostituito da valore massimo positivo\n",
        "> ",
        "build()",
        "\u001B[36m──\u001B[39m \u001B[36mR CMD build\u001B[39m \u001B[36m─────────────────────────────────────────────────────\u001B[39m\n  \r   checking for file ‘/home/claudia/Dropbox/dottorato pd/Accelerated_failure_time/code/aftNested/DESCRIPTION’ ...\r  \r\u001B[32m✔\u001B[39m  \u001B[38;5;247mchecking for file ‘/home/claudia/Dropbox/dottorato pd/Accelerated_failure_time/code/aftNested/DESCRIPTION’\u001B[39m\u001B[36m\u001B[39m\n\r  \r\u001B[38;5;247m─\u001B[39m\u001B[38",
        ";5;247m  \u001B[39m\u001B[38;5;247mpreparing ‘aftNested’:\u001B[39m\u001B[36m\u001B[39m\n\u001B[32m✔\u001B[39m  \u001B[38;5;247mchecking DESCRIPTION meta-information\u001B[39m\u001B[36m\u001B[39m\n\u001B[38;5;247m─\u001B[39m\u001B[38;5;247m  \u001B[39m\u001B[38;5;247mcleaning src\u001B[39m\u001B[36m\u001B[39m\n\r  \r\u001B[38;5;247m─\u001B[39m\u001B[38;5;247m  \u001B[39m\u001B[38;5;247mchecking for LF line-endings in source and make files and shell scripts\u001B[39m\u001B[36m\u001B[39m\n\r  \r\u001B[38;5;247m─\u001B[39m\u001B[38;5;247m  \u001B[39m\u001B[38;5;247mchecking for empty or unneeded directories\u001B[39m\u001B[36m\u001B[39m\n   Omitted ‘LazyData’ from DESCRIPTIO",
        "N\n\u001B[38;5;247m─\u001B[39m\u001B[38;5;247m  \u001B[39m\u001B[38;5;247mbuilding ‘aftNested_0.1.0.tar.gz’\u001B[39m\u001B[36m\u001B[39m\n   \n\r[1] \"/home/claudia/Dropbox/dottorato pd/Accelerated_failure_time/code/aftNested_0.1.0.tar.gz\"\n\nRestarting R session...\n\n"
    ]
}